
<div align="center">
<a href="https://devops-factory.com" >
  <img src="https://devops-factory.com/images/logogit.png" width="250" alt="DevOps Factory">
</a>
</div>
<div align="center">
    <a style="vertical-align: middle;display: inline-block;">
      <img align="center" src="https://readme-typing-svg.demolab.com?font=Fira+Code&size=14&duration=2000&pause=&color=3DD10D&center=true&vCenter=true&multiline=true&width=435&lines=%D0%A1%D0%B4%D0%B5%D0%BB%D0%B0%D0%BD%D0%BE+%D0%B0%D0%BA%D1%82%D0%B8%D0%B2%D0%B8%D1%81%D1%82%D0%BE%D0%BC+%D0%B8%D0%B7+%D0%BA%D0%BB%D1%83%D0%B1%D0%B0+%D0%BF%D1%80%D0%B8+%D1%84%D0%B0%D0%B1%D1%80%D0%B8%D0%BA%D0%B5;By+Dmitriy+Shmakov" alt="" />
    </a>  
  </a>
</div>
<div align="center">
 
  [![DevOps Factory](https://img.shields.io/badge/DevOps_Factory-green?style=for-the-badge)](https://devops-factory.com)
 
  [![YouTube](https://img.shields.io/badge/YouTube-red?style=for-the-badge)](https://youtube.com/@devopsfactory)
  [![Telegram](https://img.shields.io/badge/Telegram-blue?style=for-the-badge)](https://t.me/devops_factory)
</div>


# DevOps Interview Knowledge Base

–†–∞–∑–±–æ—Ä **[–º–æ–∫ —Å–æ–±–µ—Å–∞ ‚Ññ1](https://www.youtube.com/watch?v=pLU3zrUq87Y&t)** –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–í–æ–ø—Ä–æ—Å ‚Äî –û—Ç–≤–µ—Ç" –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è–º –Ω–∞ –ø–æ–∑–∏—Ü–∏—é DevOps.

## üìå –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [1. Terraform –∏ AWS](#1-terraform-–∏-aws)
- [2. Linux –∏ Bash](#2-linux-–∏-bash)
- [3. Ansible](#3-ansible)
- [4. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è (Docker)](#4-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è-docker)
- [5. Nginx](#5-nginx)
- [6. Postgres](#6-postgres)
- [7. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus, Victoria Metrics, Grafana)](#7-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-prometheus-victoria-metrics-grafana)


---

# 1. Terraform –∏ AWS

### ‚ùì 1. –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Terragrunt, –ø–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ Terraform?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (09:05)](https://youtu.be/pLU3zrUq87Y?t=545)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

**Terragrunt** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∫–æ–º–ø–∞–Ω–∏–µ–π Gruntwork, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—à–∏—Ä—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Terraform –∏ —Ä–µ—à–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.
–û–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Ç–æ–Ω–∫–∞—è –æ–±–æ–ª–æ—á–∫–∞ –Ω–∞–¥ Terraform, –¥–æ–±–∞–≤–ª—è—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–∞–∫ –∫–æ–¥–æ–º (IaC).

### üóÉÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Terragrunt:

1. **DRY-–ø—Ä–∏–Ω—Ü–∏–ø (–±–æ—Ä—å–±–∞ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º)**

- Terraform: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- Terragrunt: –û–¥–∏–Ω –º–æ–¥—É–ª—å + —Ä–∞–∑–Ω—ã–µ `inputs` –≤ `terragrunt.hcl`

2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ State-—Ñ–∞–π–ª–∞–º–∏**

- Terraform: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `backend` –≤ –∫–∞–∂–¥–æ–º –º–æ–¥—É–ª–µ
- Terragrunt: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `remote_state

3. **–ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**

- Terraform: –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è ‚Äî –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
- Terragrunt: –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã, —Ä–µ–≥–∏–æ–Ω, —Ç–µ–≥–∏) –∑–∞–¥–∞—é—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ–≤–æ–º `terragrunt.hcl`, –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è production –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

4. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏**

- Terraform: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `depends_on` –∏–ª–∏ `terraform_remote_state` (–≥—Ä–æ–º–æ–∑–¥–∫–æ –∏ –Ω–µ—è–≤–Ω–æ). –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ—Ä—è–¥–∫–∞ –¥–µ–ø–ª–æ—è –ø—Ä–∏ apply (–µ—Å–ª–∏ –º–æ–¥—É–ª–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —è–≤–Ω–æ)
- Terragrunt: –ß–µ—Ç–∫–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Å–≤—è–∑–µ–π —á–µ—Ä–µ–∑ `dependency`. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ `run-all apply`

5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞**

- Terraform: –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã, backend, common-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å
- Terragrunt: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ `generate`

6. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**

- Terraform: –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥—É–ª–µ–π
- Terragrunt: `terragrunt run-all apply` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç apply –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π —Å —É—á–µ—Ç–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

7. **–•—É–∫–∏ (Pre/Post-–æ–±—Ä–∞–±–æ—Ç–∫–∞)**

- Terraform: –ù–µ—Ç –∞–Ω–∞–ª–æ–≥–∞ (—Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã)
- Terragrunt: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ö—É–∫–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–æ/–ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

‚úÖ **Terragrunt –Ω–µ–æ–±—Ö–æ–¥–∏–º:**

- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (dev/stage/prod)
- –ö–æ–º–∞–Ω–¥–∞ > 3 —á–µ–ª–æ–≤–µ–∫
- –°–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- Enterprise-–ø—Ä–æ–µ–∫—Ç—ã —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏

‚ùå **Terraform –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ:**

- –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–æ–µ–∫—Ç—ã (< 10 —Ä–µ—Å—É—Ä—Å–æ–≤)
- –û–¥–Ω–æ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- –ü—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
- –ú–∞–ª–∞—è –∫–æ–º–∞–Ω–¥–∞ (1-2 —á–µ–ª–æ–≤–µ–∫–∞)

ü§î **–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ Terragrunt, –∫–æ–≥–¥–∞:**

- –ù–∞—á–∏–Ω–∞–µ—Ç–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏
- –°–ª–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å state-—Ñ–∞–π–ª–∞–º–∏
- –ù—É–∂–µ–Ω —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–ø–ª–æ—è –º–æ–¥—É–ª–µ–π

</p></details>

---

### ‚ùì 2. –ß—Ç–æ —Ç–∞–∫–æ–µ state —Ñ–∞–π–ª?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (10:17)](https://youtu.be/pLU3zrUq87Y?t=617)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üóÉÔ∏è –û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–Ω—è—Ç–∏–µ

**State-—Ñ–∞–π–ª** (terraform.tfstate) - —ç—Ç–æ JSON-—Ñ–∞–π–ª, –≤ –∫–æ—Ç–æ—Ä–æ–º Terraform —Ö—Ä–∞–Ω–∏—Ç:

- –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Ä–µ—Å—É—Ä—Å–∞–º–∏ –≤ –∫–æ–¥–µ –∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –æ–±–ª–∞—á–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ä–µ—Å—É—Ä—Å–∞–º–∏

### üîç –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω?

1. **–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**  
   –°–≤—è–∑—ã–≤–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –≤ –∫–æ–¥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `aws_instance.web`) —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –æ–±–ª–∞—á–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ (i-1234567890)

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**

   - –ê—Ç—Ä–∏–±—É—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤ (IP-–∞–¥—Ä–µ—Å–∞, DNS-–∏–º–µ–Ω–∞)
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ä–µ—Å—É—Ä—Å–∞–º–∏

3. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π**  
   –ü—Ä–∏ `terraform plan` —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç:
   - –ñ–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–∫–æ–¥)
   - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (state-—Ñ–∞–π–ª)

</p></details>

---

### ‚ùì 3. –ö–∞–∫ –∑–∞—â–∏—â–∞—é—Ç state —Ñ–∞–π–ª –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è (S3 Bucket)

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (11:24)](https://youtu.be/pLU3zrUq87Y?t=684)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üîê 1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Versioning)

–ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ `terraform.tfstate`.

–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å:

```hcl
resource "aws_s3_bucket_versioning" "example" {
  bucket = aws_s3_bucket.example.id

  versioning_configuration {
    status = "Enabled"
  }
}
```

‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:

- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –∫ –ª—é–±–æ–π –≤–µ—Ä—Å–∏–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è

### üõ°Ô∏è 2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ IAM / S3 Bucket Policy

–ó–∞–ø—Ä–µ—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ state-—Ñ–∞–π–ª–∞ –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–º—É.

### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–∏—Ç–∏–∫–∏ –∑–∞–ø—Ä–µ—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è:

```json
{
  "Effect": "Deny",
  "Action": "s3:DeleteObject",
  "Resource": "arn:aws:s3:::your-bucket-name/terraform.tfstate",
  "Principal": "*"
}
```

‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:

- –†–∞–∑—Ä–µ—à–∞—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ CI/CD –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º IAM-—Ä–æ–ª—è–º
- –ó–∞–ø—Ä–µ—Ç–∏—Ç—å `s3:DeleteObject` –∏ `s3:PutObject` –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

</p></details>

---

### ‚ùì 4. –ö–∞–∫ –≤ —Å–ª—É—á–∞–µ —Å Terraform/Terragrunt –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å, —á—Ç–æ –¥–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç Terraform/Terragrunt –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (12:50)](https://youtu.be/pLU3zrUq87Y?t=770)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Terraform –∏ Terragrunt –∫–æ–Ω—Ç—Ä–æ–ª—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (concurrent execution) —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (State Locking), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –¥–≤–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—Ç terraform apply, terragrunt apply –∏ —Ç.–ø.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:

- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `terraform apply/plan` —Å–æ–∑–¥–∞–µ—Ç—Å—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- –î—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∂–¥—É—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è lock
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

</p></details>

---

### ‚ùì 5. –ö–∞–∫ –æ–±—ä–µ–∫—Ç –∏–∑ –æ–±–ª–∞—á–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—É–∫—Ç—É—Ä—ã "–∑–∞—Ç–∞—â–∏—Ç—å" –≤ Terraform

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (14:27)](https://youtu.be/pLU3zrUq87Y?list=PL_yNYdjRN_xFOvXj7bvu5Y8Qo9liTV7Ah&t=867)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –î–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±–ª–∞—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ Terraform –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–º–∞–Ω–¥—É import

**–ü—Ä–∏–º–µ—Ä**:

```bash
terraform import <—Ä–µ—Å—É—Ä—Å_–≤_–∫–æ–¥–µ> <–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä_–≤_–æ–±–ª–∞–∫–µ>
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è AWS EC2**:

```bash
terraform import aws_instance.my_vm i-1234567890abcdef0
```

</p></details>

---

### ‚ùì 6. –ï—Å—Ç—å –∫–∞–∫–∏–µ-—Ç–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –∫–æ–º–∞–Ω–¥–æ–π import?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (14:43)](https://youtu.be/pLU3zrUq87Y?t=883)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### 1. –ù–µ —Å–æ–∑–¥–∞—ë—Ç `.tf` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

- `terraform import` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å —Ç–æ–ª—å–∫–æ –≤ `terraform.tfstate`.
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª (`.tf`) –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –≤—Ä—É—á–Ω—É—é.
- –ï—Å–ª–∏ `.tf` –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–º–ø–æ—Ä—Ç—É ‚Äî `terraform plan` –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —É–¥–∞–ª–∏—Ç—å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ä–µ—Å—É—Ä—Å.

### 2. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ—á–Ω—ã–π ID —Ä–µ—Å—É—Ä—Å–∞

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏ —Ä–µ—Å—É—Ä—Å–∞ —Ñ–æ—Ä–º–∞—Ç ID —Ä–∞–∑–Ω—ã–π:
  - AWS: `i-0123456789abcdef0`
  - Azure: `/subscriptions/.../resourceGroups/...`
  - GCP: `project/zone/resource-name`
- –û—à–∏–±–∫–∞ –≤ ID –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —Å–±–æ—é –∏–º–ø–æ—Ä—Ç–∞.

### 3. –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏

- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø—Ä—è–º–æ–π –∏–º–ø–æ—Ä—Ç.
- –ù–∞–ø—Ä–∏–º–µ—Ä, `aws_security_group_rule` –ª—É—á—à–µ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äî –ø—Ä–æ—â–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é `aws_security_group`.

### 4. –ò–º–ø–æ—Ä—Ç –≤ –º–æ–¥—É–ª–∏ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ—á–Ω–æ–≥–æ –ø—É—Ç–∏

- –ï—Å–ª–∏ —Ä–µ—Å—É—Ä—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è, –ø—É—Ç—å –±—É–¥–µ—Ç —Å–ª–æ–∂–Ω–µ–µ:

```bash
terraform import module.<module_name>.<resource_type>.<name> <resource_id>
```

### 5. –†–∏—Å–∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –∫–æ–¥–∞

- –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ .tf-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤—ã–∑—ã–≤–∞–µ—Ç `terraform plan` ‚Üí destroy/create.
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞–±–æ—á—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.

---

‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –°–¥–µ–ª–∞–π –±—ç–∫–∞–ø —Å–æ—Å—Ç–æ—è–Ω–∏—è:

```bash
terraform state pull > backup.tfstate
```

- –ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π:

```bash
terraform show
```

- –°–≤–µ—Ä—å —Å —Ç–µ–∫—É—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ **–≤—Ä—É—á–Ω—É—é –∑–∞–ø–æ–ª–Ω–∏ `.tf`**.
- –ò—Å–ø–æ–ª—å–∑—É–π [Terraformer](https://github.com/GoogleCloudPlatform/terraformer) –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ –∏ –∏–º–ø–æ—Ä—Ç–∞.

üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- Terraformer: https://github.com/GoogleCloudPlatform/terraformer
- Terraform import docs: https://developer.hashicorp.com/terraform/cli/import

</p></details>

---

### ‚ùì 7. –ö–∞–∫–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø—Ä–∏—á–∏–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –º–µ–∂–¥—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤ Terraform –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ AWS, –∫—Ä–æ–º–µ —Å–ª—É—á–∞–µ–≤ —Ä—É—á–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (15:15)](https://youtu.be/pLU3zrUq87Y?t=915)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### 1. –ò–∑–º–µ–Ω–µ–Ω–∏—è, –≤–Ω–µ—Å—ë–Ω–Ω—ã–µ –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
CI/CD –ø–∞–π–ø–ª–∞–π–Ω—ã, AWS CDK, CloudFormation, Ansible –∏ –¥—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç Terraform.

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã AWS

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ä–≤–∏—Å—ã AWS –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—é—Ç –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—é—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.

**–ü—Ä–∏–º–µ—Ä—ã:**

- Elastic Load Balancer –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –≤ Security Group
- Auto Scaling –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç EC2 –∏–ª–∏ ENI
- RDS –º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–ª–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### 3. –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ –≤ `.tf`, AWS –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–≤–æ—ë –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –æ–∂–∏–¥–∞–Ω–∏—è–º–∏ Terraform.

**–ü—Ä–∏–º–µ—Ä:**

- `deletion_protection` = `false` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ RDS

### 4. –î—Ä–∏—Ñ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è (drift)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–†–µ—Å—É—Ä—Å—ã "—É–ø–ª—ã–≤–∞—é—Ç" –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ —è–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.

**–ü—Ä–∏—á–∏–Ω—ã:**

- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- –ü–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–∞—Ö
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è AWS

### 5. –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `terraform import`

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ò–º–ø–æ—Ä—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (`.tfstate`), –Ω–æ **–Ω–µ —Å–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ:**

- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–π –≤ `.tf` ‚Üí `terraform plan` –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ä–µ—Å—É—Ä—Å

### 6. –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—è

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –≤—ã–∑—ã–≤–∞—é—Ç –ª–æ–∂–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –ø–ª–∞–Ω–µ.

**–ü—Ä–∏–º–µ—Ä—ã:**

- `last_modified`, `tags`, `host_id`

### 7. –†–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Terraform –∏–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ü–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ Terraform –∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

- –ü–æ—è–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∏–ø–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- –£–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤

### 8. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (IAM)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ç–æ–º—É, —á—Ç–æ Terraform —Å—á–∏—Ç–∞–µ—Ç –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏.

### 9. –†–∞–∑–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—è—Ö (–º–∞—Å—Å–∏–≤—ã vs –º–Ω–æ–∂–µ—Å—Ç–≤–∞)

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–î–∞–∂–µ —Ä–∞–∑–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å `diff` –≤ `terraform plan`, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è:

- `subnet_ids`
- `security_group_ids`
- `tags`

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –†–µ–≥—É–ª—è—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `terraform plan`
- –£–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–≤–Ω–æ, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ "–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"
- –ü—Ä–∏–º–µ–Ω—è—Ç—å `ignore_changes` –¥–ª—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —á–µ—Ä–µ–∑ Terraform

</p></details>

---

### ‚ùì 8. –í AWS —á–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è elastic-ip –æ—Ç public-ip

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (16:11)](https://youtu.be/pLU3zrUq87Y?t=971)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í AWS –æ–±–∞ —Ç–∏–ø–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º –∏–∑–≤–Ω–µ, –Ω–æ `Elastic IP` –∏ `Public IP` –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–ø–æ—Å–æ–±—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: Elastic IP vs Public IP

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞                   | Elastic IP (EIP)                            | Public IP (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)                      |
| -------------------------------- | ------------------------------------------- | --------------------------------------------- |
| **–°—Ç–∞—Ç–∏—á–Ω–æ—Å—Ç—å**                  | ‚úÖ –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ) | ‚ùå –í—Ä–µ–º–µ–Ω–Ω—ã–π (–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ/–∑–∞–ø—É—Å–∫–µ) |
| **–í—ã–¥–µ–ª—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é**           | ‚úÖ –î–∞                                       | ‚ùå –ù–µ—Ç (–Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è AWS –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)        |
| **–ú–æ–∂–Ω–æ –æ—Ç–≤—è–∑–∞—Ç—å/–ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å** | ‚úÖ –î–∞                                       | ‚ùå –ù–µ—Ç                                        |
| **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**  | ‚úÖ –î–∞                                       | ‚ùå –ù–µ—Ç                                        |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å**                    | üí∞ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è             | ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ                                  |
| **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É**    | –û–±—ã—á–Ω–æ 5 –Ω–∞ —Ä–µ–≥–∏–æ–Ω (–º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å)        | –ù–µ—Ç —è–≤–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π                         |

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### ‚úÖ Elastic IP:

- –ù—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ IP** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è DNS)
- –•–æ—á–µ—à—å –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å IP –Ω–∞ –¥—Ä—É–≥–æ–π –∏–Ω—Å—Ç–∞–Ω—Å
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ **–ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ** –∏–ª–∏ –ø—Ä–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–≤

### ‚úÖ Public IP:

- –ò–Ω—Å—Ç–∞–Ω—Å –≤—Ä–µ–º–µ–Ω–Ω—ã–π
- –ù–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤—É IP
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤, –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **Elastic IP –ø–ª–∞—Ç–Ω—ã–π**, –µ—Å–ª–∏:
  - –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º—É –∏–Ω—Å—Ç–∞–Ω—Å—É
  - –ø—Ä–µ–≤—ã—à–µ–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- **Public IP —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞** ‚Äî –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –±—É–¥–µ—Ç –¥—Ä—É–≥–æ–π

## üí° –í—ã–≤–æ–¥

–ò—Å–ø–æ–ª—å–∑—É–π **Elastic IP**, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π IP-–∞–¥—Ä–µ—Å.  
–í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ **–æ–±—ã—á–Ω–æ–≥–æ Public IP**, –∫–æ—Ç–æ—Ä—ã–π AWS –≤—ã–¥–∞—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

</p></details>

---

### ‚ùì 9. –í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ —Ç–æ–º–æ–≤ EBS (Elastic Block Store) –≤ AWS: gp2, gp3, gpstate, gptool –∏ –¥—Ä—É–≥–∏–º–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º–∏ –Ω–∞ EC2-–∏–Ω—Å—Ç–∞–Ω—Å–∞—Ö?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (16:40)](https://youtu.be/pLU3zrUq87Y?t=1000)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ EBS-—Ç–æ–º–æ–≤

| –¢–∏–ø —Ç–æ–º–∞    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                          | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                       | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                    |
| ----------- | ----------------------------------- | ---------------------------------------- | ---------------------------------------------- |
| **gp2**     | –û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ç–∞—Ä—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç) | –î–æ 3,000 IOPS (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞) | 3 IOPS/GB, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞                  |
| **gp3**     | –û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–Ω–æ–≤—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç)  | –î–æ 16,000 IOPS / 1,000 MBps              | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –¥–µ—à–µ–≤–ª–µ gp2  |
| **io1/io2** | –í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π IOPS         | –î–æ 64,000 IOPS                           | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º |
| **sc1**     | –ê—Ä—Ö–∏–≤/–Ω–∏–∑–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø         | –î–æ 250 IOPS                              | –°–∞–º—ã–π –¥–µ—à—ë–≤—ã–π, –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ö–æ–ª–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö    |
| **st1**     | –ß–∞—Å—Ç–æ —á–∏—Ç–∞–µ–º—ã–π, —Ä–µ–¥–∫–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–π  | –î–æ 500 IOPS                              | –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –ª–æ–≥–æ–≤             |

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –ò—Å–ø–æ–ª—å–∑—É–π `gp3` ‚Äî –æ–Ω –¥–µ—à–µ–≤–ª–µ `gp2` –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å IOPS –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ–±—ä—ë–º–∞.
- `gp2` ‚Äî —É—Å—Ç–∞—Ä–µ–ª, –µ–≥–æ –ª—É—á—à–µ –Ω–µ –≤—ã–±–∏—Ä–∞—Ç—å –¥–ª—è –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤.
- `io2` ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IOPS (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è PostgreSQL, Oracle).
- `sc1`, `st1` ‚Äî –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–µ—à—ë–≤—ã–π —Ç–æ–º –¥–ª—è —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üí° –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- `gp3`: –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã, CI/CD.
- `io2`: SQL-—Å–µ—Ä–≤–µ—Ä–∞, –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ë–î.
- `st1`: –•—Ä–∞–Ω–∏–ª–∏—â–∞ –ª–æ–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Elasticsearch).

### üîç –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Ç–∏–ø —Ç–æ–º–∞

```bash
aws ec2 describe-volumes --volume-ids vol-xxxxxxxxxxxxxxxxx
```

</p></details>

### ‚ùì 10. –ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç –±–∞–ª–∞–Ω—Å–µ—Ä—ã –≤ AWS –∏ —á–µ–º –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (17:19)](https://youtu.be/pLU3zrUq87Y?t=1040)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### AWS –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

### üìä –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –¢–∏–ø –±–∞–ª–∞–Ω—Å–µ—Ä–∞                       | –£—Ä–æ–≤–µ–Ω—å –º–æ–¥–µ–ª–∏ OSI       | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ | –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏               |
| ----------------------------------- | ------------------------ | ------------------------ | --------------------- | ------------------------------- |
| **Application Load Balancer (ALB)** | Application (HTTP/HTTPS) | HTTP, HTTPS              | ‚úÖ –î–∞                 | –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã    |
| **Network Load Balancer (NLB)**     | Transport (TCP/UDP)      | TCP, UDP, TLS            | ‚úÖ –î–∞                 | –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, IoT |
| **Gateway Load Balancer (GWLB)**    | Network (IP)             | IP (GENEVE)              | ‚ùå –ù–µ—Ç                | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–µ—Ç–µ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ |

### Application Load Balancer (ALB)

- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **7 —É—Ä–æ–≤–Ω–µ (HTTP/HTTPS)**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
  - Path-based routing (`/api/`, `/static/`)
  - Host-based routing (`api.example.com`)
  - WebSocket, HTTP/2
- –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è:
  - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (ECS/Fargate)
  - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ REST API

### Network Load Balancer (NLB)

- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **4 —É—Ä–æ–≤–Ω–µ (TCP/UDP)**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
  - –ü—Ä–æ–∑—Ä–∞—á–Ω—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é
  - TLS termination
  - –ú–≥–Ω–æ–≤–µ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è:
  - –ù–∏–∑–∫–æ–ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
  - –†–µ–∞–ª—Ç–∞–π–º-—Å–µ—Ä–≤–∏—Å–æ–≤, VoIP, —Ñ–∏–Ω—Ç–µ—Ö

### Gateway Load Balancer (GWLB)

- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **3 —É—Ä–æ–≤–Ω–µ (IP)**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
  - –ü—Ä–æ–∑—Ä–∞—á–Ω—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é IP-—Ç—Ä–∞—Ñ–∏–∫–∞
  - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Firewall/IDS/IPS (Check Point, Palo Alto –∏ –¥—Ä.)
- –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è:
  - –°–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Å–ø–µ–∫—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
  - –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ç–µ–≤—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –§—É–Ω–∫—Ü–∏—è                   | ALB | NLB | GWLB |
| ------------------------- | --- | --- | ---- |
| SSL termination           | ‚úÖ  | ‚úÖ  | ‚ùå   |
| WebSocket –ø–æ–¥–¥–µ—Ä–∂–∫–∞       | ‚úÖ  | ‚ùå  | ‚ùå   |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HTTP/2          | ‚úÖ  | ‚ùå  | ‚ùå   |
| Path/Host-based routing   | ‚úÖ  | ‚ùå  | ‚ùå   |
| IP-based –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è    | ‚ùå  | ‚úÖ  | ‚úÖ   |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ECS/Fargate     | ‚úÖ  | ‚úÖ  | ‚ùå   |
| Target Group –Ω–∞ –æ—Å–Ω–æ–≤–µ IP | ‚úÖ  | ‚úÖ  | ‚úÖ   |

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫–æ–π –±–∞–ª–∞–Ω—Å–µ—Ä

- **ALB** ‚Äî Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, REST API, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–æ—É—Ç–∏–Ω–≥
- **NLB** ‚Äî –†–µ–∞–ª—Ç–∞–π–º, –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ TCP/UDP-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- **GWLB** ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∏–Ω—Å–ø–µ–∫—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞, –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**üí° –í—ã–≤–æ–¥:**  
–í—ã–±–æ—Ä –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤, —É—Ä–æ–≤–Ω—è –º–æ–¥–µ–ª–∏ OSI, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

</p></details>

---

### ‚ùì 11. –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è Amazon Aurora —Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é PostgreSQL –æ—Ç –æ–±—ã—á–Ω–æ–π –æ–±–ª–∞—á–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Amazon RDS PostgreSQL?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (17:40)](https://youtu.be/pLU3zrUq87Y?t=1061)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### Amazon –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ä–∞–±–æ—Ç—ã —Å PostgreSQL –≤ –æ–±–ª–∞–∫–µ: **Aurora PostgreSQL** –∏ **RDS (Relational Database Service) PostgreSQL**. –û–±–∞ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Amazon RDS, –Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º.

### üìä –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞                               | Aurora PostgreSQL                           | RDS PostgreSQL                            |
| -------------------------------------------- | ------------------------------------------- | ----------------------------------------- |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**                              | –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ | –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è (EC2 + EBS)                  |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**                       | –î–æ 5√ó –±—ã—Å—Ç—Ä–µ–µ –ø–æ –∑–∞—è–≤–ª–µ–Ω–∏—é AWS              | –ë–ª–∏–∑–∫–∞ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É PostgreSQL          |
| **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**                            | ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å PostgreSQL                   | ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π PostgreSQL                 |
| **–í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**                      | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è, —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –Ω–∞ 6 –∫–æ–ø–∏–π –≤ 3 AZ | Multi-AZ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ –∂–µ–ª–∞–Ω–∏—é            |
| **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞** | ‚úÖ –î–∞, –¥–æ 128 –¢–ë                            | ‚úÖ –î–∞, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ |
| **–í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è**                     | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ–µ (—Å–µ–∫—É–Ω–¥—ã)                     | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è, –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∏–Ω—É—Ç—ã    |
| **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è**                               | Aurora Replicas (–¥–æ 15)                     | Read Replicas (–¥–æ 5, —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏)        |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å**                                | üí∞ –î–æ—Ä–æ–∂–µ                                   | üíµ –î–µ—à–µ–≤–ª–µ                                |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–ª–∞–≥–∏–Ω–æ–≤/—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π**            | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ (–Ω–µ –≤—Å–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è PostgreSQL)   | –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å                      |
| **–£—Ä–æ–≤–µ–Ω—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**                       | –ë–æ–ª–µ–µ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–µ, –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ    | –ë–ª–∏–∂–µ –∫ "—á–∏—Å—Ç–æ–º—É" PostgreSQL              |

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Aurora PostgreSQL

- –ù—É–∂–Ω–∞ **–≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ö—Ä–∏—Ç–∏—á–Ω–∞ **–≤—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** –∏ –±—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ **—á—Ç–µ–Ω–∏–µ —Å —Ä–µ–ø–ª–∏–∫**
- –î–æ–ø—É—Å—Ç–∏–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π PostgreSQL

### –ö–æ–≥–¥–∞ –≤—ã–±—Ä–∞—Ç—å RDS PostgreSQL

- –ù—É–∂–Ω–∞ **–ø–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PostgreSQL**
- –í–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è**
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Äî **–Ω–∏–∑–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å**
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **—Å—Ä–µ–¥–Ω–∏—Ö –∏ –º–∞–ª—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫**

### üí° –í—ã–≤–æ–¥

| –ï—Å–ª–∏ –Ω—É–∂–Ω–æ:                                     | –í—ã–±–æ—Ä             |
| ----------------------------------------------- | ----------------- |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å                 | ‚úÖ Aurora         |
| –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å                   | ‚úÖ RDS PostgreSQL |
| –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å | ‚úÖ Aurora         |
| –≠–∫–æ–Ω–æ–º–∏—á–Ω–æ–µ –∏ –≥–∏–±–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ                    | ‚úÖ RDS PostgreSQL |

**Aurora PostgreSQL** ‚Äî —ç—Ç–æ —É–ª—É—á—à–µ–Ω–Ω—ã–π, –æ–±–ª–∞—á–Ω–æ-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π PostgreSQL –æ—Ç AWS, –∞ **RDS PostgreSQL** ‚Äî —ç—Ç–æ —É–ø—Ä–∞–≤–ª—è–µ–º–∞—è –≤–µ—Ä—Å–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ PostgreSQL.

</p></details>

---

# 2. Linux –∏ Bash

### ‚ùì 1. –ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è LTS —Ä–µ–ª–∏–∑—ã –æ—Ç –æ–±—ã—á–Ω—ã—Ö?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (20:22)](https://youtu.be/pLU3zrUq87Y?t=1222)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

**LTS** (_Long-Term Support_) ‚Äî —ç—Ç–æ —Ä–µ–ª–∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å **–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π**, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç:

- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ LTS –∏ –æ–±—ã—á–Ω—ã—Ö —Ä–µ–ª–∏–∑–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π              | **LTS-—Ä–µ–ª–∏–∑**                          | **–û–±—ã—á–Ω—ã–π —Ä–µ–ª–∏–∑ (non-LTS)**           |
| --------------------- | -------------------------------------- | ------------------------------------- |
| **–°—Ä–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏**    | 3‚Äì10 –ª–µ—Ç                               | 6‚Äì12 –º–µ—Å—è—Ü–µ–≤                          |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**      | ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π              | ‚ùó –í–æ–∑–º–æ–∂–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å |
| **–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**     | ‚ùå –ú–∏–Ω–∏–º—É–º –Ω–æ–≤—à–µ—Å—Ç–≤, —Ç–æ–ª—å–∫–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ | ‚úÖ –ù–æ–≤—ã–µ –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏     |
| **–ß–∞—Å—Ç–æ—Ç–∞ —Ä–µ–ª–∏–∑–æ–≤**   | –†–µ–∂–µ (—Ä–∞–∑ –≤ 2‚Äì3 –≥–æ–¥–∞)                  | –ß–∞—â–µ (—Ä–∞–∑ –≤ 6‚Äì12 –º–µ—Å—è—Ü–µ–≤)             |
| **–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è** | –ë–∏–∑–Ω–µ—Å, –ø—Ä–æ–¥–∞–∫—à–Ω, —Å–µ—Ä–≤–µ—Ä—ã              | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, —Ç–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è      |

### ‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LTS?

- –î–ª—è **–ø—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–≤–µ—Ä–æ–≤**
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ **–¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- –í –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
- –ï—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—Ç—Å—è —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

### ‚ö†Ô∏è –ö–æ–≥–¥–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –æ–±—ã—á–Ω—ã–π —Ä–µ–ª–∏–∑?

- –î–ª—è **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
- –ß—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∏—Ç—å **–Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
- –í –∫—Ä–∞—Ç–∫–æ–∂–∏–≤—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö

### üí° –í—ã–≤–æ–¥

> **LTS** ‚Äî —ç—Ç–æ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞  
> **Non-LTS** ‚Äî —ç—Ç–æ —Å–≤–µ–∂–µ—Å—Ç—å, –≥–∏–±–∫–æ—Å—Ç—å –∏ –Ω–æ–≤–∏–∑–Ω–∞

–í—ã–±–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ü–µ–ª–µ–π: **–ø—Ä–æ–¥–∞–∫—à–Ω ‚Üí LTS**, **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ ‚Üí non-LTS**

</p></details>

---

### ‚ùì 2. –ü–æ—á–µ–º—É –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, Nginx) –≤ Linux-–¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞–∫–µ—Ç—ã —á–∞—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–µ —Å–∞–º–∞—è –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è, –∏ –∫–∞–∫ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (21:23)](https://youtu.be/pLU3zrUq87Y?t=1281)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

–í–æ –º–Ω–æ–≥–∏—Ö Linux-–¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö (–≤–∫–ª—é—á–∞—è Ubuntu, Debian, CentOS –∏ –¥—Ä.) –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞–∫–µ—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã (`apt`, `yum`, `dnf`) –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è **–Ω–µ —Å–∞–º—ã–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏**, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –±–æ–ª–µ–µ –Ω–æ–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è.

### üß© –ü—Ä–∏—á–∏–Ω–∞

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç **—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏**, –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ –Ω–∞ –º–æ–º–µ–Ω—Ç —Ä–µ–ª–∏–∑–∞ —Å–∞–º–æ–π –û–°. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Ä–∞–¥–∏:

- ‚úîÔ∏è –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- ‚úîÔ∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úîÔ∏è –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- ‚ùå –ù–æ –∑–∞ —Å—á—ë—Ç —Å–≤–µ–∂–µ—Å—Ç–∏

–ù–∞–ø—Ä–∏–º–µ—Ä:

```bash
sudo apt install nginx
```

–ù–∞ Ubuntu 22.04 –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Nginx 1.18, —Ö–æ—Ç—è –Ω–∞ [nginx.org](https://nginx.org/en/linux_packages.html) –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–µ—Ä—Å–∏—è 1.29.

### ‚úÖ –ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é

### Ubuntu / Debian:

1. –î–æ–±–∞–≤—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Nginx:

```bash
sudo apt install curl gnupg2 ca-certificates lsb-release
curl https://nginx.org/keys/nginx_signing.key | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/nginx.gpg > /dev/null

echo "deb http://nginx.org/packages/ubuntu $(lsb_release -cs) nginx" | sudo tee /etc/apt/sources.list.d/nginx.list
```

2. –û–±–Ω–æ–≤–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏:

```bash
sudo apt update
sudo apt install nginx
```

–¢–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å —Å–∞–π—Ç–∞ nginx.org.

### üí° –í—ã–≤–æ–¥

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Linux —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç **—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ, –Ω–æ –Ω–µ —Å–∞–º—ã–µ –Ω–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –ü–û** –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.  
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **–∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é**, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** –∏–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏.

</p></details>

---

### ‚ùì 3. –ï—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∏–ª–∏ –µ–≥–æ –∑–µ—Ä–∫–∞–ª–æ), –º–æ–∂–µ—Ç –ª–∏ –æ–Ω –≤–Ω–µ–¥—Ä–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥, –∏ –∫–∞–∫–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–¥–æ–±–Ω—ã—Ö —É–≥—Ä–æ–∑?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (23:04)](https://youtu.be/pLU3zrUq87Y?t=1281)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üõ°Ô∏è –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã

1. **–¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å –ø–∞–∫–µ—Ç–æ–≤ –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (GPG/PGP)**

- –í—Å–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –≤ Linux-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö –ø–æ–¥–ø–∏—Å–∞–Ω—ã.
- –ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ –ø–æ–¥–ø–∏—Å—å —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º –∫–ª—é—á–æ–º.
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ **–Ω–µ —Å–º–æ–∂–µ—Ç** –≤–Ω–µ–¥—Ä–∏—Ç—å –∫–æ–¥, –µ—Å–ª–∏ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ GPG-–∫–ª—é—á–∞.

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥–º–µ–Ω—É –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ –∑–µ—Ä–∫–∞–ª–∞—Ö.

2. **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã –∏ —Ö–µ—à–∏ (Checksums, Hashes)**

- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —á–∞—Å—Ç–æ –ø—É–±–ª–∏–∫—É—é—Ç SHA-256 –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ —Ö–µ—à–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–≤–µ—Ä—è—Ç—å —Ö–µ—à–∏ —Å–∫–∞—á–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏.

3. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ (Open Source)**

- –ï—Å–ª–∏ –ü–û –æ—Ç–∫—Ä—ã—Ç–æ–µ, —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –º–æ–∂–µ—Ç –∞—É–¥–∏—Ç–∏—Ç—å –∫–æ–¥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏–ª–∏ –±—ç–∫–¥–æ—Ä–æ–≤.
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤—Ä–æ–¥–µ GitHub/GitLab –ø–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ git log.

4. **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã**

- –õ–∏—Ü–µ–Ω–∑–∏–∏ (GPL, Apache) —Ç—Ä–µ–±—É—é—Ç —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —Å–∫—Ä—ã—Ç–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
- –í —Å–ª—É—á–∞–µ –Ω–∞—Ä—É—à–µ–Ω–∏–π –≤–æ–∑–º–æ–∂–Ω—ã —Å—É–¥–µ–±–Ω—ã–µ –∏—Å–∫–∏

</p></details>

---

### ‚ùì 4. –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ GPG-–ø–æ–¥–ø–∏—Å–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, docker) —á–µ—Ä–µ–∑ apt install, –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º —ç—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ Debian/Ubuntu?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (24:18)](https://youtu.be/pLU3zrUq87Y?t=1458)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç

### –î–∞, –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ `apt` –≤ —Å–∏—Å—Ç–µ–º–∞—Ö Debian –∏ Ubuntu **–≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ GPG-–ø–æ–¥–ø–∏—Å–∏**, –µ—Å–ª–∏ –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —É–∫–∞–∑–∞–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–ª—é—á. –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ–¥–º–µ–Ω—ã –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤.

### üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –ø–æ—à–∞–≥–æ–≤–æ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Docker

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã**

```bash
sudo apt update
sudo apt install ca-certificates curl gnupg lsb-release
```

- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É—Ç–∏–ª–∏—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ GPG-–∫–ª—é—á–∞.

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ GPG-–∫–ª—é—á–∞ Docker**

```bash
sudo mkdir -p /etc/apt/keyrings

curl -fsSL https://download.docker.com/linux/ubuntu/gpg \
  | gpg --dearmor \
  | sudo tee /etc/apt/keyrings/docker.gpg > /dev/null
```

‚úÖ **–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

- –ö–ª—é—á —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è **–ø–æ HTTPS** —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ `docker.com`
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ `.gpg`-—Ñ–æ—Ä–º–∞—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `/etc/apt/keyrings`
- –≠—Ç–æ—Ç –∫–ª—é—á –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è Docker

3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è Docker**

```bash
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
  https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" \
  | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

‚úÖ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–∞–∫–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω—ã **—Ç–µ–º —Å–∞–º—ã–º GPG-–∫–ª—é—á–æ–º**, –∫–æ—Ç–æ—Ä—ã–π –º—ã –¥–æ–±–∞–≤–∏–ª–∏.

4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π**

```bash
sudo apt update
```

üîê –í–æ –≤—Ä–µ–º—è —ç—Ç–æ–≥–æ:

- `apt` —Å–∫–∞—á–∏–≤–∞–µ—Ç `Release` –∏ `InRelease` —Ñ–∞–π–ª—ã
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Ö –ø–æ–¥–ø–∏—Å—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ GPG-–∫–ª—é—á–∞
- –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –Ω–µ–≤–∞–ª–∏–¥–Ω–∞ –∏–ª–∏ –∫–ª—é—á –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç ‚Äî `apt` –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É

5. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker**

```bash
sudo apt install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

- –ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π `apt` —Å–≤–µ—Ä–∏—Ç —Ö–µ—à –ø–∞–∫–µ—Ç–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º
- –£–±–µ–¥–∏—Ç—Å—è, —á—Ç–æ –æ–Ω –Ω–µ –±—ã–ª –∏–∑–º–µ–Ω—ë–Ω (—Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã)

### üõ°Ô∏è –ß—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å?

| –ê—Ç–∞–∫–∞                        | –ó–∞—â–∏—Ç–∞                                   |
| ---------------------------- | ---------------------------------------- |
| –ü–æ–¥–º–µ–Ω–∞ –ø–∞–∫–µ—Ç–∞               | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ GPG –∏ SHA256            |
| –ê—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ –∑–µ—Ä–∫–∞–ª–æ          | –ü–æ–¥–ø–∏—Å—å `Release` —Ñ–∞–π–ª–æ–≤                 |
| –ù–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã         | apt –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É                |
| –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø–µ—á–∞—Ç–∫–∞ |

### üìå –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å GPG-–∫–ª—é—á –≤—Ä—É—á–Ω—É—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
gpg --show-keys /etc/apt/keyrings/docker.gpg
```

–°—Ä–∞–≤–Ω–∏ –æ—Ç–ø–µ—á–∞—Ç–æ–∫ (`fingerprint`) —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º, –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–º –Ω–∞:

- https://docs.docker.com/engine/install/ubuntu/

</p></details>

---

### ‚ùì 5. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ, —Å —á–µ–≥–æ –Ω–∞—á–∞—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã (CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫, —Å–µ—Ç—å –∏ —Ç.–¥.) –∑–∞–≥—Ä—É–∂–µ–Ω—ã?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (25:02)](https://youtu.be/pLU3zrUq87Y?t=1502)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –≠—Ç–∞–ø 1: –û–±—â–∏–π –æ–±–∑–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

### üìä –ö–æ–º–∞–Ω–¥–∞ `top` –∏–ª–∏ `htop`

```bash
top
# –∏–ª–∏, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
htop
```

**–ü—Ä–æ–≤–µ—Ä—è–µ–º:**

- –ó–∞–≥—Ä—É–∑–∫–∞ CPU (`%us`, `%sy`, `%id`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (RES, SWAP)
- –ü—Ä–æ—Ü–µ—Å—Å—ã, –ø–æ—Ç—Ä–µ–±–ª—è—é—â–∏–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤

<details><summary><strong>–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã top</strong></summary><p>

### üìä –í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å ‚Äî –æ–±—â–∞—è —Å–≤–æ–¥–∫–∞

### üïí –°—Ç—Ä–æ–∫–∞ 1: –í—Ä–µ–º—è, –∞–ø—Ç–∞–π–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –Ω–∞–≥—Ä—É–∑–∫–∞

```
top - 14:23:45 up 3 days,  4:56,  2 users,  load average: 0.52, 0.48, 0.31
```

| –ü–æ–ª–µ           | –ó–Ω–∞—á–µ–Ω–∏–µ                            |
| -------------- | ----------------------------------- |
| `14:23:45`     | –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è                       |
| `up 3 days...` | –ê–ø—Ç–∞–π–º ‚Äî –∫–∞–∫ –¥–æ–ª–≥–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ |
| `2 users`      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π   |
| `load average` | –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∑–∞ 1, 5, 15 –º–∏–Ω—É—Ç  |

### üìã –°—Ç—Ä–æ–∫–∞ 2: –ó–∞–¥–∞—á–∏ (–ø—Ä–æ—Ü–µ—Å—Å—ã)

```
Tasks: 215 total, 1 running, 211 sleeping, 3 stopped, 0 zombie
```

| –°—Ç–∞—Ç—É—Å     | –ó–Ω–∞—á–µ–Ω–∏–µ                 |
| ---------- | ------------------------ |
| `total`    | –í—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤          |
| `running`  | –ê–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è      |
| `sleeping` | –ñ–¥—É—Ç —Å–æ–±—ã—Ç–∏–π             |
| `stopped`  | –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã              |
| `zombie`   | –ó–∞–≤–µ—Ä—à–µ–Ω—ã, –Ω–æ –Ω–µ —É–¥–∞–ª–µ–Ω—ã |

### üß† –°—Ç—Ä–æ–∫–∞ 3: –ó–∞–≥—Ä—É–∑–∫–∞ CPU

```
%us  %sy  %ni  %id  %wa  %hi  %si  %st
```

| –ü–æ–ª–µ  | –û–ø–∏—Å–∞–Ω–∏–µ                                 |
| ----- | ---------------------------------------- |
| `%us` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞                |
| `%sy` | –°–∏—Å—Ç–µ–º–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞                       |
| `%ni` | Nice ‚Äî –ø—Ä–æ—Ü–µ—Å—Å—ã —Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º |
| `%id` | Idle ‚Äî –ø—Ä–æ—Å—Ç–∞–∏–≤–∞—é—â–µ–µ –≤—Ä–µ–º—è               |
| `%wa` | Wait ‚Äî –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞             |
| `%hi` | Hardware interrupts                      |
| `%si` | Software interrupts                      |
| `%st` | Steal time (–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö)      |

### üßÆ –°—Ç—Ä–æ–∫–∏ 4‚Äì5: –ü–∞–º—è—Ç—å –∏ swap

```
MiB Mem :  15929.0 total,  11054.7 used,  4874.3 free,  132.5 buffers
MiB Swap:  2048.0 total,   112.0 used,  1936.0 free.  3674.0 cached
```

| –ü–æ–ª–µ      | –ó–Ω–∞—á–µ–Ω–∏–µ            |
| --------- | ------------------- |
| `total`   | –û–±—â–∏–π –æ–±—ä—ë–º –ø–∞–º—è—Ç–∏  |
| `used`    | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ–π—á–∞—Å |
| `free`    | –°–≤–æ–±–æ–¥–Ω–∞            |
| `buffers` | –ë—É—Ñ–µ—Ä—ã –¥–ª—è I/O      |
| `cached`  | –§–∞–π–ª–æ–≤—ã–π –∫—ç—à        |

### üìã –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–Ω–∏–∂–Ω—è—è —á–∞—Å—Ç—å)

```
PID USER  PR  NI VIRT  RES  SHR S %CPU %MEM TIME+ COMMAND
```

| –ü–æ–ª–µ      | –ó–Ω–∞—á–µ–Ω–∏–µ                        |
| --------- | ------------------------------- |
| `PID`     | ID –ø—Ä–æ—Ü–µ—Å—Å–∞                     |
| `USER`    | –í–ª–∞–¥–µ–ª–µ—Ü –ø—Ä–æ—Ü–µ—Å—Å–∞               |
| `PR`      | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç                       |
| `NI`      | Nice-–∑–Ω–∞—á–µ–Ω–∏–µ                   |
| `VIRT`    | –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å              |
| `RES`     | –†–µ–∑–∏–¥–µ–Ω—Ç–Ω–∞—è (—Ñ–∏–∑–∏—á–µ—Å–∫–∞—è) –ø–∞–º—è—Ç—å |
| `SHR`     | Shared memory                   |
| `S`       | –°—Ç–∞—Ç—É—Å: R, S, Z –∏ —Ç.–¥.          |
| `%CPU`    | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU               |
| `%MEM`    | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏            |
| `TIME+`   | –û–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã CPU          |
| `COMMAND` | –ó–∞–ø—É—â–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞              |

### ‚å®Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏ `top`

| –ö–ª–∞–≤–∏—à–∞ | –û–ø–∏—Å–∞–Ω–∏–µ              |
| ------- | --------------------- |
| `P`     | –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ CPU    |
| `M`     | –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–∞–º—è—Ç–∏ |
| `c`     | –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫–æ–º–∞–Ω–¥—ã   |
| `k`     | –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å         |
| `r`     | –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç    |
| `q`     | –í—ã–π—Ç–∏                 |

### ‚úÖ –í—ã–≤–æ–¥

`top` –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É CPU, RAM –∏ swap
- –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∏ "—Ç—è–∂—ë–ª—ã–µ" –ø—Ä–æ—Ü–µ—Å—Å—ã
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

</p></details>

### –≠—Ç–∞–ø 2: –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

üîç –ö–æ–º–∞–Ω–¥–∞ `mpstat` (–∏–∑ `sysstat`)

```bash
sudo apt install sysstat
mpstat -P ALL 1 5
```

**–ù–∞ —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:**

- `%idle` ‚Äî —á–µ–º –Ω–∏–∂–µ, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω CPU
- `%usr`, `%sys` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏ —Å–∏—Å—Ç–µ–º–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

### ‚úÖ –≠—Ç–∞–ø 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### üîç –ö–æ–º–∞–Ω–¥—ã `free`, `vmstat`

```bash
free -h
```

**–í–∞–∂–Ω–æ:**

- `available` ‚Äî —Å–∫–æ–ª—å–∫–æ –ø–∞–º—è—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ
- –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `swap` ‚Üí –Ω–µ—Ö–≤–∞—Ç–∫–∞ RAM

```bash
vmstat 1 5
```

### ‚úÖ –≠—Ç–∞–ø 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### üìÇ –ö–æ–º–∞–Ω–¥—ã `iostat` –∏ `iotop`

```bash
iostat -xz 1
```

**–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**

- `util` > 70‚Äì80% ‚Üí –¥–∏—Å–∫ –∑–∞–≥—Ä—É–∂–µ–Ω
- `await` > 20‚Äì30 –º—Å ‚Üí –º–µ–¥–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```bash
sudo iotop
```

### ‚úÖ –≠—Ç–∞–ø 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### üåê –ö–æ–º–∞–Ω–¥–∞ `iftop` –∏–ª–∏ `nload`

```bash
sudo apt install iftop nload
sudo iftop -i eth0
nload
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**

- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ –ø–æ—Ç–æ–∫–∏
- –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### ‚úÖ –≠—Ç–∞–ø 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –Ω–∞–≥—Ä—É–∑–æ–∫

### üîç `ps`, `pidstat`, `strace`, `perf`

```bash
ps aux --sort=-%cpu | head
ps aux --sort=-%mem | head
```

```bash
pidstat -p <PID> 1
```

–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å "–∑–∞–≤–∏—Å" ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã:

```bash
strace -p <PID>
```

### üß† –û–±—â–∞—è —Ç–∞–∫—Ç–∏–∫–∞

| –ü—Ä–æ–≤–µ—Ä–∫–∞            | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç                           |
| ------------------- | ------------------------------------ |
| –ó–∞–≥—Ä—É–∑–∫–∞ CPU        | `top`, `htop`, `mpstat`              |
| –ü–∞–º—è—Ç—å              | `free`, `vmstat`                     |
| –î–∏—Å–∫                | `iostat`, `iotop`                    |
| –°–µ—Ç—å                | `iftop`, `nload`                     |
| –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã | `ps`, `pidstat`, `strace`, `lsof`    |
| –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ / –ë–î     | –õ–æ–≥–∏, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ APM |

## üí° –í—ã–≤–æ–¥

> –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π —Å **–æ–±—â–µ–π –∫–∞—Ä—Ç–∏–Ω—ã**: CPU, –ø–∞–º—è—Ç—å, –¥–∏—Å–∫, —Å–µ—Ç—å.  
> –ó–∞—Ç–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞–º**, –∏—Å–ø–æ–ª—å–∑—É—è `pidstat`, `strace`, `iotop`.  
> –•–æ—Ä–æ—à–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ = –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–µ–ø—ã—Ö –∑–æ–Ω.

</p></details>

---

### ‚ùì 6. –ò—Å–ø–æ–ª—å–∑—É—é—Ç –ª–∏ –æ–±—ã—á–Ω–æ swap?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (26:11)](https://youtu.be/pLU3zrUq87Y?t=1571)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üì¶ –ß—Ç–æ —Ç–∞–∫–æ–µ swap?

**Swap** ‚Äî —á–∞—Å—Ç—å –¥–∏—Å–∫–∞ (—Ä–∞–∑–¥–µ–ª –∏–ª–∏ —Ñ–∞–π–ª), –∫–æ—Ç–æ—Ä—É—é —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞–∫ RAM, –∫–æ–≥–¥–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è. –≠—Ç–æ "—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞", –Ω–æ **–æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–∞—è** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ä–µ–∞–ª—å–Ω–æ–π RAM.

### ‚úÖ –ü–ª—é—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è swap

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ                           | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ                                                       |
| -------------------------------------- | ---------------------------------------------------------------- |
| üîÑ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç `Out of Memory (OOM)` | –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∞–≤–∞—Ä–∏–π–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ RAM          |
| üí§ –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç RAM                     | –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ swap                             |
| üìà –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö  | –ü–æ–∑–≤–æ–ª—è–µ—Ç "–ø–µ—Ä–µ–∂–∏—Ç—å" –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—Å–ø–ª–µ—Å–∫–∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ |

### ‚ùå –ú–∏–Ω—É—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è swap

| –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫                | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ                                             |
| ------------------------- | ------------------------------------------------------ |
| üêå –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø | Swap —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–æ—Ç–Ω–∏ —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ RAM (–¥–∞–∂–µ –Ω–∞ SSD)  |
| üîÑ –°–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã      | –ú–æ–∂–µ—Ç –º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| üö® –ò–∑–Ω–æ—Å SSD              | –ß–∞—Å—Ç–∞—è –∑–∞–ø–∏—Å—å —É—Å–∫–æ—Ä—è–µ—Ç –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é SSD-–¥–∏—Å–∫–æ–≤           |

### üñ•Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç –ª–∏ swap –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ?

### üßë‚Äçüíª –†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏:

- ‚úÖ –û–±—ã—á–Ω–æ –≤–∫–ª—é—á—ë–Ω
- ‚õë –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ—Ö–≤–∞—Ç–∫–∏ –ø–∞–º—è—Ç–∏

### üì¶ –°–µ—Ä–≤–µ—Ä—ã:

- üü® –ß–∞—Å—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç swap –¥–æ 1‚Äì2 –ì–ë
- ‚ùå –ò–Ω–æ–≥–¥–∞ –æ—Ç–∫–ª—é—á–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é (–æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –º–Ω–æ–≥–æ RAM)

### üì± –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ/IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:

- ‚ùå –û–±—ã—á–Ω–æ –æ—Ç–∫–ª—é—á—ë–Ω, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ä—Ç–∏—Ç—å —Ñ–ª–µ—à-–ø–∞–º—è—Ç—å

## ‚öôÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

| –û–±—ä—ë–º RAM     | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π swap                                           |
| ------------- | -------------------------------------------------------------- |
| < 4 –ì–ë        | 2‚Äì4 –ì–ë                                                         |
| 4‚Äì8 –ì–ë        | 1‚Äì2 –ì–ë                                                         |
| > 8 –ì–ë        | 0.5‚Äì1 –ì–ë –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å                                         |
| –° —Å–µ—Ä–≤–µ—Ä–æ–º –ë–î | Swap –≤–∫–ª—é—á—ë–Ω, –Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º ‚Äî –±–∞–∑—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –≤ –Ω–µ–≥–æ –ø–æ–ø–∞–¥–∞—Ç—å |

## üõ† –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ swap

```bash
free -h
swapon --show
```

## ‚úÖ –í—ã–≤–æ–¥

> Swap ‚Äî —ç—Ç–æ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞, –∞ –Ω–µ –∑–∞–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.  
> –ï–≥–æ **–Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–µ–∑–Ω–æ**, –Ω–æ **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–Ω –¥–æ–ª–∂–µ–Ω —Ä–µ–¥–∫–æ**.  
> –ï—Å–ª–∏ swap –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚Üí –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å RAM –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ü–û.

</p></details>

---

### ‚ùì 7. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º swap –≤–∫–ª—é—á–µ–Ω, –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –∫–∞–∫–æ-—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–∞–º—è—Ç—å —Ä–µ–∑–∫–æ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å. –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (27:47)](https://youtu.be/pLU3zrUq87Y?t=1667)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üß† –ü–æ—à–∞–≥–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ –®–∞–≥ 1: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤–æ–±–æ–¥–Ω–∞—è RAM

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—É—é –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å.
- –ö—ç—à –∏ –±—É—Ñ–µ—Ä—ã —è–¥—Ä–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã—Ç–µ—Å–Ω–µ–Ω—ã.

### ‚úÖ –®–∞–≥ 2: –í–∫–ª—é—á–∞–µ—Ç—Å—è swap

- –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞–º—è—Ç–∏ (—Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Ñ–æ–Ω–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å) –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ –≤ swap.
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ **–∑–∞–º–µ—Ç–Ω–æ –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è**.

### ‚ö†Ô∏è –®–∞–≥ 3: Swap –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è

- –ï—Å–ª–∏ –∏ RAM, –∏ swap –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–Ω—è—Ç—ã, —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø—ã—Ç—ã–≤–∞–µ—Ç "memory pressure".
- –ù–∞—á–∏–Ω–∞—é—Ç—Å—è **–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü**, —á—Ç–æ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ –Ω–∞–≥—Ä—É–∑–∏—Ç—å –¥–∏—Å–∫.

### üö® –®–∞–≥ 4: –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç OOM Killer (Out Of Memory)

- –Ø–¥—Ä–æ Linux –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º `oom-killer`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫—Ä–∞—Ö–∞.
- –ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ "–ø—Ä–æ–∂–æ—Ä–ª–∏–≤—ã–π" –ø—Ä–æ—Ü–µ—Å—Å (–ø–æ `oom_score`).
- –û–±—ã—á–Ω–æ –∂–µ—Ä—Ç–≤—É–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å —Å –±–æ–ª—å—à–∏–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏ –∏ –Ω–∏–∑–∫–æ–π –≤–∞–∂–Ω–æ—Å—Ç—å—é.

### üîé –ß—Ç–æ –º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å

| –ú–µ—Ç—Ä–∏–∫–∞/–°–∏–º–ø—Ç–æ–º         | –ö–æ–º–∞–Ω–¥–∞                    |
| ----------------------- | -------------------------- | ------------- |
| –†–æ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è swap | `free -h`, `top`, `vmstat` |
| –í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–∏—Å–∫–∞  | `iotop`, `iostat`          |
| CPU `%wa` (I/O wait)    | `top`, `mpstat`            |
| –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã    | `dmesg                     | grep -i kill` |

### üõ°Ô∏è –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å

| –ú–µ—Ç–æ–¥                            | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ                                                              |
| -------------------------------- | ----------------------------------------------------------------------- |
| üìà –£–≤–µ–ª–∏—á–∏—Ç—å RAM                 | –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–π —Å–ø–æ—Å–æ–±                                                       |
| üßØ –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ | `cgroups`, `systemd` –ª–∏–º–∏—Ç—ã, Docker `--memory`                          |
| üîß –ù–∞—Å—Ç—Ä–æ–∏—Ç—å swappiness          | –ó–Ω–∞—á–µ–Ω–∏–µ 0‚Äì100: —á–µ–º –Ω–∏–∂–µ ‚Äî —Ç–µ–º —Ä–µ–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è swap (`vm.swappiness`) |
| üö´ –û—Ç–∫–ª—é—á–∏—Ç—å swap                | –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ RAM –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç–µ –≤—Å—ë                          |
| üìä –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥          | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Prometheus`, `Zabbix`, `Grafana`, –∞–ª–µ—Ä—Ç—ã                   |

### ‚úÖ –í—ã–≤–æ–¥

> –ï—Å–ª–∏ swap –≤–∫–ª—é—á—ë–Ω ‚Äî —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Å—Ç–∞—Ä–∞—Ç—å—Å—è **–≤—ã–∂–∏—Ç—å** –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ RAM, –Ω–æ:
>
> - –≠—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ **—Å–∏–ª—å–Ω–æ–º—É –∑–∞–º–µ–¥–ª–µ–Ω–∏—é**
> - –ò –º–æ–∂–µ—Ç –∑–∞–∫–æ–Ω—á–∏—Ç—å—Å—è **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º —É–±–∏–π—Å—Ç–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**
>   ‚ùó –ê–∫—Ç–∏–≤–Ω—ã–π swap ‚Äî —ç—Ç–æ —Å–∏–≥–Ω–∞–ª: **–Ω–∞–¥–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞–º—è—Ç—å –∏–ª–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã**.

</p></details>

---

### ‚ùì 8. –ß—Ç–æ —Ç–∞–∫–æ–µ OOM Killer

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (29:34)](https://youtu.be/pLU3zrUq87Y?t=1774)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### **OOM Killer (Out Of Memory Killer)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –≤ —è–¥—Ä–µ Linux, –∫–æ—Ç–æ—Ä—ã–π **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã**, –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–µ **–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ swap**.

### ‚ùì –ó–∞—á–µ–º –Ω—É–∂–µ–Ω OOM Killer?

–ö–æ–≥–¥–∞ –≤ —Å–∏—Å—Ç–µ–º–µ:

- –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–Ω—è—Ç–∞ **RAM**
- –ò—Å—á–µ—Ä–ø–∞–Ω **swap**
- –ù–µ–ª—å–∑—è –±–æ–ª—å—à–µ –≤—ã—Ç–µ—Å–Ω–∏—Ç—å –∫—ç—à –∏–ª–∏ —Ñ–æ–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

‚Üí –°–∏—Å—Ç–µ–º–∞ —Ä–∏—Å–∫—É–µ—Ç **–ø–æ–≤–∏—Å–Ω—É—Ç—å –∏–ª–∏ –∫—Ä–∞—à–Ω—É—Ç—å—Å—è**. –ß—Ç–æ–±—ã —ç—Ç–æ–≥–æ –Ω–µ –¥–æ–ø—É—Å—Ç–∏—Ç—å, —è–¥—Ä–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç **OOM Killer**, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å.

### ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç OOM Killer

1. –Ø–¥—Ä–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ:

   - –û–±—ä—ë–º—É –ø–æ—Ç—Ä–µ–±–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (—Å–∏—Å—Ç–µ–º–Ω—ã–π –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π)
   - `oom_score` –∏ `oom_score_adj`

2. –í—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å —Å **–Ω–∞–∏–≤—ã—Å—à–∏–º `oom_score`**

3. –ü—Ä–æ—Ü–µ—Å—Å **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è** (—Å–∏–≥–Ω–∞–ª `SIGKILL`)

### üìã –ì–¥–µ —É–≤–∏–¥–µ—Ç—å, –∫–æ–≥–æ —É–±–∏–ª OOM Killer?

```bash
dmesg | grep -i "kill"
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
Out of memory: Kill process 12345 (python) score 970 or sacrifice child
Killed process 12345 (python) total-vm:4G
```

### üîç –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å `oom_score` –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
cat /proc/<PID>/oom_score
```

–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:

```bash
for pid in $(ls /proc | grep -E '^[0-9]+$'); do
  if [ -f /proc/$pid/oom_score ]; then
    echo "$pid $(cat /proc/$pid/oom_score)"
  fi
done | sort -k2 -n
```

### üõ°Ô∏è –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç OOM Killer

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å `oom_score_adj`:

```bash
# -1000 –æ–∑–Ω–∞—á–∞–µ—Ç: –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–±–∏–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å
echo -1000 > /proc/<PID>/oom_score_adj
```

### –ß–µ—Ä–µ–∑ systemd:

```ini
[Service]
OOMScoreAdjust=-1000
```

### ‚ö†Ô∏è –ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –±–ª–∏–∑–∫–∞ –∫ OOM?

- –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM –∏ swap
- `top` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–æ—Å—Ç `%wa`
- `dmesg` —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ OOM Killer
- –õ–æ–≥–∏ —Å SIGKILL –±–µ–∑ –≤–∏–¥–∏–º–æ–π –ø—Ä–∏—á–∏–Ω—ã

### ‚úÖ –í—ã–≤–æ–¥

- OOM Killer ‚Äî –∑–∞—â–∏—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç –∫—Ä–∞—Ö–∞ —Å–∏—Å—Ç–µ–º—ã
- –ó–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–∞–º—è—Ç—å
- –ï–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ ‚Äî **—Ç—Ä–µ–≤–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª** –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –ø–∞–º—è—Ç—å—é
- –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**

</p></details>

---

### ‚ùì 9. –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∏–≥–Ω–∞–ª—ã –≤ Linux?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (30:53)](https://youtu.be/pLU3zrUq87Y?t=1853)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### **–°–∏–≥–Ω–∞–ª** ‚Äî —ç—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —è–¥—Ä–æ –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥—Ä—É–≥–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É, —á—Ç–æ–±—ã —Å–æ–æ–±—â–∏—Ç—å –æ –∫–∞–∫–æ–º-—Ç–æ —Å–æ–±—ã—Ç–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ, –æ—à–∏–±–∫–µ –∏ —Ç.–¥.).

### üß† –ó–∞—á–µ–º –Ω—É–∂–Ω—ã —Å–∏–≥–Ω–∞–ª—ã?

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                   | –ü—Ä–∏–º–µ—Ä —Å–∏–≥–Ω–∞–ª–∞       |
| ---------------------------- | -------------------- |
| –ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å            | `SIGTERM`, `SIGKILL` |
| –ü—Ä–µ—Ä–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ          | `SIGINT`             |
| –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å        | `SIGHUP`             |
| –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É            | `SIGSEGV`, `SIGFPE`  |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ | `SIGSTOP`, `SIGCONT` |

### üìã –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏–≥–Ω–∞–ª—ã

| –°–∏–≥–Ω–∞–ª    | –ù–æ–º–µ—Ä | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                 |
| --------- | ----- | ------------------------------------------ |
| `SIGHUP`  | 1     | –ü–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (reload)           |
| `SIGINT`  | 2     | –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (`Ctrl+C`)         |
| `SIGQUIT` | 3     | –ü—Ä–µ—Ä–≤–∞—Ç—å + core dump (`Ctrl+\`)            |
| `SIGKILL` | 9     | –ë–µ–∑—É—Å–ª–æ–≤–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–Ω–µ–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º—ã–π) |
| `SIGTERM` | 15    | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)       |
| `SIGSTOP` | 19    | –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ (`Ctrl+Z`)           |
| `SIGCONT` | 18    | –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞                     |
| `SIGUSR1` | 10    | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å–∏–≥–Ω–∞–ª 1                  |
| `SIGUSR2` | 12    | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å–∏–≥–Ω–∞–ª 2                  |
| `SIGSEGV` | 11    | –û—à–∏–±–∫–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (crash)                 |

### üìü –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üîÅ `SIGHUP` ‚Äî –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥

```bash
kill -SIGHUP <PID>
```

–ü—Ä–∏–º–µ—Ä: `nginx -s reload` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `SIGHUP`, —á—Ç–æ–±—ã nginx –ø–µ—Ä–µ—á–∏—Ç–∞–ª `nginx.conf`.

### ‚õî `SIGINT` ‚Äî –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ö–æ–≥–¥–∞ –≤—ã –Ω–∞–∂–∏–º–∞–µ—Ç–µ `Ctrl+C` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `SIGINT`.

```bash
^C
```

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å `SIGINT` –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è.

### üì§ –ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª –ø—Ä–æ—Ü–µ—Å—Å—É

```bash
kill -SIGTERM <PID>    # –ü–æ –∏–º–µ–Ω–∏
kill -9 <PID>          # –ü–æ –Ω–æ–º–µ—Ä—É (9 = SIGKILL)
```

### üß™ –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å–∏–≥–Ω–∞–ª—ã

| –°—Ñ–µ—Ä–∞          | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ                         |
| -------------- | ---------------------------------- |
| –î–µ–º–æ–Ω—ã/—Å–µ—Ä–≤–∏—Å—ã | `SIGHUP` –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤ |
| –¢–µ—Ä–º–∏–Ω–∞–ª       | `SIGINT`, `SIGSTOP`, `SIGCONT`     |
| –°–∫—Ä–∏–ø—Ç—ã        | `trap` –Ω–∞ `SIGINT`, `SIGTERM`      |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã     | Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `SIGTERM`        |

### ‚úÖ –í—ã–≤–æ–¥

- –°–∏–≥–Ω–∞–ª—ã ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–∏—Å—Ç–µ–º–µ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤–ª–∏—è—Ç—å –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–∏–≥–Ω–∞–ª—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ ‚Äî –Ω–µ—Ç (`SIGKILL`, `SIGSTOP`)

</p></details>

---

### ‚ùì 10. –ö–∞–∫ –ø–æ–Ω—è—Ç—å –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏–ª–∏ —Å –æ—à–∏–±–∫–æ–π?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (31:51)](https://youtu.be/pLU3zrUq87Y?t=1911)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Linux –∏ Unix-–ø–æ–¥–æ–±–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∫–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É —Å **–∫–æ–¥–æ–º –≤–æ–∑–≤—Ä–∞—Ç–∞ (exit code)**. –≠—Ç–æ—Ç –∫–æ–¥ —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –ª–∏ –æ–Ω —É—Å–ø–µ—à–Ω–æ –∏–ª–∏ —Å –æ—à–∏–±–∫–æ–π.

### üìå –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ

| –ö–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è | –ó–Ω–∞—á–µ–Ω–∏–µ            |
| -------------- | ------------------- |
| `0`            | –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ |
| `!= 0`         | –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞    |

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã:

```bash
echo $?
```

–ü—Ä–∏–º–µ—Ä:

```bash
ls /tmp
echo $?    # 0 ‚Äî –≤—Å—ë —Ö–æ—Ä–æ—à–æ

ls /no_such_file
echo $?    # 2 ‚Äî –æ—à–∏–±–∫–∞
```

### üìã –ß–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–µ—Å—è –∫–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥     | –ó–Ω–∞—á–µ–Ω–∏–µ                        |
| ------- | ------------------------------- |
| `0`     | –£—Å–ø–µ—Ö                           |
| `1`     | –û–±—â–∞—è –æ—à–∏–±–∫–∞                    |
| `2`     | –§–∞–π–ª/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã      |
| `126`   | –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–∞           |
| `127`   | –ö–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞              |
| `128+n` | –ó–∞–≤–µ—Ä—à–µ–Ω–æ –ø–æ —Å–∏–≥–Ω–∞–ª—É `n`        |
| `130`   | –ó–∞–≤–µ—Ä—à–µ–Ω–æ `Ctrl+C` (SIGINT)     |
| `137`   | –£–±–∏—Ç–æ `SIGKILL` (–Ω–∞–ø—Ä–∏–º–µ—Ä, OOM) |

### üß™ –ü—Ä–∏–º–µ—Ä –≤ Bash

```bash
#!/bin/bash
my_command
if [ $? -ne 0 ]; then
  echo "–ö–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π"
else
  echo "–ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ"
fi
```

### üí° –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
some_command || echo "–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã"
```

### üßµ –ü—Ä–∏–º–µ—Ä –≤ Python

```python
import subprocess

result = subprocess.run(["ls", "/not_found"])
print("–ö–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:", result.returncode)
```

### üîß –í CI/CD, Makefile –∏ —Å–∫—Ä–∏–ø—Ç–∞—Ö

–í–µ–∑–¥–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ `$?`, –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–ª–∏ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ:

```bash
set -e  # –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ
```

### ‚úÖ –í—ã–≤–æ–¥

- –ö–æ–¥ `0` ‚Äî —ç—Ç–æ —É—Å–ø–µ—Ö
- –õ—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚â† 0 ‚Äî –æ—à–∏–±–∫–∞
- –ü—Ä–æ–≤–µ—Ä—è–π `$?` –∏–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π `exit code` –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

</p></details>

---

### ‚ùì 11. –ö–∞–∫ —É–∑–Ω–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ ‚Äî –µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞, –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É –∏ –¥—Ä—É–≥—É—é —Å–≤—è–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (32:22)](https://youtu.be/pLU3zrUq87Y?t=1942)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Linux –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ **–∑–∞–ø—É—â–µ–Ω–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ**: –µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞, –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É –∏ –¥—Ä—É–≥–æ–µ. –ù–∏–∂–µ ‚Äî —Å–ø–æ—Å–æ–±—ã —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å.

### üìå 1. –£–∑–Ω–∞—Ç—å PID –ø—Ä–æ—Ü–µ—Å—Å–∞

–°–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥—ë–º PID (Process ID):

```bash
ps aux | grep <–∏–º—è_–ø—Ä–æ—Ü–µ—Å—Å–∞>
```

–∏–ª–∏

```bash
pidof <–∏–º—è_–ø—Ä–æ—Ü–µ—Å—Å–∞>
```

### üßµ 2. –ü–æ–ª—É—á–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞

```bash
cat /proc/<PID>/cmdline
```

–ü—Ä–∏–º–µ—Ä:

```bash
cat /proc/1234/cmdline
```

> –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã `\0`, –º–æ–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫—Ä–∞—Å–∏–≤–æ:

```bash
tr '\0' ' ' < /proc/1234/cmdline
```

### üåê 3. –£–∑–Ω–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
cat /proc/<PID>/environ
```

–û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å:

```bash
tr '\0' '\n' < /proc/<PID>/environ
```

### üß≠ 4. –ü—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É

```bash
readlink -f /proc/<PID>/exe
```

### üìÅ 5. –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
readlink -f /proc/<PID>/cwd
```

### üß™ –ü—Ä–∏–º–µ—Ä: –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ `nginx`

```bash
ps aux | grep nginx
pidof nginx
cat /proc/1234/environ | tr '\0' '\n'
cat /proc/1234/cmdline | tr '\0' ' '
readlink -f /proc/1234/exe
```

### üìå –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: `ps`

```bash
ps -p <PID> -o pid,ppid,cmd,etime
```

–ò–ª–∏:

```bash
ps eww -p <PID>    # –ü–æ–∫–∞–∂–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

### ‚úÖ –í—ã–≤–æ–¥

–° –ø–æ–º–æ—â—å—é `/proc/<PID>/` –∏ –∫–æ–º–∞–Ω–¥—ã `ps` –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å:

- –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—É—Ç—å –∫ –±–∏–Ω–∞—Ä–Ω–∏–∫—É
- –¢–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã

> –≠—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ‚Äî –æ—Å–Ω–æ–≤–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ Linux

</p></details>

---

### ‚ùì 12. –ö–∞–∫ –ø–æ–Ω—è—Ç—å –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –æ—Ç–∫—Ä—ã—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (33:37)](https://youtu.be/pLU3zrUq87Y?t=2017)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Linux –∫–∞–∂–¥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø—Ä–æ—Ü–µ—Å—Å) –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã: –æ–±—ã—á–Ω—ã–µ —Ñ–∞–π–ª—ã, —Å–æ–∫–µ—Ç—ã, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–∞–Ω–∞–ª—ã –∏ —Ç.–¥. –ù–∏–∂–µ ‚Äî —Å–ø–æ—Å–æ–±—ã, –∫–∞–∫ —ç—Ç–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å.

### ‚úÖ –°–ø–æ—Å–æ–± 1: `lsof` ‚Äî List Open Files

–°–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±.

```bash
lsof -p <PID>
```

–ü—Ä–∏–º–µ—Ä:

```bash
lsof -p 1234
```

### –ß—Ç–æ –ø–æ–∫–∞–∂–µ—Ç:

- –ò–º—è —Ñ–∞–π–ª–∞
- –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1u`, `2w`)
- –¢–∏–ø —Ñ–∞–π–ª–∞: `REG`, `DIR`, `CHR`, `IPv4`, `unix` –∏ –¥—Ä.
- –î–æ—Å—Ç—É–ø: read (`r`), write (`w`), update (`u`)

### –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:

```bash
lsof -u www-data        # –≤—Å–µ —Ñ–∞–π–ª—ã, –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
lsof -i                 # –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
lsof /var/log/nginx     # –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç —Ñ–∞–π–ª
```

### ‚úÖ –°–ø–æ—Å–æ–± 2: `/proc/<PID>/fd` ‚Äî —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã

```bash
ls -l /proc/<PID>/fd
```

–ü—Ä–∏–º–µ—Ä:

```bash
ls -l /proc/1234/fd
```

–ö–∞–∂–¥—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä ‚Äî —ç—Ç–æ —Å–∏–º–≤–æ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã–π —Ñ–∞–π–ª.

–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø—É—Ç–∏:

```bash
readlink -f /proc/1234/fd/*
```

### ‚úÖ –°–ø–æ—Å–æ–± 3: `fuser` ‚Äî –∫—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª

```bash
fuser /path/to/file
```

–ü—Ä–∏–º–µ—Ä:

```bash
fuser /var/log/syslog
```

–ü–æ–∫–∞–∂–µ—Ç PID'—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª.

### üß† –ö–æ–≥–¥–∞ –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è

- –û—Ç–ª–∞–¥–∫–∞ –ª–æ–≥–æ–≤: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∏—à–µ—Ç –∏–ª–∏ –Ω–µ –æ—Ç–ø—É—Å–∫–∞–µ—Ç –ª–æ–≥-—Ñ–∞–π–ª
- –£—Ç–µ—á–∫–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ (—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ `open file handles`)
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ, –∫—Ç–æ –¥–µ—Ä–∂–∏—Ç —Å–æ–∫–µ—Ç/–ø–æ—Ä—Ç
- –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö, –Ω–æ –∑–∞–Ω—è—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤

### ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- `lsof` –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`sudo apt install lsof`)
- –ù—É–∂–Ω–æ `sudo`, –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### ‚úÖ –í—ã–≤–æ–¥

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
| ---------- | ------------------------------------------- |
| `lsof`     | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ |
| `/proc`    | –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å–ø–æ—Å–æ–± –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ —è–¥—Ä–æ   |
| `fuser`    | –ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª              |

</p></details>

---

### ‚ùì 13. –ö–∞–∫ –∏–∑–º–µ—Ä—è—é—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –≤ —á–µ–º –æ–Ω–∞ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –∫–∞–∫ –µ–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (38:34)](https://youtu.be/pLU3zrUq87Y?t=2314)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É ‚Äî —ç—Ç–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ä–∞–±–æ—Ç—ã —Å –¥–∏—Å–∫–æ–º: —á–∞—Å—Ç–æ—Ç–∞ –∏ –æ–±—ä—ë–º –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏, –∑–∞–¥–µ—Ä–∂–∫–∏, –æ—á–µ—Ä–µ–¥—å –∑–∞–ø—Ä–æ—Å–æ–≤. –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∏—Ö –∞–Ω–∞–ª–∏–∑–∞.

### üìê –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞                | –ï–¥–∏–Ω–∏—Ü—ã           | –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç                      |
| ---------------------- | ----------------- | ----------------------------------- |
| `IOPS`                 | –æ–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏   |
| –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å | MB/s –∏–ª–∏ KB/s     | –û–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –∑–∞ —Å–µ–∫—É–Ω–¥—É |
| –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è         | –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã (ms) | –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞–µ—Ç I/O        |
| –ó–∞–≥—Ä—É–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞    | %util             | –ù–∞—Å–∫–æ–ª—å–∫–æ –¥–∏—Å–∫ –∑–∞–≥—Ä—É–∂–µ–Ω –≤–æ –≤—Ä–µ–º–µ–Ω–∏  |
| –û—á–µ—Ä–µ–¥—å –æ–ø–µ—Ä–∞—Ü–∏–π       | –∑–∞–ø—Ä–æ—Å–æ–≤          | –°–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏     |

### üõ† –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É

### ‚úÖ 1. `iostat` ‚Äî –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∏—Å–∫–∞–º

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo apt install sysstat
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```bash
iostat -dx 1
```

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:

| –ü–æ–ª–µ             | –ó–Ω–∞—á–µ–Ω–∏–µ                    |
| ---------------- | --------------------------- |
| `r/s`, `w/s`     | —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ —Å–µ–∫         |
| `rkB/s`, `wkB/s` | –æ–±—ä—ë–º —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ —Å–µ–∫   |
| `await`          | —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (–º—Å) |
| `%util`          | –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞    |

### ‚úÖ 2. `iotop` ‚Äî ¬´top¬ª –¥–ª—è –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞

```bash
sudo iotop
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —á–∏—Ç–∞—é—Ç/–ø–∏—à—É—Ç
- –°–∫–æ—Ä–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- % –≤—Ä–µ–º–µ–Ω–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–æ—Ü–µ—Å—Å —Ç—Ä–∞—Ç–∏—Ç –Ω–∞ –¥–∏—Å–∫

### ‚úÖ 3. `dstat`, `atop`, `glances` ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

–ü—Ä–∏–º–µ—Ä:

```bash
dstat -dny
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –¥–∏—Å–∫
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∏
- –∑–∞–≥—Ä—É–∑–∫—É CPU –∏ —Ç.–¥.

### ‚úÖ 4. `/proc/diskstats` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫

–ú–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞–∫:

```bash
cat /proc/diskstats
```

–û–±—ã—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é, –Ω–æ –≤–∞–∂–µ–Ω –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç.

### ‚úÖ 5. `df -h`, `du -sh` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞

```bash
df -h        # –°–≤–æ–±–æ–¥–Ω–æ–µ/–∑–∞–Ω—è—Ç–æ–µ –º–µ—Å—Ç–æ –ø–æ —Ñ–∞–π–ª–æ–≤—ã–º —Å–∏—Å—Ç–µ–º–∞–º
du -sh *     # –†–∞–∑–º–µ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
```

> ‚ö†Ô∏è –≠—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–∫—É—â—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –∞ –ª–∏—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.

### üö® –ß—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π?

| –ú–µ—Ç—Ä–∏–∫–∞                      | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
| ---------------------------- | -------------------- |
| `%util`                      | > 80%                |
| `await`                      | > 20‚Äì50 –º—Å           |
| IOPS                         | > 1000 (–¥–ª—è HDD)     |
| –°–∏–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ `iotop` | > 90% IO –æ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞ |

## ‚úÖ –í—ã–≤–æ–¥

- –ù–∞–≥—Ä—É–∑–∫—É –æ—Ü–µ–Ω–∏–≤–∞—é—Ç –ø–æ **–Ω–µ—Å–∫–æ–ª—å–∫–∏–º –º–µ—Ç—Ä–∏–∫–∞–º**, –Ω–µ—Ç –µ–¥–∏–Ω–æ–π —Ü–∏—Ñ—Ä—ã
- –ò—Å–ø–æ–ª—å–∑—É–π `iostat`, `iotop`, `dstat` –∏ `/proc/`
- **%util**, `await` –∏ IOPS ‚Äî –∫–ª—é—á–µ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- –°–ª–µ–¥–∏ –∑–∞ –¥–∏—Å–∫–æ–º, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –ª–æ–≥–∏, —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

</p></details>

---

### ‚ùì 14. –ß—Ç–æ —Ç–∞–∫–æ–µ inode

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (39:33)](https://youtu.be/pLU3zrUq87Y?t=2373)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Unix/Linux —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö `inode` (index node) ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è **—Ö—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ**, **–Ω–µ –≤–∫–ª—é—á–∞—è –µ–≥–æ –∏–º—è –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ**.

### üß© –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç inode?

| –ü–æ–ª–µ                      | –û–ø–∏—Å–∞–Ω–∏–µ                                            |
| ------------------------- | --------------------------------------------------- |
| –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞              | –í –±–∞–π—Ç–∞—Ö                                            |
| UID –∏ GID                 | –í–ª–∞–¥–µ–ª–µ—Ü –∏ –≥—Ä—É–ø–ø–∞                                   |
| –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞             | rwxr-xr-x –∏ —Ç.–ø.                                    |
| –í—Ä–µ–º—è –∏–∑–º–µ–Ω–µ–Ω–∏–π           | `ctime` (–º–µ—Ç–∞), `mtime` (—Å–æ–¥–µ—Ä–∂.), `atime` (–¥–æ—Å—Ç—É–ø) |
| –ö–æ–ª-–≤–æ –∂—ë—Å—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫     | –°–∫–æ–ª—å–∫–æ –∏–º—ë–Ω —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ inode                     |
| –£–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞                       |

### üîó –°–≤—è–∑—å –º–µ–∂–¥—É –∏–º–µ–Ω–µ–º –∏ inode

- –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **–∫–∞—Ç–∞–ª–æ–≥–∞—Ö**, –∫–æ—Ç–æ—Ä—ã–µ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ inode.
- –û–¥–∏–Ω inode –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ (–∂—ë—Å—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏).

```bash
ls -i file.txt
123456 file.txt
```

### üîÑ –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ —Å—Å—ã–ª–∫–∞—Ö

| –û–ø–µ—Ä–∞—Ü–∏—è             | –†–µ–∑—É–ª—å—Ç–∞—Ç                            |
| -------------------- | ------------------------------------ |
| `cp file newfile`    | –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π inode                |
| `ln file hardlink`   | –ù–æ–≤—ã–π —Ñ–∞–π–ª —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Ç–æ—Ç –∂–µ inode |
| `ln -s file symlink` | –°–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π inode (—Å –ø—É—Ç—ë–º)  |

### üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å inode —Ñ–∞–π–ª–∞:

```bash
ls -i file.txt
```

### –ù–∞–π—Ç–∏ —Ñ–∞–π–ª –ø–æ inode:

```bash
find . -inum 123456
```

### –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ inodes:

```bash
df -i
```

### –ü–æ–∫–∞–∑–∞—Ç—å inodes –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤:

```bash
find . -printf "%i %p\n"
```

### ‚ö†Ô∏è –ß—Ç–æ –µ—Å–ª–∏ inodes –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å?

- –î–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ (`df -h`), —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –µ—Å–ª–∏ –∫–æ–Ω—á–∏–ª–∏—Å—å `inodes`.
- –¢–∏–ø–∏—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞: –º–∏–ª–ª–∏–æ–Ω—ã –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `/tmp`, `/var/log`, `/var/spool/...`).

–°–æ–æ–±—â–µ–Ω–∏–µ:

```
No space left on device
```

‚Üí –ù–æ `df -i` –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ **inodes –Ω–∞ 100%**.

### ‚úÖ –í—ã–≤–æ–¥

- `inode` ‚Äî —ç—Ç–æ **–æ—Å–Ω–æ–≤–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–∞—Ö** –≤ Linux
- –û–Ω **–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞**, –∞ —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ `inodes` –≤–∞–∂–µ–Ω –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º —Å –±–æ–ª—å—à–∏–º —á–∏—Å–ª–æ–º –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

</p></details>

---

### ‚ùì 15. –ï—Å–ª–∏ —è —É–≤–µ–ª–∏—á–∏–ª –¥–∏—Å–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 100 –ì–ë –¥–æ 200 –ì–ë), —Å—Ç–∞–Ω–µ—Ç –ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å—Ä–∞–∑—É –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –û–°? –ù—É–∂–Ω–æ –ª–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –≤—Ä—É—á–Ω—É—é? –ò –µ—Å–ª–∏ –¥–∞ ‚Äî –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (40:43)](https://youtu.be/pLU3zrUq87Y?t=2443)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –ï—Å–ª–∏ –≤—ã —É–≤–µ–ª–∏—á–∏–ª–∏ —Ä–∞–∑–º–µ—Ä –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å 100 –ì–ë –¥–æ 200 –ì–ë), —ç—Ç–æ **–Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç**, —á—Ç–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ä–∞–∑—É —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.

### ‚ùì –ù—É–∂–Ω–æ –ª–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å –≤—Ä—É—á–Ω—É—é?

–î–∞. –ü–æ—Å–ª–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –¥–∏—Å–∫–∞, **–≤—ã –¥–æ–ª–∂–Ω—ã –≤—Ä—É—á–Ω—É—é —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É**, —á—Ç–æ–±—ã –û–° —É–≤–∏–¥–µ–ª–∞ –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.

###üìå –≠—Ç–∞–ø—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

1. ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π/—Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫ (–≤ –æ–±–ª–∞–∫–µ, –Ω–∞ —Ö–æ—Å—Ç–µ –∏–ª–∏ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–µ)
2. ‚úÖ –†–∞—Å—à–∏—Ä–∏—Ç—å —Ä–∞–∑–¥–µ–ª –∏–ª–∏ LVM (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
3. ‚úÖ –†–∞—Å—à–∏—Ä–∏—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É (`ext4`, `xfs` –∏ —Ç.–¥.)

### üì¶ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä

```bash
lsblk
df -h
```

### üìê –ü—Ä–∏–º–µ—Ä 1: –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ `ext4` –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ (–±–µ–∑ LVM)

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∏—Å–∫ —É–≤–µ–ª–∏—á–µ–Ω:

```bash
lsblk
```

### 2. –†–∞—Å—à–∏—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª:

```bash
sudo growpart /dev/sda 1     # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º /dev/sda1
```

### 3. –†–∞—Å—à–∏—Ä—å—Ç–µ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É:

```bash
sudo resize2fs /dev/sda1
```

## üìê –ü—Ä–∏–º–µ—Ä 2: –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ `xfs`

```bash
sudo xfs_growfs /
```

> `xfs_growfs` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ **–ø–æ—Å–ª–µ** —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–∞!

## üìê –ü—Ä–∏–º–µ—Ä 3: LVM

### –†–∞—Å—à–∏—Ä—å—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ç–æ–º:

```bash
sudo pvresize /dev/sda2
```

### –£–≤–µ–ª–∏—á—å—Ç–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–æ–º:

```bash
sudo lvextend -r -l +100%FREE /dev/mapper/ubuntu--vg-root
```

–§–ª–∞–≥ `-r` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç `resize2fs` –∏–ª–∏ `xfs_growfs`.

### üõ† –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

```bash
sudo apt install cloud-guest-utils     # –¥–ª—è growpart
sudo apt install xfsprogs              # –¥–ª—è xfs_growfs
```

### üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
df -h      # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–∑–º–µ—Ä —É–≤–µ–ª–∏—á–∏–ª—Å—è
```

### ‚úÖ –í—ã–≤–æ–¥

| –®–∞–≥                        | –û–±—è–∑–∞—Ç–µ–ª–µ–Ω? |
| -------------------------- | ----------- |
| –£–≤–µ–ª–∏—á–∏—Ç—å –¥–∏—Å–∫             | ‚úÖ          |
| –†–∞—Å—à–∏—Ä–∏—Ç—å —Ä–∞–∑–¥–µ–ª           | ‚úÖ          |
| –†–∞—Å—à–∏—Ä–∏—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É | ‚úÖ          |

> –ë–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –û–° **–Ω–µ —É–≤–∏–¥–∏—Ç –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–∏—Å–∫ —É–≤–µ–ª–∏—á–µ–Ω.

</p></details>

---

### ‚ùì 16. –ö–∞–∫–æ–π –∫–æ–º–∞–Ω–¥–æ–π –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å ip –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (41:43)](https://youtu.be/pLU3zrUq87Y?t=2503)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±

### `ip a` ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞:

```bash
ip a
```

–∏–ª–∏:

```bash
ip addr show
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**  
–°—Ç—Ä–æ–∫–∞ —Å `inet`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
inet 192.168.1.100/24 brd 192.168.1.255 scope global eth0
```

–ó–Ω–∞—á–µ–Ω–∏–µ `192.168.1.100` ‚Äî —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π IP-–∞–¥—Ä–µ—Å.

### üì¶ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

### `hostname -I` ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç:

```bash
hostname -I
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É.

### `ifconfig` ‚Äî —É—Å—Ç–∞—Ä–µ–≤—à–∏–π, –Ω–æ –∑–Ω–∞–∫–æ–º—ã–π —Å–ø–æ—Å–æ–±:

```bash
ifconfig
```

> –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
sudo apt install net-tools
```

### üåê –£–∑–Ω–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π (–ø—É–±–ª–∏—á–Ω—ã–π) IP

### –ß–µ—Ä–µ–∑ curl:

```bash
curl ifconfig.me
```

–∏–ª–∏:

```bash
curl icanhazip.com
```

### –ß–µ—Ä–µ–∑ wget:

```bash
wget -qO- ifconfig.me
```

### üìù –í—ã–≤–æ–¥

| –ß—Ç–æ –Ω—É–∂–Ω–æ                 | –ö–æ–º–∞–Ω–¥–∞                                     |
| ------------------------- | ------------------------------------------- |
| –õ–æ–∫–∞–ª—å–Ω—ã–π IP (–ø–æ–¥—Ä–æ–±–Ω–æ)   | `ip a` –∏–ª–∏ `ip addr show`                   |
| –õ–æ–∫–∞–ª—å–Ω—ã–π IP (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ) | `hostname -I`                               |
| –ü—É–±–ª–∏—á–Ω—ã–π IP              | `curl ifconfig.me` –∏–ª–∏ `curl icanhazip.com` |

</p></details>

---

### ‚ùì 17. –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è ip address –æ—Ç mac address

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (42:04)](https://youtu.be/pLU3zrUq87Y?t=2524)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –°–≤–æ–π—Å—Ç–≤–æ            | **IP-–∞–¥—Ä–µ—Å**                                 | **MAC-–∞–¥—Ä–µ—Å**                                   |
| ------------------- | -------------------------------------------- | ----------------------------------------------- |
| üìõ –ù–∞–∑–≤–∞–Ω–∏–µ         | Internet Protocol Address                    | Media Access Control Address                    |
| üåê –£—Ä–æ–≤–µ–Ω—å —Å–µ—Ç–∏     | –°–µ—Ç–µ–≤–æ–π (3 —É—Ä–æ–≤–µ–Ω—å OSI)                      | –ö–∞–Ω–∞–ª—å–Ω—ã–π (2 —É—Ä–æ–≤–µ–Ω—å OSI)                       |
| üß≠ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ       | –õ–æ–≥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–µ—Ç–∏           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ |
| üîÑ –ò–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å     | –ú–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ / –≤—Ä—É—á–Ω—É—é)       | –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π (–≤—à–∏—Ç –≤ –∂–µ–ª–µ–∑–æ, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å)  |
| üß± –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞   | `192.168.1.10` (IPv4), `fe80::1` (IPv6)      | `00:1A:2B:3C:4D:5E`                             |
| üîó –ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç   | TCP/IP, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä—ã                       | –ö–æ–º–º—É—Ç–∞—Ç–æ—Ä—ã, ARP                                |
| üéØ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –º–µ–∂–¥—É —Å–µ—Ç—è–º–∏ | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç–µ–ª—è –≤–Ω—É—Ç—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏    |

### üß† –ê–Ω–∞–ª–æ–≥–∏—è

- **IP-–∞–¥—Ä–µ—Å** ‚Äî –∫–∞–∫ **–∞–¥—Ä–µ—Å –¥–æ–º–∞**: –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–µ–∑–¥–µ –∏–ª–∏ —Å–º–µ–Ω–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- **MAC-–∞–¥—Ä–µ—Å** ‚Äî –∫–∞–∫ **—Å–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä** —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ä—Ç—ã: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏ –∑–∞–¥–∞–Ω –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–º.

### üß∞ –ì–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å

### IP-–∞–¥—Ä–µ—Å:

```bash
ip a
hostname -I
```

### MAC-–∞–¥—Ä–µ—Å:

```bash
ip link
```

–∏–ª–∏:

```bash
cat /sys/class/net/eth0/address
```

### ‚úÖ –í—ã–≤–æ–¥

| IP-–∞–¥—Ä–µ—Å                            | MAC-–∞–¥—Ä–µ—Å                            |
| ----------------------------------- | ------------------------------------ |
| –í—Ä–µ–º–µ–Ω–Ω—ã–π (–º–µ–Ω—è–µ—Ç—Å—è)                | –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π (—É–Ω–∏–∫–∞–ª–µ–Ω –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞) |
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–µ—Ç—è–º–∏ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏   |
| –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 3 —É—Ä–æ–≤–Ω–µ OSI            | –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 2 —É—Ä–æ–≤–Ω–µ OSI             |

–û–±–∞ –∞–¥—Ä–µ—Å–∞ –≤–∞–∂–Ω—ã, –Ω–æ –Ω–∞ **—Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö —Å–µ—Ç–∏** –∏ –¥–ª—è **—Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á**.

</p></details>

---

### ‚ùì 18. –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç—ã —É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (43:08)](https://youtu.be/pLU3zrUq87Y?t=2588)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ 1. `lsof -i -a -p <PID>`

```bash
sudo lsof -i -a -p <PID>
```

–ü—Ä–∏–º–µ—Ä:

```bash
sudo lsof -i -a -p 1234
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**

- –ü—Ä–æ—Ç–æ–∫–æ–ª (TCP, UDP)
- –õ–æ–∫–∞–ª—å–Ω—ã–π –∏ —É–¥–∞–ª—ë–Ω–Ω—ã–π –∞–¥—Ä–µ—Å–∞
- –ü–æ—Ä—Ç—ã
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (`LISTEN`, `ESTABLISHED`, –∏ —Ç.–¥.)

### ‚úÖ 2. `ss` —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ PID

```bash
sudo ss -p | grep pid=1234
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å TCP:

```bash
sudo ss -tnp | grep 1234
```

**–§–ª–∞–≥–∏:**

- `-t`: —Ç–æ–ª—å–∫–æ TCP
- `-n`: –Ω–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å DNS-–∏–º–µ–Ω–∞
- `-p`: –ø–æ–∫–∞–∑–∞—Ç—å PID –∏ –∏–º—è –ø—Ä–æ—Ü–µ—Å—Å–∞

### ‚úÖ 3. `netstat` (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π, –Ω–æ —É–¥–æ–±–Ω—ã–π)

```bash
sudo netstat -tunp | grep 1234
```

> –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

```bash
sudo apt install net-tools
```

### ‚úÖ 4. `/proc/<PID>/fd/` ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å–ø–æ—Å–æ–±

```bash
ls -l /proc/1234/fd | grep socket
```

–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –∫ –∫–∞–∫–∏–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Å–æ–∫–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π:

```bash
sudo ss -xp | grep <socket_inode>
```

### üß™ –ö–∞–∫ –Ω–∞–π—Ç–∏ PID –ø–æ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
pidof nginx
pgrep ssh
```

### üìù –í—ã–≤–æ–¥

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞                           |
| ---------- | -------------------------------------- |
| `lsof`     | –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –ø–æ —Ñ–∞–π–ª–∞–º/—Å–æ–∫–µ—Ç–∞–º      |
| `ss`       | –ì–∏–±–∫–∏–π, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ PID |
| `netstat`  | –ö–ª–∞—Å—Å–∏–∫–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏         |
| `/proc`    | –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∏ —Ç–æ—á–Ω—ã–π                |

</p></details>

---

### ‚ùì 19. –ö–∞–∫–∏–µ –ª–∏–º–∏—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ linux, –∫–∞–∫ –∏–∑ —Å–º–æ—Ç—Ä—è—Ç –∏ —Ä–∞—Å—à–∏—Ä—è—é—Ç?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (43:37)](https://youtu.be/pLU3zrUq87Y?t=2617)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

Linux –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–ª–∏–º–∏—Ç—ã) –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É —Å–∏—Å—Ç–µ–º—ã.

### üìå –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –ª–∏–º–∏—Ç–æ–≤

| –õ–∏–º–∏—Ç       | –û–ø–∏—Å–∞–Ω–∏–µ                                  |
| ----------- | ----------------------------------------- |
| `nofile`    | –ö–æ–ª-–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤     |
| `nproc`     | –ú–∞–∫—Å. –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è          |
| `stack`     | –†–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞ –Ω–∞ –ø–æ—Ç–æ–∫                     |
| `core`      | –†–∞–∑–º–µ—Ä core-—Ñ–∞–π–ª–∞ –ø—Ä–∏ –∫—Ä–∞—à–µ               |
| `rss`, `as` | –û–±—ä—ë–º –¥–æ—Å—Ç—É–ø–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏        |
| `memlock`   | –ú–∞–∫—Å. –æ–±—ä—ë–º –ø–∞–º—è—Ç–∏, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤ RAM |
| `cpu`       | –í—Ä–µ–º—è CPU, –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Ü–µ—Å—Å—É             |
| `maxlogins` | –ú–∞–∫—Å. —á–∏—Å–ª–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ª–æ–≥–∏–Ω–æ–≤         |

### üîç –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–∏–º–∏—Ç—ã

### 1. –¢–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã shell:

```bash
ulimit -a
```

–û—Ç–¥–µ–ª—å–Ω–æ:

```bash
ulimit -n    # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
ulimit -u    # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
```

### 2. –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞:

```bash
prlimit --pid <PID>
```

–¢–µ–∫—É—â–∏–π shell:

```bash
prlimit --pid $$
```

### 3. –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É `/proc`

```bash
cat /proc/<PID>/limits
```

### üõ† –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ª–∏–º–∏—Ç—ã

### 1. –í—Ä–µ–º–µ–Ω–Ω–æ (–Ω–∞ –≤—Ä–µ–º—è —Å–µ—Å—Å–∏–∏):

```bash
ulimit -n 65535
```

> –ü–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ shell –≤—Å—ë —Å–±—Ä–æ—Å–∏—Ç—Å—è.

### 2. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ (—á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PAM)

#### –§–∞–π–ª `/etc/security/limits.conf`:

```bash
<user> soft nofile 65535
<user> hard nofile 65535
```

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ: —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ `/etc/security/limits.d/`:

```bash
echo "<user> hard nofile 65535" | sudo tee /etc/security/limits.d/99-custom.conf
```

#### –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PAM –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –ª–∏–º–∏—Ç—ã:

```bash
grep pam_limits.so /etc/pam.d/common-session
```

–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ:

```
session required pam_limits.so
```

### 3. –î–ª—è systemd-—Å–µ—Ä–≤–∏—Å–æ–≤:

–û—Ç–∫—Ä–æ–π—Ç–µ unit-—Ñ–∞–π–ª —Å–µ—Ä–≤–∏—Å–∞ (`/etc/systemd/system/<service>.service`) –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```ini
[Service]
LimitNOFILE=65535
```

–ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl restart <service>
```

### ‚öôÔ∏è –õ–∏–º–∏—Ç—ã —á–µ—Ä–µ–∑ `sysctl`

`sysctl` —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏ —è–¥—Ä–∞.

### –ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

| –ü–∞—Ä–∞–º–µ—Ç—Ä `sysctl`    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                   |
| -------------------- | -------------------------------------------- |
| `fs.file-max`        | –ú–∞–∫—Å–∏–º—É–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ           |
| `fs.nr_open`         | –ú–∞–∫—Å–∏–º—É–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å          |
| `kernel.threads-max` | –ú–∞–∫—Å–∏–º—É–º –ø–æ—Ç–æ–∫–æ–≤                             |
| `kernel.pid_max`     | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π PID                             |
| `vm.max_map_count`   | –ú–∞–∫—Å–∏–º—É–º –æ–±–ª–∞—Å—Ç–µ–π –ø–∞–º—è—Ç–∏ (mmap)              |
| `net.core.somaxconn` | –û—á–µ—Ä–µ–¥—å –≤—Ö–æ–¥—è—â–∏—Ö TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (`listen()`) |

### –í—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

```bash
sudo sysctl -w fs.file-max=1048576
```

### –ü–æ—Å—Ç–æ—è–Ω–Ω–æ (—á–µ—Ä–µ–∑ —Ñ–∞–π–ª):

```bash
echo "fs.file-max = 1048576" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
```

### –ò–ª–∏ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥:

```bash
echo "vm.max_map_count = 262144" | sudo tee /etc/sysctl.d/99-custom.conf
sudo sysctl --system
```

### üîÑ –û—Ç–ª–∏—á–∏–µ `ulimit` –∏ `sysctl`

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞       | `ulimit`                 | `sysctl`               |
| -------------------- | ------------------------ | ---------------------- |
| –£—Ä–æ–≤–µ–Ω—å              | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–ø—Ä–æ—Ü–µ—Å—Å     | –Ø–¥—Ä–æ / —Å–∏—Å—Ç–µ–º–∞ –≤ —Ü–µ–ª–æ–º |
| –í–ª–∏—è–Ω–∏–µ              | –¢–æ–ª—å–∫–æ –Ω–∞ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é | –ì–ª–æ–±–∞–ª—å–Ω–æ              |
| –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ | –ß–µ—Ä–µ–∑ `limits.conf`      | –ß–µ—Ä–µ–∑ `sysctl.conf`    |

### ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –ß—Ç–æ –Ω—É–∂–Ω–æ            | –ú–µ—Ç–æ–¥                        |
| -------------------- | ---------------------------- |
| –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏–º–∏—Ç–æ–≤     | `ulimit`, `prlimit`, `/proc` |
| –í—Ä–µ–º–µ–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ  | `ulimit`, `sysctl -w`        |
| –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ | `limits.conf`, `sysctl.conf` |
| –î–ª—è systemd          | `LimitNOFILE`, `LimitNPROC`  |

–ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏–º–∏—Ç–æ–≤ ‚Äî –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö Linux-—Å–∏—Å—Ç–µ–º.

</p></details>

---

# 3. Ansible

### ‚ùì 1. –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ä–æ–ª—å –æ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (45:06)](https://youtu.be/pLU3zrUq87Y?t=2706)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### Ansible –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–æ–ª–∏ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞. –ù–∏–∂–µ ‚Äî –ø–æ–ª–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.

### üß© –ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–æ–ª—å?

**–†–æ–ª—å** ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–¥–∞—á, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —à–∞–±–ª–æ–Ω–æ–≤, —Ñ–∞–π–ª–æ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞—Ç–∞–ª–æ–≥–∞–º.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:

- –ü–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ú–æ–¥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ playbook'–æ–≤

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```
roles/
‚îî‚îÄ‚îÄ nginx/
    ‚îú‚îÄ‚îÄ tasks/
    ‚îú‚îÄ‚îÄ templates/
    ‚îú‚îÄ‚îÄ defaults/
    ‚îú‚îÄ‚îÄ handlers/
    ‚îî‚îÄ‚îÄ meta/
```

### üì¶ –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–ª–ª–µ–∫—Ü–∏—è?

**–ö–æ–ª–ª–µ–∫—Ü–∏—è** ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å:

- –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ **—Ä–æ–ª–µ–π**
- —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ **–º–æ–¥—É–ª–∏**
- **—Ñ–∏–ª—å—Ç—Ä—ã**
- **lookup-–ø–ª–∞–≥–∏–Ω—ã**
- **–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**
- **playbooks**

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```
collections/
‚îî‚îÄ‚îÄ ansible_collections/
    ‚îî‚îÄ‚îÄ my_namespace/
        ‚îî‚îÄ‚îÄ my_collection/
            ‚îú‚îÄ‚îÄ roles/
            ‚îú‚îÄ‚îÄ plugins/
            ‚îú‚îÄ‚îÄ playbooks/
            ‚îî‚îÄ‚îÄ docs/
```

### üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –°–≤–æ–π—Å—Ç–≤–æ             | **–†–æ–ª—å (Role)**                            | **–ö–æ–ª–ª–µ–∫—Ü–∏—è (Collection)**                            |
| -------------------- | ------------------------------------------ | ----------------------------------------------------- |
| üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞         | –ù–∞–±–æ—Ä –∑–∞–¥–∞—á –∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏        | –£–ø–∞–∫–æ–≤–∫–∞ —Ä–æ–ª–µ–π, –º–æ–¥—É–ª–µ–π, —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ playbook'–æ–≤       |
| üìö –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ        | –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏             | –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤    |
| üì¶ –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ   | Git, Ansible Galaxy                        | Ansible Galaxy, `requirements.yml`                    |
| üîÑ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏       | –í `meta/main.yml`                          | –í `requirements.yml`                                  |
| ‚öôÔ∏è –ü—Ä–∏–º–µ—Ä—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ | `ansible-galaxy install geerlingguy.nginx` | `ansible-galaxy collection install community.general` |

### ‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- **–†–æ–ª—å** ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.
- **–ö–æ–ª–ª–µ–∫—Ü–∏—è** ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–Ω–∞–±–æ—Ä —Ä–æ–ª–µ–π/–º–æ–¥—É–ª–µ–π**.

### üì• –ü—Ä–∏–º–µ—Ä—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–æ–ª–∏:

```bash
ansible-galaxy install geerlingguy.nginx
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏:

```bash
ansible-galaxy collection install community.general
```

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –†–æ–ª—å                  | –ö–æ–ª–ª–µ–∫—Ü–∏—è                              |
| --------------------- | -------------------------------------- |
| –ï–¥–∏–Ω–∏—Ü–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  | –ù–∞–±–æ—Ä —Ä–æ–ª–µ–π, –º–æ–¥—É–ª–µ–π, –ø–ª–∞–≥–∏–Ω–æ–≤         |
| –£–ø—Ä–æ—â–∞–µ—Ç playbook     | –£–ø—Ä–æ—â–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ    |
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ –¥–æ—Å—Ç–∞–≤–∫–∏ |

–û–±–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –≤–∞–∂–Ω—ã –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–¥–∞.

</p></details>

---

### ‚ùì 2. –ö–∞–∫–æ–π –∫–æ–º–∞–Ω–¥–æ–π –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∫–∞—è –Ω–∏–±—É–¥—å —Ä–æ–ª—å, –ø–ª–µ–π–±—É–∫, –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–π —Ä–æ–ª–∏ –∏–ª–∏ –ø–ª–µ–π–±—É–∫–∞?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (45:28)](https://youtu.be/pLU3zrUq87Y?t=2728)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞

```bash
ansible-playbook playbook.yml --check
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- –ù–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ —Ä–µ–≤—å—é

### üß© –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ–ª–∞–≥–∏

| –§–ª–∞–≥             | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                  |
| ---------------- | ------------------------------------------- |
| `--check`        | –†–µ–∂–∏–º dry-run: –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ _–±—É–¥–µ—Ç_ —Å–¥–µ–ª–∞–Ω–æ |
| `--diff`         | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —à–∞–±–ª–æ–Ω–∞—Ö)  |
| `--list-tasks`   | –ü—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è          |
| `--list-tags`    | –°–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ playbook       |
| `--syntax-check` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ YAML-—Ñ–∞–π–ª–∞              |

### üìå –ü—Ä–∏–º–µ—Ä—ã

### ‚ñ∂Ô∏è –†–µ–∂–∏–º dry-run:

```bash
ansible-playbook site.yml --check
```

### üîé –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á:

```bash
ansible-playbook deploy.yml --list-tasks
```

### üìÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:

```bash
ansible-playbook playbook.yml --syntax-check
```

### üìù Dry-run + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
ansible-playbook nginx.yml --check --diff
```

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- **–ù–µ –≤—Å–µ –º–æ–¥—É–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç** `--check` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, shell/command).
- –ò–Ω–æ–≥–¥–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –±—É–¥—É—Ç –Ω–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
- `--check` –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç 100% —Ç–æ—á–Ω–æ—Å—Ç–∏, –Ω–æ –¥–∞—ë—Ç —Ö–æ—Ä–æ—à–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.

### ‚úÖ –í—ã–≤–æ–¥

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--check`, `--list-tasks`, `--diff` –∏ `--syntax-check`:

- –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è Ansible
- –ü—Ä–∏ CI/CD –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö
- –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ä–æ–ª–µ–π –≤ –ø—Ä–æ–¥–µ

</p></details>

### ‚ùì 3. –í ansible –µ—Å—Ç—å —Ä–∞–∑–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã: –∫–∞–∫–∏–µ —Ç—ã –∑–Ω–∞–µ—à—å –∏ –¥–ª—è —á–µ–≥–æ –Ω–∏ –Ω—É–∂–Ω—ã?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (46:34)](https://youtu.be/pLU3zrUq87Y?t=2794)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã Ansible

| –£—Ç–∏–ª–∏—Ç–∞             | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                        |
| ------------------- | ------------------------------------------------- |
| `ansible`           | –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞–¥-—Ö–æ–∫ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Ö–æ—Å—Ç–∞—Ö –∏–∑ inventory   |
| `ansible-playbook`  | –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–∏ (playbooks)                    |
| `ansible-inventory` | –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ inventory-—Ñ–∞–π–ª–æ–º            |
| `ansible-config`    | –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Ansible         |
| `ansible-doc`       | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–æ–¥—É–ª—è–º –∏ –ø–ª–∞–≥–∏–Ω–∞–º                |
| `ansible-galaxy`    | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ –∏–∑ Ansible Galaxy |
| `ansible-vault`     | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  |
| `ansible-console`   | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã —Å —Ö–æ—Å—Ç–∞–º–∏              |

**\*–ê–¥-—Ö–æ–∫ –∫–æ–º–∞–Ω–¥—ã (–æ—Ç –∞–Ω–≥–ª. ad hoc ‚Äî "—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ —Å–ª—É—á–∞—è") ‚Äî —ç—Ç–æ —Ä–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ —á–µ—Ä–µ–∑ playbook, –∞ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –Ω–∞ —Ö–æ—Å—Ç–∞—Ö.**

### üìå –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

#### üî∏ `ansible`

```bash
ansible all -m ping          # –í—ã–ø–æ–ª–Ω–∏—Ç—å ping –Ω–∞ –≤—Å–µ —Ö–æ—Å—Ç—ã:
ansible web -a "uptime"      # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–ø—Ç–∞–π–º –Ω–∞ –≥—Ä—É–ø–ø–µ web:
```

#### üî∏ `ansible-playbook`

```bash
ansible-playbook site.yml                       # –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
ansible-playbook deploy.yml --check --diff      # –°–∏–º—É–ª—è—Ü–∏—è: –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ, –Ω–æ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

#### üî∏ `ansible-inventory`

```bash
ansible-inventory --list       # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Å—å inventory (—Å–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤, –≥—Ä—É–ø–ø, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
ansible-inventory --graph      # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≥—Ä—É–ø–ø —Ö–æ—Å—Ç–æ–≤ –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞
```

#### üî∏ `ansible-config`

```bash
ansible-config list                    # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Ansible
ansible-config dump --only-changed     # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
```

#### üî∏ `ansible-doc`

```bash
ansible-doc -l            # —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π
ansible-doc copy          # –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–æ–¥—É–ª—é copy
```

#### üî∏ `ansible-galaxy`

```bash
ansible-galaxy install geerlingguy.nginx               # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–æ–ª—å geerlingguy.nginx –∏–∑ Ansible Galaxy (~/.ansible/roles/ –∏–ª–∏ roles/)
ansible-galaxy collection install community.general    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–ª–ª–µ–∫—Ü–∏—é community.general ‚Äî –±–æ–ª—å—à—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –º–æ–¥—É–ª–µ–π –∏ –ø–ª–∞–≥–∏–Ω–æ–≤ –æ—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
```

#### üî∏ `ansible-vault`

```bash
ansible-vault encrypt secrets.yml    # –®–∏—Ñ—Ä—É–µ—Ç —Ñ–∞–π–ª secrets.yml
ansible-vault decrypt secrets.yml    # –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –æ–±—Ä–∞—Ç–Ω–æ –≤ –æ—Ç–∫—Ä—ã—Ç—ã–π –≤–∏–¥
ansible-vault edit secrets.yml       # –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, nano)
```

#### üî∏ `ansible-console`

```bash
ansible-console          # –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç—ã –ø–æ–ø–∞–¥—ë—à—å –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –æ–±–æ–ª–æ—á–∫—É (>), –≥–¥–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö —Ö–æ—Å—Ç–∞—Ö.
> all -a "uptime"        # Ansible –≤—ã–ø–æ–ª–Ω–∏—Ç –∫–æ–º–∞–Ω–¥—É uptime –Ω–∞ –≤—Å–µ—Ö —Ö–æ—Å—Ç–∞—Ö –∏–∑ inventory –∏ –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∫–∞–∂–¥–æ–º—É.
```

### üß© –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —É—Ç–∏–ª–∏—Ç—ã

| –£—Ç–∏–ª–∏—Ç–∞              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                       |
| -------------------- | ---------------------------------------------------------------- |
| `ansible-pull`       | –û–±—Ä–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º: —Ö–æ—Å—Ç —Å–∞–º –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç playbook –∏–∑ Git             |
| `ansible-test`       | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π, –ø–ª–∞–≥–∏–Ω–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Ansible      |
| `ansible-runner`     | –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–ø—É—Å–∫–∞ playbook (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ CI/CD)    |
| `ansible-navigator`  | –¢–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π UI –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Execution Environment (AA Platform) |
| `ansible-connection` | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —É—Ç–∏–ª–∏—Ç–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º–∏–º Ansible)      |
| `ansible-compat`     | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–ª—è –ª–∏–Ω—Ç–µ—Ä–æ–≤ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–æ–¥—É–ª–µ–π                   |

### üìå –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

#### üîπ `ansible-pull`

```bash
ansible-pull -U https://github.com/org/repo.git playbook.yml  # –°–∫–∞—á–∏–≤–∞–µ—Ç (pull) playbook –∏ —Ñ–∞–π–ª—ã –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç playbook –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —ç—Ç–æ–º –∂–µ —Ö–æ—Å—Ç–µ
```

#### üîπ `ansible-test`

```bash
ansible-test sanity --docker    # –ó–∞–ø—É—Å–∫–∞–µ—Ç sanity-–ø—Ä–æ–≤–µ—Ä–∫–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞, —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω–∞–ª–∏—á–∏—è –Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ä–µ–¥—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–∏—Å—Ç–µ–º—ã
ansible-test integration        # –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –º–æ–¥—É–ª–∏ –∏ –ø–ª–∞–≥–∏–Ω—ã, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫ –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ (–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–ª–∏ docker-based —Ö–æ—Å—Ç—ã).
```

#### üîπ `ansible-runner`

```python
import ansible_runner
ansible_runner.run(private_data_dir='/tmp/demo', playbook='site.yml')
```

#### üîπ `ansible-navigator`

```bash
ansible-navigator run site.yml
ansible-navigator collections
```

#### üîπ `ansible-connection`

```bash
# –û–±—ã—á–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ, –≤—Ä—É—á–Ω—É—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—Ä–∞–π–Ω–µ —Ä–µ–¥–∫–æ
```

#### üîπ `ansible-compat`

```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ansible-lint –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ Ansible –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
```

## üß™ –í–Ω–µ—à–Ω–∏–µ, –Ω–æ –ø–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| –£—Ç–∏–ª–∏—Ç–∞        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                            |
| -------------- | ------------------------------------- |
| `ansible-lint` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ playbook'–æ–≤ –∏ —Ä–æ–ª–µ–π |

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
pip install ansible-lint
```

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```bash
ansible-lint playbook.yml # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π playbook (playbook.yml), –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ–≥–æ –Ω–∞ —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏, –Ω–∞—Ä—É—à–µ–Ω–∏—è best practices –∏ —Å—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
```

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –¢–∏–ø                 | –£—Ç–∏–ª–∏—Ç—ã                                                              |
| ------------------- | -------------------------------------------------------------------- |
| –û—Å–Ω–æ–≤–Ω—ã–µ            | `ansible`, `ansible-playbook`, `ansible-doc`, `ansible-vault`, –∏ –¥—Ä. |
| –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ      | `ansible-pull`, `ansible-test`, `ansible-navigator`, –∏ –¥—Ä.           |
| –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã | `ansible-lint`, `molecule`, `ara`, –∏ –¥—Ä.                             |

</p></details>

---

### ‚ùì 4. –ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ inventory

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (47:33)](https://youtu.be/pLU3zrUq87Y?t=2853)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### Inventory –≤ Ansible ‚Äî —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤ –∏ –≥—Ä—É–ø–ø, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ Ansible –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ inventory:

### üß± –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π Inventory

–≠—Ç–æ **—Ñ–∞–π–ª —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–ø–∏—Å–∫–æ–º —Ö–æ—Å—Ç–æ–≤**, –æ–±—ã—á–Ω–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ INI –∏–ª–∏ YAML.

### üìÑ –ü—Ä–∏–º–µ—Ä (INI):

```ini
[web]
web1.example.com
web2.example.com

[db]
db1.example.com ansible_user=postgres
```

üìÅ –¢–∞–∫–æ–π —Ñ–∞–π–ª –º–æ–∂–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è `hosts`, `inventory.ini`, `inventory.yml` –∏ —Ç.–¥.

### ‚úÖ –ü–ª—é—Å—ã:

- –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π
- –õ–µ–≥–∫–æ —Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö, —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

### ‚ùå –ú–∏–Ω—É—Å—ã:

- –¢—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ù–µ—É–¥–æ–±–µ–Ω –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ù–µ –∑–Ω–∞–µ—Ç –æ –≤–Ω–µ—à–Ω–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç–∞—Ç—É—Å–∞—Ö —Ö–æ—Å—Ç–æ–≤ –≤ –æ–±–ª–∞–∫–µ)

### ‚òÅÔ∏è –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π Inventory

–≠—Ç–æ **—Å–∫—Ä–∏–ø—Ç –∏–ª–∏ –ø–ª–∞–≥–∏–Ω**, –∫–æ—Ç–æ—Ä—ã–π **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤** –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞:

- AWS EC2
- GCP, Azure
- Kubernetes, Docker
- CMDB, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, API –∏ –¥—Ä.

### üßæ –ü—Ä–∏–º–µ—Ä dynamic inventory (YAML + AWS plugin):

```yaml
plugin: aws_ec2
regions:
  - us-east-1
filters:
  tag:Role: web
```

–ó–∞–ø—É—Å–∫:

```bash
ansible-inventory -i inventory_aws_ec2.yml --list
```

### ‚úÖ –ü–ª—é—Å—ã:

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ö–æ—Å—Ç–æ–≤
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–µ–≥–∞–º, –º–µ—Ç–∫–∞–º, —Ä–µ–≥–∏–æ–Ω–∞–º

### ‚ùå –ú–∏–Ω—É—Å—ã:

- –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, AWS credentials)
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ API

### üîç –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞            | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π Inventory | –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π Inventory |
| ------------------------- | --------------------- | ---------------------- |
| –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é       | ‚úÖ –î–∞                 | ‚ùå –ù–µ—Ç                 |
| –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | ‚ùå –ù–µ—Ç                | ‚úÖ –î–∞                  |
| –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–ª–∞–∫–∞       | ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ         | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é           |
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è    | ‚úÖ –ü—Ä–æ—Å—Ç              | ‚ö† –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏    |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å          | ‚ùå –ü–ª–æ—Ö–æ              | ‚úÖ –û—Ç–ª–∏—á–Ω–æ             |

### üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```bash
ansible-inventory -i inventory.yml --list
ansible-inventory -i inventory.yml --graph
```

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π inventory** ‚Äî —Ö–æ—Ä–æ—à –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π.
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π inventory** ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ–±–ª–∞–∫–∞–º–∏ –∏ –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—é—â–µ–π—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

</p></details>

---

### ‚ùì 5. –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞–µ—Ç—Å—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (48:42)](https://youtu.be/pLU3zrUq87Y?t=2922)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Ansible –º–æ–≥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö. –ù–∏–∂–µ ‚Äî –ø–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.

### üìÅ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Å—Ç–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

| –£—Ä–æ–≤–µ–Ω—å                     | –ì–¥–µ –∑–∞–¥–∞—é—Ç—Å—è                        | –û–ø–∏—Å–∞–Ω–∏–µ                                     |
| --------------------------- | ----------------------------------- | -------------------------------------------- |
| **Inventory –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**    | `inventory.ini`, `inventory.yml`    | –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏            |
| **Group variables**         | `group_vars/web.yml`                | –î–ª—è –≥—Ä—É–ø–ø—ã —Ö–æ—Å—Ç–æ–≤                            |
| **Host variables**          | `host_vars/web1.yml`                | –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞                        |
| **Playbook vars**           | `vars:` –≤ `playbook.yml`            | –ü—Ä—è–º–æ –≤ —Å—Ü–µ–Ω–∞—Ä–∏–∏                             |
| **vars_files**              | `vars_files:` –≤ playbook            | –ü–æ–¥–∫–ª—é—á–∞–µ–º—ã–π YAML-—Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏         |
| **Role defaults**           | `roles/role_name/defaults/main.yml` | –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞–∏–º–µ–Ω—å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) |
| **Role vars**               | `roles/role_name/vars/main.yml`     | –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Ä–æ–ª–∏                |
| **Extra vars** (`-e`)       | `ansible-playbook ... -e var=value` | –ù–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç                          |
| **Facts (`ansible_facts`)** | –ß–µ—Ä–µ–∑ –º–æ–¥—É–ª—å `setup`                | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–∫—Ç—ã –æ —Å–∏—Å—Ç–µ–º–µ      |
| **Registered –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**   | `register: result`                  | –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á                  |
| **Environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**  | –í `environment:` —Å–µ–∫—Ü–∏–∏ –∑–∞–¥–∞—á       | –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ                     |

###üìå –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

```
inventory/
  hosts.ini
  group_vars/
    web.yml
    all.yml
  host_vars/
    web1.yml
roles/
  nginx/
    defaults/main.yml
    vars/main.yml
playbook.yml
vars/
  common.yml
```

### üß† –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–æ—Ç –Ω–∏–∑—à–µ–≥–æ –∫ –≤—ã—Å—à–µ–º—É)

| –ò—Å—Ç–æ—á–Ω–∏–∫                            | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç        |
| ----------------------------------- | ---------------- |
| `defaults/main.yml`                 | üîΩ –Ω–∏–∑–∫–∏–π        |
| `group_vars`, `host_vars`           | —Å—Ä–µ–¥–Ω–∏–π          |
| `vars:` –≤ playbook –∏–ª–∏ `vars_files` | –≤—ã—à–µ             |
| `vars/main.yml` –≤ —Ä–æ–ª–∏              | üîº –≤—ã—Å–æ–∫–∏–π       |
| `-e var=value`                      | üîù —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π |

### üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –í playbook:

```yaml
vars:
  nginx_port: 8080
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞:

```yaml
vars_files:
  - vars/common.yml
```

### –ü–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ CLI:

```bash
ansible-playbook playbook.yml -e nginx_port=9090
```

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- Ansible –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫—É—é –∏ –º–æ—â–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
- –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, **–≥–¥–µ –≤—ã –∑–∞–¥–∞—ë—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –∏ **–∫–∞–∫–æ–π —É –Ω–∏—Ö –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**.
- –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `group_vars` –∏ `vars_files` –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

</p></details>

---

### ‚ùì 6. –ö–∞–∫–∏–º –º–æ–¥—É–ª–µ–º –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å —Å—Ç—Ä–æ—á–∫—É –≤ —Ñ–∞–π–ª–µ?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (50:38)](https://youtu.be/pLU3zrUq87Y?t=3038)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üì¶ –ú–æ–¥—É–ª—å: `ansible.builtin.lineinfile`

–ú–æ–¥—É–ª—å `lineinfile` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫** –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–∞–π–ª–µ.

## ‚úÖ –ü—Ä–∏–º–µ—Ä: –∑–∞–º–µ–Ω–∏—Ç—å –∏–ª–∏ –≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É

```yaml
- name: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `PermitRootLogin` –æ—Ç–∫–ª—é—á–µ–Ω
  ansible.builtin.lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '^PermitRootLogin'
    line: 'PermitRootLogin no'
    state: present
    backup: yes
```

üîç –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:

- –ò—â–µ—Ç —Å—Ç—Ä–æ–∫—É, –Ω–∞—á–∏–Ω–∞—é—â—É—é—Å—è —Å `PermitRootLogin`
- –ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç ‚Äî **–∑–∞–º–µ–Ω—è–µ—Ç –Ω–∞ `PermitRootLogin no`**
- –ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç ‚Äî **–¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É**
- `backup: yes` ‚Äî —Å–æ–∑–¥–∞—ë—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é

### üßπ –ü—Ä–∏–º–µ—Ä: —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É

```yaml
- name: –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ debug
  ansible.builtin.lineinfile:
    path: /etc/app.conf
    regexp: '^debug='
    state: absent
```

### üîë –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä                       | –û–ø–∏—Å–∞–Ω–∏–µ                                                       |
| ------------------------------ | -------------------------------------------------------------- |
| `path`                         | –ü—É—Ç—å –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–º—É —Ñ–∞–π–ª—É                                    |
| `line`                         | –°—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å                                 |
| `regexp`                       | –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç—Ä–æ–∫–∏                         |
| `state`                        | `present` (–≤—Å—Ç–∞–≤–∏—Ç—å/–∑–∞–º–µ–Ω–∏—Ç—å) –∏–ª–∏ `absent` (—É–¥–∞–ª–∏—Ç—å)           |
| `backup`                       | `yes`/`no` ‚Äî —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª–∏ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ñ–∞–π–ª–∞                |
| `insertafter` / `insertbefore` | –í—Å—Ç–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –¥–æ/–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —à–∞–±–ª–æ–Ω—É (–µ—Å–ª–∏ –Ω–µ—Ç `regexp`) |

### üìò –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ **plain text** (–Ω–µ JSON/YAML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
- –û—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–µ —Å `notify` –∏ `handlers` –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–ª—É–∂–±

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

`lineinfile` ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–æ—á–µ—á–Ω–æ–π –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–∞—Ö. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–æ–≤, —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –ª—é–±—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤.

</p></details>

---

### ‚ùì 7. –í —á—ë–º –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥—É–ª—è lineinfile –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —à–∞–±–ª–æ–Ω–∞–º–∏ (template) –≤ Ansible?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (50:50)](https://youtu.be/pLU3zrUq87Y?t=3050)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚öôÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

### ‚úÖ `lineinfile`

- –ú–æ–¥—É–ª—å –¥–ª—è **–≤—Å—Ç–∞–≤–∫–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫** –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö.

### ‚úÖ `template`

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —à–∞–±–ª–æ–Ω—ã Jinja2 –¥–ª—è **–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ü–µ–ª–æ–≥–æ —Ñ–∞–π–ª–∞** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π                       | `lineinfile`                                | `template`                                  |
| ------------------------------ | ------------------------------------------- | ------------------------------------------- |
| üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                  | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç—Ä–æ–∫                  | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —Ñ–∞–π–ª–∞        |
| ‚ö† –†–∏—Å–∫ –ø–æ–≤—Ä–µ–¥–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥        | –ù–∏–∑–∫–∏–π: –º–µ–Ω—è–µ—Ç—Å—è –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞                | –í—ã—Å–æ–∫–∏–π: –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤–µ—Å—å —Ñ–∞–π–ª         |
| üí° –£–¥–æ–±—Å—Ç–≤–æ –ø—Ä–∏ –º–µ–ª–∫–∏—Ö –ø—Ä–∞–≤–∫–∞—Ö | –û—á–µ–Ω—å —É–¥–æ–±–Ω–æ (1‚Äì2 —Å—Ç—Ä–æ–∫–∏)                   | –ù–µ–æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–æ —Å–ª–æ–∂–Ω–æ –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏        |
| üß† –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å                  | –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–π –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –ø—Ä–∞–≤–∏–ª | –®–∞–±–ª–æ–Ω –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ—Ç—Å—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è     |
| üîÅ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å             | –î–∞, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã `regexp`       | –î–∞, —Å –ø–æ–º–æ—â—å—é —à–∞–±–ª–æ–Ω–∞                       |
| üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π      | –°–ª–æ–∂–Ω–µ–µ, –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç—Ä–æ–∫—É –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ | –õ–µ–≥—á–µ ‚Äî —à–∞–±–ª–æ–Ω –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ |
| ‚òÅÔ∏è –†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏        | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞                                  | –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Jinja2                    |
| üß© –°–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö    | –ù–µ—É–¥–æ–±–Ω–æ                                    | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ                   |

### üìù –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### üëç `lineinfile`, –µ—Å–ª–∏:

- –ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º –∫–æ–Ω—Ñ–∏–≥–µ
- –ù–µ–ª—å–∑—è/–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤–µ—Å—å —Ñ–∞–π–ª
- –†–∞–±–æ—Ç–∞–µ—à—å —Å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏

### üëç `template`, –µ—Å–ª–∏:

- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –≤–µ—Å—å —Ñ–∞–π–ª —Ü–µ–ª–∏–∫–æ–º
- –§–∞–π–ª –±–æ–ª—å—à–æ–π –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π
- –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Å–ª–æ–≤–∏—è (`if`, `for`) –≤–Ω—É—Ç—Ä–∏ —à–∞–±–ª–æ–Ω–∞

### üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### `lineinfile`:

```yaml
- name: –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç SSH
  ansible.builtin.lineinfile:
    path: /etc/ssh/sshd_config
    regexp: '^Port'
    line: 'Port 2222'
```

### `template`:

`templates/sshd_config.j2`

```jinja2
Port {{ ssh_port }}
PermitRootLogin {{ permit_root }}
```

```yaml
- name: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sshd_config —á–µ—Ä–µ–∑ —à–∞–±–ª–æ–Ω
  ansible.builtin.template:
    src: sshd_config.j2
    dest: /etc/ssh/sshd_config
```

## ‚úÖ –í—ã–≤–æ–¥

- `lineinfile` —Ö–æ—Ä–æ—à –¥–ª—è —Ç–æ—á–µ—á–Ω—ã—Ö –ø—Ä–∞–≤–æ–∫, –∫–æ–≥–¥–∞ –Ω–µ–ª—å–∑—è —Ç—Ä–æ–≥–∞—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Ñ–∞–π–ª.
- `template` –Ω–µ–∑–∞–º–µ–Ω–∏–º –¥–ª—è –ø–æ–ª–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ª–æ–≥–∏–∫–æ–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.

</p></details>

---

### ‚ùì 8. –ö–∞–∫–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Å–ø–æ—Å–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ Ansible playbook'–æ–≤? –ï—Å—Ç—å –ª–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Ansible?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (51:42)](https://youtu.be/pLU3zrUq87Y?t=3102)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –°–ø–æ—Å–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ Ansible

### 1. üïí Cron / systemd timer

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å Ansible –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `cron`:

```cron
0 3 * * * ansible-playbook /srv/playbooks/backup.yml >> /var/log/ansible.log
```

–ò–ª–∏ —Å –ø–æ–º–æ—â—å—é `systemd`:

- –ò—Å–ø–æ–ª—å–∑—É–π `systemd timer` –∏ `service`, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å Ansible –≤ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è.

### 2. üõ∞ Ansible AWX / Ansible Automation Platform

–≠—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è **–≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Ansible**.

–§—É–Ω–∫—Ü–∏–∏:

- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ playbook'–æ–≤
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞–Ω–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è–º–∏, —Ç–æ–∫–µ–Ω–∞–º–∏, —Ä–æ–ª—è–º–∏
- –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—É—Å–∫–æ–≤, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, API

üîπ AWX ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π open source  
üîπ Ansible Automation Platform ‚Äî –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è –æ—Ç Red Hat

### 3. üåê CI/CD (GitLab CI, GitHub Actions, Jenkins –∏ –¥—Ä.)

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Ansible –≤ DevOps –ø–∞–π–ø–ª–∞–π–Ω:

```yaml
# –ü—Ä–∏–º–µ—Ä: .gitlab-ci.yml
deploy:
  script:
    # –ó–∞–ø—É—Å–∫–∞–µ–º Ansible playbook —Å —É–∫–∞–∑–∞–Ω–∏–µ–º inventory —Ñ–∞–π–ª–∞
    - ansible-playbook deploy.yml -i inventory.yml
```

üìå –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞–∫ –∫–æ–¥–∞ (IaC).

### 4. üîÅ Ansible-pull

–•–æ—Å—Ç —Å–∞–º —Ç—è–Ω–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ Git –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –µ—ë:

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å playbook –∏–∑ git –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –Ω–∞ —Ç–µ–∫—É—â–µ–º —Ö–æ—Å—Ç–µ
ansible-pull -U https://github.com/org/repo.git site.yml
```

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ `cron`, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Å–∞–º —Å–µ–±—è –æ–±–Ω–æ–≤–ª—è–ª.

### 5. üîß shell-—Å–∫—Ä–∏–ø—Ç—ã –∏ –æ–±—ë—Ä—Ç–∫–∏

–ü—Ä–∏–º–∏—Ç–∏–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:

```bash
#!/bin/bash
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å playbook'–∞–º–∏
cd /srv/ansible
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
git pull
# –ó–∞–ø—É—Å–∫ playbook
ansible-playbook deploy.yml
```

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `cron`, CI –∏–ª–∏ –≤—Ä—É—á–Ω—É—é.

### 6. ‚òÅÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–∞—Ö (user-data / cloud-init)

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å Ansible:

```bash
#!/bin/bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ansible
apt install -y ansible
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ playbook –∏–∑ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
ansible-pull -U https://github.com/org/repo.git site.yml
```

### 7. üß≠ Semaphore (Ansible UI)

**Semaphore** ‚Äî —ç—Ç–æ –ª—ë–≥–∫–∞—è, open-source –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ AWX.  
–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç **–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Ansible-–ø–ª–µ–π–±—É–∫–∞–º–∏ –∏ –∑–∞–¥–∞—á–∞–º–∏**.

#### üîë –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- –ó–∞–ø—É—Å–∫ playbook'–æ–≤ –ø–æ –∫–Ω–æ–ø–∫–µ –∏–ª–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- –†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, —à–∞–±–ª–æ–Ω–∞–º–∏ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Slack, Telegram)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞:

Semaphore –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ `.deb`, `.rpm`, Docker –∏–ª–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤.

#### üì∏ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

- –ü—Ä–æ—Å—Ç –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞–ª—ã—Ö –∏ —Å—Ä–µ–¥–Ω–∏—Ö –∫–æ–º–∞–Ω–¥

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –ú–µ—Ç–æ–¥        | –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è                      | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                 |
| ------------ | --------------------------------- | -------------------------- |
| Cron/systemd | –õ–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏                  | –ü—Ä–æ—Å—Ç–æ –∏ –Ω–∞–¥—ë–∂–Ω–æ           |
| AWX / AAP    | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ          | –ú–Ω–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π         |
| CI/CD        | DevOps –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥   | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Git           |
| Ansible-pull | Self-managed —Ö–æ—Å—Ç—ã                | –ù–µ —Ç—Ä–µ–±—É–µ—Ç SSH —Å–Ω–∞—Ä—É–∂–∏     |
| –°–∫—Ä–∏–ø—Ç—ã      | –ë—ã—Å—Ç—Ä—ã–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ | –ë–µ–∑ –∏–∑–ª–∏—à–µ—Å—Ç–≤              |
| Cloud-init   | –ê–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–µ         | –û—Ç–ª–∏—á–Ω–æ –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤ –º–∞—à–∏–Ω |
| Semaphore    | –ü—Ä–æ—Å—Ç–æ–µ UI-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏    | –õ—ë–≥–∫–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ AWX    |

</p></details>

---

### ‚ùì 9. –ï—Å—Ç—å –ª–∏ state-—Ñ–∞–π–ª –≤ Ansible?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (52:37)](https://youtu.be/pLU3zrUq87Y?t=3157)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

**–ù–µ—Ç**, –≤ Ansible **–Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ state-—Ñ–∞–π–ª–∞**, –∫–∞–∫ —É Terraform.  
Ansible –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏.

### üîç –ö–∞–∫ Ansible —É–∑–Ω–∞—ë—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞—à–∏–Ω—ã?

Ansible **–≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç "–∂–∏–≤–æ–µ" —Å–æ—Å—Ç–æ—è–Ω–∏–µ** —É–¥–∞–ª—ë–Ω–Ω–æ–π –º–∞—à–∏–Ω—ã —Å –ø–æ–º–æ—â—å—é:

### ‚úÖ 1. üì¶ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏

–ú–æ–¥—É–ª–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ `apt`, `file`, `service`, —Å–∞–º–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:

```yaml
- name: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
  ansible.builtin.apt:
    name: nginx
    state: present
```

üîπ –ú–æ–¥—É–ª—å –ø—Ä–æ–≤–µ—Ä–∏—Ç, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ nginx, –∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–µ—Ç, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –µ—Å—Ç—å.

### ‚úÖ 2. üß† –°–±–æ—Ä —Ñ–∞–∫—Ç–æ–≤ (gathering facts)

Ansible —Å–æ–±–∏—Ä–∞–µ—Ç —Ñ–∞–∫—Ç—ã –æ —Å–∏—Å—Ç–µ–º–µ —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å `setup`. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç:

- `ansible_distribution` ‚Üí Ubuntu
- `ansible_processor_cores` ‚Üí 4
- `ansible_default_ipv4.address` ‚Üí 192.168.1.10

üîπ –í–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–ª–∏ –≤—Ä—É—á–Ω—É—é:

```yaml
gather_facts: false  # –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ

# —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
- name: –°–±–æ—Ä —Ñ–∞–∫—Ç–æ–≤
  ansible.builtin.setup:
```

### ‚úÖ 3. üì• –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (`register`)

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```yaml
- name: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å nginx
  ansible.builtin.shell: systemctl is-active nginx
  register: nginx_status

- debug:
    var: nginx_status.stdout
```

### üìò –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å Terraform

| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å                | Ansible                       | Terraform           |
| -------------------------- | ----------------------------- | ------------------- |
| State-—Ñ–∞–π–ª                 | ‚ùå –ù–µ—Ç                        | ‚úÖ –ï—Å—Ç—å `.tfstate`  |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è         | –ß–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏ –∏ —Ñ–∞–∫—Ç—ã –Ω–∞ –º–µ—Å—Ç–µ | –õ–æ–∫–∞–ª—å–Ω–æ –∏ —É–¥–∞–ª—ë–Ω–Ω–æ |
| Push vs Pull               | Push (—É–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø—Ä—è–º—É—é)     | Declarative         |
| –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–µ–π—Ç–∞ | ‚úñ –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç                | ‚úî –î–∞                |

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- Ansible –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
- –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ —Ñ–∞–∫—Ç—ã –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏.
- –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –≥–∏–±–∫–∏–º, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç–∏ –≤ –∑–∞–¥–∞—á–∞—Ö –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

</p></details>

---

### ‚ùì 10. –ö–∞–∫–∏–º –∫–ª—é—á–æ–º –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å Ansible —É–∫–∞–∑–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç `root`)?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (52:51)](https://youtu.be/pLU3zrUq87Y?t=3171)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –û—Ç–≤–µ—Ç: `--become`

–ö–ª—é—á `--become` —Å–æ–æ–±—â–∞–µ—Ç Ansible, —á—Ç–æ –∑–∞–¥–∞—á–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –æ—Ç –∏–º–µ–Ω–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `root`).

### üìå –ü—Ä–∏–º–µ—Ä:

```bash
ansible-playbook playbook.yml --become
```

### üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏

| –ö–ª—é—á                | –û–ø–∏—Å–∞–Ω–∏–µ                                                         |
| ------------------- | ---------------------------------------------------------------- |
| `--become`          | –í–∫–ª—é—á–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π (`sudo`)                  |
| `--become-user`     | –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ—Ç –∏–º–µ–Ω–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `root`) |
| `--ask-become-pass` | –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å `sudo` –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ                   |

### üìù –ü—Ä–∏–º–µ—Ä –≤ playbook

```yaml
- hosts: all
  become: true

  tasks:
    - name: –û–±–Ω–æ–≤–∏—Ç—å apt-–∫–µ—à
      ansible.builtin.apt:
        update_cache: yes
```

### üìå –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

Ansible –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –∫–æ–º–∞–Ω–¥—ã –≤—Ä–æ–¥–µ:

```bash
sudo <–∫–æ–º–∞–Ω–¥–∞>
```

–ò –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `--become-user=postgres` –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `postgres`.

### üìò –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

- –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–æ–≤
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–π–ª–∞–º–∏, –¥–æ—Å—Ç—É–ø –∫ –∫–æ—Ç–æ—Ä—ã–º –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —É `root` –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

</p></details>

---

# 4. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è (Docker)

### ‚ùì 1. –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ Docker'a

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (53:31)](https://youtu.be/pLU3zrUq87Y?t=3211)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Docker **—Å–ª–æ–π** ‚Äî —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ `Dockerfile`.

- –ö–∞–∂–¥—ã–π —Å–ª–æ–π **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º (immutable)** –∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –ø–æ–≤–µ—Ä—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö
- –í—Å–µ —Å–ª–æ–∏ –≤–º–µ—Å—Ç–µ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –∫–æ–Ω–µ—á–Ω—ã–π Docker-–æ–±—Ä–∞–∑
- –°–ª–æ–∏ **–∫—ç—à–∏—Ä—É—é—Ç—Å—è**, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üì¶ –ü—Ä–∏–º–µ—Ä `Dockerfile`

```dockerfile
FROM ubuntu:22.04         # ‚Üê –°–ª–æ–π 1: –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
RUN apt update            # ‚Üê –°–ª–æ–π 2: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
RUN apt install -y nginx  # ‚Üê –°–ª–æ–π 3: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ nginx
COPY . /app               # ‚Üê –°–ª–æ–π 4: –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
```

–ö–∞–∂–¥–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π.

### üìå –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–ª–æ—ë–≤

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ               | –û–ø–∏—Å–∞–Ω–∏–µ                                              |
| -------------------------- | ----------------------------------------------------- |
| üîÅ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –û–±—â–∏–µ —Å–ª–æ–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –æ–±—Ä–∞–∑–∞–º–∏          |
| ‚ö° –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞          | –ï—Å–ª–∏ —Å–ª–æ–∏ –Ω–µ –∏–∑–º–µ–Ω—è–ª–∏—Å—å ‚Äî Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à       |
| üß© –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å             | –ú–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–∑—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–ª–æ—ë–≤ |

### ‚ö† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –°–ª–æ–∏ **–Ω–µ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è**: —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –Ω–æ–≤–æ–º —Å–ª–æ–µ –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º–µ—Å—Ç–æ –≤ —Å—Ç–∞—Ä–æ–º
- –ü–æ—Ä—è–¥–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π **–≤–ª–∏—è–µ—Ç –Ω–∞ –∫—ç—à**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–Ω–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –≤—Å–µ—Ö —Å–ª–µ–¥—É—é—â–∏—Ö
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–ª–æ—ë–≤ ‚Üí –±–æ–ª—å—à–∏–µ –æ–±—Ä–∞–∑—ã –∏ –¥–æ–ª—å—à–µ —Å–∫–∞—á–∏–≤–∞—Ç—å

### üèó –ö–∞–∫ Docker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–æ–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

- –í—Å–µ –Ω–∏–∂–Ω–∏–µ —Å–ª–æ–∏ ‚Äî **—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è**
- –í–µ—Ä—Ö–Ω–∏–π —Å–ª–æ–π (–¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞) ‚Äî **—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç **—Ç–æ–ª—å–∫–æ –≤ –≤–µ—Ä—Ö–Ω–µ–º —Å–ª–æ–µ**

### üìò –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- –°–ª–æ–∏ ‚Äî –∫–ª—é—á –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –æ–±—Ä–∞–∑–æ–≤
- –ß–µ–º –º–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ —á–∏—â–µ Dockerfile ‚Äî —Ç–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –∏—Ç–æ–≥–æ–≤—ã–π –æ–±—Ä–∞–∑
- –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–ª–æ—è–º–∏ —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ: –æ–±—ä–µ–¥–∏–Ω—è–π—Ç–µ RUN-–∫–æ–º–∞–Ω–¥—ã, —É–¥–∞–ª—è–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ —Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

</p></details>

---

### ‚ùì 2. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ENTRYPOINT –∏ CMD –≤ Dockerfile?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (54:24)](https://youtu.be/pLU3zrUq87Y?t=3264)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –û–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—É—é –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, –Ω–æ —É –Ω–∏—Ö —Ä–∞–∑–Ω—ã–µ —Ü–µ–ª–∏ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

### üì¶ CMD

- –ó–∞–¥–∞—ë—Ç **–∫–æ–º–∞–Ω–¥—É –∏–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**
- –õ–µ–≥–∫–æ **–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```Dockerfile
CMD ["nginx", "-g", "daemon off;"]
```

```bash
docker run myimage echo "Hello"
```

üîπ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç: `echo Hello`, –∞ –Ω–µ `nginx`

### üöÄ ENTRYPOINT

- –ó–∞–¥–∞—ë—Ç **–æ—Å–Ω–æ–≤–Ω—É—é –∫–æ–º–∞–Ω–¥—É**, –∫–æ—Ç–æ—Ä—É—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç
- –ê—Ä–≥—É–º–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å, –Ω–æ —Å–∞–º–∞ –∫–æ–º–∞–Ω–¥–∞ –æ—Å—Ç–∞—ë—Ç—Å—è

```Dockerfile
ENTRYPOINT ["nginx"]
```

```bash
docker run myimage -g "daemon off;"
```

üîπ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç: `nginx -g "daemon off;"`

### üîó –°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ENTRYPOINT` –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –∏ `CMD` –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```Dockerfile
ENTRYPOINT ["nginx"]
CMD ["-g", "daemon off;"]
```

üîπ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `nginx -g "daemon off;"`  
üîπ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ `CMD` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.

### üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞         | ENTRYPOINT                     | CMD                                |
| ---------------------- | ------------------------------ | ---------------------------------- |
| –¶–µ–ª—å                   | –û—Å–Ω–æ–≤–Ω–∞—è –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è –∫–æ–º–∞–Ω–¥–∞  | –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∏–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è?      | ‚ùå –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `--entrypoint` | ‚úÖ –ß–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã `docker run`    |
| –§–æ—Ä–º–∞—Ç—ã                | `exec` –∏ `shell`               | `exec` –∏ `shell`                   |
| –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è | –ê–≥–µ–Ω—Ç–æ–≤, —Å–∫—Ä–∏–ø—Ç–æ–≤, CLI-—É—Ç–∏–ª–∏—Ç  | –ü—Ä–æ—Å—Ç—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, —Ç–µ—Å—Ç–æ–≤       |

### üìò –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- –ò—Å–ø–æ–ª—å–∑—É–π `ENTRYPOINT`, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É
- –ò—Å–ø–æ–ª—å–∑—É–π `CMD` –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å
- –í –ø–∞—Ä–µ –æ–Ω–∏ –¥–∞—é—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –≥–∏–±–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å

</p></details>

---

### ‚ùì 3. –ö–∞–∫–æ–π –∫–æ–º–∞–Ω–¥–æ–π –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Dockerfile

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (55:13)](https://youtu.be/pLU3zrUq87Y?t=3313)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –í Dockerfile –¥–ª—è —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: USER

```dockerfile
USER <username –∏–ª–∏ UID>
```

–û–Ω–∞ –∑–∞–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ—Ç –∏–º–µ–Ω–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è **–≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã** (`RUN`, `CMD`, `ENTRYPOINT`, –∏ —Ç.–¥.)

### ‚úÖ –ü—Ä–∏–º–µ—Ä:

```dockerfile
FROM ubuntu:22.04

# –î–æ–±–∞–≤–∏–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
RUN useradd -m appuser

# –ü–µ—Ä–µ–∫–ª—é—á–∏–º—Å—è –Ω–∞ –Ω–µ–≥–æ
USER appuser

# –ö–æ–º–∞–Ω–¥—ã –Ω–∏–∂–µ –±—É–¥—É—Ç –æ—Ç –∏–º–µ–Ω–∏ appuser
CMD ["bash"]
```

### üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

| –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å                                 | –û–ø–∏—Å–∞–Ω–∏–µ                                            |
| ------------------------------------------- | --------------------------------------------------- |
| `USER` –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–∞ –≤—Å–µ –Ω–∏–∂–µ–ª–µ–∂–∞—â–∏–µ –∫–æ–º–∞–Ω–¥—ã | –í–∫–ª—é—á–∞—è `RUN`, `CMD`, `ENTRYPOINT`                  |
| –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–º—è –∏ UID                      | –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–∞–∫ `USER appuser`, —Ç–∞–∫ –∏ `USER 1001` |
| –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ root                      | –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏–≤ `USER root`                          |

### üöÄ –ü—Ä–∏–º–µ—Ä —Å ENTRYPOINT

```dockerfile
FROM node:18

RUN useradd -m nodeuser
USER nodeuser

ENTRYPOINT ["node"]
CMD ["app.js"]
```

üì¶ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç: `node app.js`  
üë§ –û—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `nodeuser`

### üìò –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- `USER` ‚Äî –≤–∞–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç `root`, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ
- –í—Å–µ–≥–¥–∞ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–π –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏

</p></details>

---

### ‚ùì 4. –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (55:22)](https://youtu.be/pLU3zrUq87Y?t=3322)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ `docker exec` –∏ –∫–æ–º–∞–Ω–¥—É `env`

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å **—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

```bash
docker exec <container_name_or_id> env
```

üîπ –ü—Ä–∏–º–µ—Ä:

```bash
docker exec my_container env
```

### ‚úÖ –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ `docker inspect`

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ** (—á–µ—Ä–µ–∑ `Dockerfile ENV` –∏–ª–∏ `-e`):

```bash
docker inspect <container_name_or_id>
```

üîπ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
docker inspect --format='{{range .Config.Env}}{{println .}}{{end}}' <container_name_or_id>
```

### üîç –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –º–µ—Ç–æ–¥–∞–º–∏

| –ú–µ—Ç–æ–¥             | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç                                          |
| ----------------- | --------------------------------------------------- |
| `docker exec env` | –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ |
| `docker inspect`  | –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ             |

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

- –ò—Å–ø–æ–ª—å–∑—É–π `docker exec` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–π `docker inspect` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—É—Å–∫–∞
- –û–±–∞ –º–µ—Ç–æ–¥–∞ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –∞—É–¥–∏—Ç–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

</p></details>

---

### ‚ùì 5. –ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç restart –ø–æ–ª–∏—Ç–∏–∫–∏?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (55:13)](https://youtu.be/pLU3zrUq87Y?t=3376)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### Docker –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–∏—Ç–∏–∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, —á—Ç–æ–±—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –ø—Ä–∏ —Å–±–æ—è—Ö –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã.

###üîÅ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

| –ü–æ–ª–∏—Ç–∏–∫–∞              | –ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫             | –û–ø–∏—Å–∞–Ω–∏–µ                                                                        |
| --------------------- | ---------------------------------------- | ------------------------------------------------------------------------------- |
| `no` _(–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)_ | –ù–∏–∫–æ–≥–¥–∞                                  | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω                                    |
| `always`              | –í—Å–µ–≥–¥–∞, –ø—Ä–∏ –ª—é–±–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏             | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –¥–∞–∂–µ –ø–æ—Å–ª–µ —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ Docker |
| `on-failure[:N]`      | –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Å –æ—à–∏–±–∫–æ–π (exit code ‚â† 0) | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ–µ, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ `N`      |
| `unless-stopped`      | –í—Å–µ–≥–¥–∞, –∫—Ä–æ–º–µ —Å–ª—É—á–∞–µ–≤ —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏   | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç —è–≤–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º                    |

### üìç –ì–¥–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å `restart` –ø–æ–ª–∏—Ç–∏–∫—É

### 1. –ß–µ—Ä–µ–∑ `docker run`

```bash
docker run --restart=always my-container
docker run --restart=on-failure:3 my-container
docker run --restart=unless-stopped my-container
```

### 2. –í `docker-compose.yml`

```yaml
version: '3.8'
services:
  app:
    image: my-app
    restart: unless-stopped
```

> –ü–∞—Ä–∞–º–µ—Ç—Ä `restart` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ Docker Compose 2.

### ‚ö†Ô∏è –ì–¥–µ **–Ω–µ–ª—å–∑—è** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `restart`

- ‚ùå –í `Dockerfile` ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –∑–∞–ø—É—Å–∫—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∞ –Ω–µ –∫ –æ–±—Ä–∞–∑—É.
- ‚ùå –í `docker build` ‚Äî —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏.

### üß† –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—É—é –ø–æ–ª–∏—Ç–∏–∫—É?

| –°—Ü–µ–Ω–∞—Ä–∏–π                                                    | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ |
| ----------------------------------------------------------- | ---------------------- |
| –ö—Ä–∏—Ç–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ–≥–¥–∞            | `always`               |
| –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è –æ—à–∏–±–∫–æ–π, –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ | `on-failure:3`         |
| –ù—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ —Ä—É—á–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏           | `unless-stopped`       |
| –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ                         | `no`                   |

</p></details>

---

### ‚ùì 6. –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Docker –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã, –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –Ω–∞ —Ö–æ—Å—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ? –ï—Å–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ ‚Äî –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (56:57)](https://youtu.be/pLU3zrUq87Y?t=3417)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –ò–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **–Ω–µ–ª—å–∑—è –≤–∏–¥–µ—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Ö–æ—Å—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã**. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º—ë–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (PID namespace), —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤–∏–¥—è—Ç **—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ** –ø—Ä–æ—Ü–µ—Å—Å—ã.

### ‚úÖ –ö–∞–∫ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ—Ü–µ—Å—Å–∞–º —Ö–æ—Å—Ç–∞

–ß—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–≥ –≤–∏–¥–µ—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Ö–æ—Å—Ç–∞, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PID namespace —Ö–æ—Å—Ç–∞.

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--pid=host` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run --pid=host -it ubuntu bash
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
ps aux
```

–ü–æ–∫–∞–∂–µ—Ç **–≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã**, –≤–∫–ª—é—á–∞—è —Ö–æ—Å—Ç–æ–≤—ã–µ.

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å **—É–≥—Ä–æ–∑—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**.
- –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏**, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–ª–∏ –≤ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–≥–µ–Ω—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤).

### üìå –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
docker run --rm --pid=host -it alpine sh
```

```sh
# –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
ps -ef | grep systemd
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –Ω–∞ —Ö–æ—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω–µ.

### üõ° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--pid=host` –≤ production-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö**, –µ—Å–ª–∏ –≤ —ç—Ç–æ–º –Ω–µ—Ç —Å—Ç—Ä–æ–≥–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Ä–µ–∂–∏–º —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π —Å—Ä–µ–¥–µ.

### 2. –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `/proc` —Ö–æ—Å—Ç–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

–ö—Ä–æ–º–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `--pid=host`, –º–æ–∂–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ—Ü–µ—Å—Å–∞–º —Ö–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ `/proc`:

```bash
docker run -it --rm \
  -v /proc:/host_proc \
  ubuntu bash
```

### –ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç:

- –¢—ã –ø–æ–ª—É—á–∞–µ—à—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ `/proc` —Ö–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ –ø—É—Ç—å `/host_proc`.
- –ú–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```bash
cat /host_proc/1/cmdline
ls -l /host_proc/1/fd
```

### –ù–æ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

- –ö–æ–º–∞–Ω–¥—ã `ps`, `top` –∏ –¥—Ä—É–≥–∏–µ —É—Ç–∏–ª–∏—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **–Ω–µ –ø–æ–∫–∞–∂—É—Ç —Ö–æ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã**, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Å–≤–æ—ë–º PID namespace.
- –≠—Ç–æ **—Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ**, –∞ –Ω–µ –∫ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É –∏–º—ë–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

### üîÅ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (–∏ `ps`, –∏ `/proc`), –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –¥–≤—É–º—è —Ñ–ª–∞–≥–∞–º–∏:

```bash
docker run -it --rm \
  --pid=host \
  -v /proc:/host_proc \
  ubuntu bash
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ç—ã —Å–º–æ–∂–µ—à—å:

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ps`, `top`, `htop` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.
- –ß—Ç–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `/proc` —Ö–æ—Å—Ç–∞ ‚Äî –∫–∞–∫ –µ—Å—Ç—å.

### üõ° –ó–∞–º–µ—á–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- –õ—é–±–æ–π –∏–∑ —ç—Ç–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤ **—Å–Ω–∏–∂–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö —Å–ª–µ–¥—É–µ—Ç **—Ç–æ–ª—å–∫–æ –≤ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Ü–µ–ª—è—Ö –∏–ª–∏ –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ**.

</p></details>

---

### ‚ùì 7. –ö–∞–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Docker –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å (–ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å) —Å–µ—Ç–µ–≤–æ–π –ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞—Ä—É–∂—É –Ω–∞ —Ö–æ—Å—Ç–æ–≤—É—é –º–∞—à–∏–Ω—É?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (57:33)](https://youtu.be/pLU3zrUq87Y?t=3453)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é `docker run` –º–æ–∂–Ω–æ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç—ã —Å –ø–æ–º–æ—â—å—é –æ–ø—Ü–∏–∏ `-p` –∏–ª–∏ `--publish`.

### üì• –°–∏–Ω—Ç–∞–∫—Å–∏—Å:

```bash
docker run -p <host_port>:<container_port> image_name
```

### üìå –ü—Ä–∏–º–µ—Ä:

```bash
docker run -d -p 8080:80 nginx
```

- `80` ‚Äî –ø–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (Nginx —Å–ª—É—à–∞–µ—Ç –Ω–∞ 80)
- `8080` ‚Äî –ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω–µ
- –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø –∫ Nginx –±—É–¥–µ—Ç —á–µ—Ä–µ–∑ `http://localhost:8080`

### üîÑ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ä—Ç–æ–≤

```bash
docker run -p 8080:80 -p 443:443 myapp
```

### üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å docker-compose

–í `docker-compose.yml`:

```yaml
version: '3.8'
services:
  web:
    image: nginx
    ports:
      - '8080:80'
```

### üß† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

- –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å **IP-–∞–¥—Ä–µ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞**, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç:

```bash
docker run -p 127.0.0.1:8080:80 nginx
```

- –ï—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç, Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç —Ö–æ—Å—Ç–æ–≤—ã–π:

```bash
docker run -p 80 nginx
# –•–æ—Å—Ç–æ–≤—ã–π –ø–æ—Ä—Ç –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

- –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ **—Ä–µ–∂–∏–º–µ —Å–µ—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (bridge)**. –í —Ä–µ–∂–∏–º–µ `--network=host` –ø—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤ –Ω–µ –Ω—É–∂–Ω–∞, —Ç.–∫. –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ç—å —Ö–æ—Å—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é.

### üõë –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ù–µ –ø—É–±–ª–∏–∫—É–π –ø–æ—Ä—Ç—ã –Ω–∞—Ä—É–∂—É, –µ—Å–ª–∏ –≤ —ç—Ç–æ–º –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
- –î–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä –∏–ª–∏ —Å–ª—É—à–∞–π —Ç–æ–ª—å–∫–æ `127.0.0.1`.

</p></details>

---

### ‚ùì 8. –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –ø–æ–ª–µ–∑–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å network host?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (58:03)](https://youtu.be/pLU3zrUq87Y?t=3483)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### 1. –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é:

- VPN-—Å–µ—Ä–≤–µ—Ä—ã (WireGuard, OpenVPN)
- DHCP-—Å–µ—Ä–≤–µ—Ä—ã
- –ü—Ä–æ–∫—Å–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ç–∏

### 2. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –£–±–∏—Ä–∞–µ—Ç—Å—è –æ–≤–µ—Ä—Ö–µ–¥ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ –º–æ—Å—Ç–∞ Docker
- –ú–µ–Ω—å—à–µ –∑–∞–¥–µ—Ä–∂–∫–∏, –≤—ã—à–µ –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- –ü–æ–ª–µ–∑–Ω–æ –≤ —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö —Å –≤—ã—Å–æ–∫–æ–π —Å–µ—Ç–µ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π

### 3. –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º

- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç—ã –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ `-p`
- –£–ø—Ä–æ—â–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 4. –°–∏—Å—Ç–µ–º–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ê–≥–µ–Ω—Ç—ã –≤—Ä–æ–¥–µ:

- `node_exporter`, `telegraf`, `prometheus`, `zabbix-agent`
- –ù—É–∂–¥–∞—é—Ç—Å—è –≤ –¥–æ—Å—Ç—É–ø–µ –∫ `localhost`, —Å–æ–∫–µ—Ç–∞–º, –º–µ—Ç—Ä–∏–∫–∞–º —Ö–æ—Å—Ç–∞

### 5. –î–æ—Å—Ç—É–ø –∫ `127.0.0.1` —Ö–æ—Å—Ç–∞

- –û–±—ã—á–Ω–æ `localhost` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ‚Äî —ç—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
- –° `--network=host`, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–∑–¥–µ–ª—è–µ—Ç loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —Ö–æ—Å—Ç–æ–º

### ‚ö†Ô∏è –ö–æ–≥–¥–∞ **–Ω–µ —Å—Ç–æ–∏—Ç** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

| –°—Ü–µ–Ω–∞—Ä–∏–π                                | –ü—Ä–∏—á–∏–Ω–∞                                      |
| --------------------------------------- | -------------------------------------------- |
| –ú–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ        | –í–æ–∑–º–æ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ—Ä—Ç–æ–≤                    |
| –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–∑–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏      | –ù–∞—Ä—É—à–∞–µ—Ç—Å—è —Å–µ—Ç–µ–≤–∞—è –∏–∑–æ–ª—è—Ü–∏—è                  |
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ **Mac** –∏–ª–∏ **Windows** | `--network=host` —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –≤ Linux** |

### üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–∞—Ä–∞–º–µ—Ç—Ä `--network=host` –º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏:

- üëç –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Å–ª—É—á–∞—è—Ö, –≥–¥–µ –æ–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º
- üîí –ò–∑–±–µ–≥–∞–π—Ç–µ –≤ production-—Å—Ä–µ–¥–∞—Ö –±–µ–∑ —Å—Ç—Ä–æ–≥–∏—Ö –ø—Ä–∏—á–∏–Ω

</p></details>

---

### ‚ùì 9. –ö–∞–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã (CPU, –ø–∞–º—è—Ç—å –∏ —Ç.–¥.) –¥–ª—è Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ‚Äî –∫–∞–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ, —Ç–∞–∫ –∏ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (59:08)](https://youtu.be/pLU3zrUq87Y?t=3548)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### 1. üöÄ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`docker run`)

#### CPU:

```bash
docker run --cpus="1.5" my-app
```

- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 1.5 CPU

```bash
docker run --cpuset-cpus="0,2" my-app
```

- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —è–¥—Ä–∞—Ö 0 –∏ 2

#### –ü–∞–º—è—Ç—å:

```bash
docker run --memory="512m" --memory-swap="1g" my-app
```

- 512 –ú–ë –û–ó–£, –º–∞–∫—Å–∏–º—É–º 1 –ì–ë –≤–∫–ª—é—á–∞—è swap

#### –ü—Ä–æ—Ü–µ—Å—Å—ã:

```bash
docker run --pids-limit=100 my-app
```

### 2. ‚öôÔ∏è –ß–µ—Ä–µ–∑ `docker-compose.yml`

```yaml
version: '3.8'
services:
  app:
    image: my-app
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 512M
```

> ‚ö†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `deploy.resources` —Ä–∞–±–æ—Ç–∞—é—Ç **—Ç–æ–ª—å–∫–æ –≤ Docker Swarm**. –î–ª—è –æ–±—ã—á–Ω–æ–≥–æ Docker Compose –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```yaml
services:
  app:
    image: my-app
    mem_limit: 512m
    cpus: 1.0
```

### 3. üîÑ –î–ª—è —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`docker update`)

–ú–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
docker update --memory 256m --cpus 0.5 my-container
```

---

### 4. üß† –ß–µ—Ä–µ–∑ cgroups –Ω–∞–ø—Ä—è–º—É—é (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å)

Docker –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **cgroups**, –∏ –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ª–∏–º–∏—Ç—ã:

- –ß–µ—Ä–µ–∑ systemd —é–Ω–∏—Ç—ã
- –ò–ª–∏ –º–æ–Ω—Ç–∏—Ä—É—è cgroup-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∑–∞–¥–∞–≤–∞—è –ª–∏–º–∏—Ç—ã –≤—Ä—É—á–Ω—É—é

–ù–æ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Ö–æ—Ä–æ—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —è–¥—Ä–∞ Linux.

### üõ° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π —Ä–µ—Å—É—Ä—Å—ã –≤—Å–µ–≥–¥–∞** –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –º–æ–≥ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å —Ö–æ—Å—Ç
- –°–ª–µ–¥–∏ –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏: `docker stats`, `cadvisor`, `prometheus`, `grafana`
- –ò—Å–ø–æ–ª—å–∑—É–π `--oom-kill-disable` —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å

### üìå –í—ã–≤–æ–¥

–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –º–æ–∂–Ω–æ:

| –°–ø–æ—Å–æ–±               | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                   |
| -------------------- | ------------------------------------ |
| `docker run`         | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞              |
| `docker update`      | –î–ª—è —É–∂–µ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞       |
| `docker-compose.yml` | –í —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏            |
| `cgroups` –≤—Ä—É—á–Ω—É—é    | –í –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –∏–ª–∏ embedded-—Å—Ü–µ–Ω–∞—Ä–∏—è—Ö |

</p></details>

---

# 5. Nginx

### ‚ùì 1. –ö–∞–∫ –∫ nginx –ø–æ–¥–∫–ª—é—á–∏—Ç—å php?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (1:00:24)](https://youtu.be/pLU3zrUq87Y?t=3624)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### Nginx –Ω–µ —É–º–µ–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –≤—ã–ø–æ–ª–Ω—è—Ç—å PHP-—Å–∫—Ä–∏–ø—Ç—ã. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç `.php` —Ñ–∞–π–ª—ã **–≤ PHP-FPM** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª–Ω—è–µ—Ç PHP –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

### üß± –ß—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è

- **Nginx** ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- **PHP-FPM** ‚Äî FastCGI Process Manager –¥–ª—è PHP
- **php-cli**, **php-extensions** ‚Äî –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### üõ† –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã (Ubuntu/Debian)

```bash
sudo apt update
sudo apt install nginx php php-fpm
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ PHP-FPM

```bash
sudo systemctl status php8.1-fpm
```

> –í–µ—Ä—Å–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å `php7.4-fpm`, `php8.2-fpm` –∏ —Ç.–¥. ‚Äî —Å–º–æ—Ç—Ä–∏, –∫–∞–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.

### 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx

–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–¥–µ—Å—å:

```bash
sudo nano /etc/nginx/sites-available/default
```

#### –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```nginx
server {
    listen 80;
    server_name localhost;

    root /var/www/html;
    index index.php index.html index.htm;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/run/php/php8.1-fpm.sock;
    }

    location ~ /\.ht {
        deny all;
    }
}
```

> –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ–±—ã –ø—É—Ç—å –∫ `fastcgi_pass` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª —Ç–≤–æ–µ–π –≤–µ—Ä—Å–∏–∏ PHP. –ù–∞–ø—Ä–∏–º–µ—Ä:
>
> - `php7.4-fpm`: `/run/php/php7.4-fpm.sock`
> - `php8.1-fpm`: `/run/php/php8.1-fpm.sock`

### 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—ã

```bash
sudo systemctl reload nginx
sudo systemctl restart php8.1-fpm
```

### 5. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª

```bash
sudo nano /var/www/html/index.php
```

```php
<?php phpinfo(); ?>
```

–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ:  
üìé `http://localhost/index.php`

–ï—Å–ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ç—ã —É–≤–∏–¥–∏—à—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ PHP.

### ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞                          | –†–µ—à–µ–Ω–∏–µ                                                |
| --------------------------------- | ------------------------------------------------------ |
| –ë–µ–ª–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ / —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ | PHP-FPM –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–ª–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Nginx           |
| 403 Forbidden                     | –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É –∏ —Ñ–∞–π–ª—ã (`www-data`)            |
| 502 Bad Gateway                   | –ü—Ä–æ–≤–µ—Ä—å –ø—É—Ç—å –∫ `php-fpm.sock` –∏ —á—Ç–æ FPM-—Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω |

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PHP —á–µ—Ä–µ–∑ PHP-FPM –∏ –º–æ–∂–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å `.php` —Ñ–∞–π–ª—ã.

</p></details>

---

### ‚ùì 2. –ö–∞–∫ –∏ –∫–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Å nginx?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:00:55)](https://youtu.be/pLU3zrUq87Y?t=3655)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

###üîß –°–ø–æ—Å–æ–±—ã –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫

### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å `stub_status`

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏.

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞:

```nginx
location /nginx_status {
    stub_status;
    allow 127.0.0.1;
    deny all;
}
```

#### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
Active connections: 3
server accepts handled requests
 1374 1374 2346
Reading: 0 Writing: 1 Waiting: 2
```

#### –ü–æ—è—Å–Ω–µ–Ω–∏—è:

- `Active connections` ‚Äî —Ç–µ–∫—É—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `accepts` ‚Äî –≤—Å–µ–≥–æ –ø—Ä–∏–Ω—è—Ç—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- `handled` ‚Äî —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- `requests` ‚Äî –æ–±—â–µ–µ —á–∏—Å–ª–æ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
- `Reading`, `Writing`, `Waiting` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

</p></details>

---

### ‚ùì 3. –í—ã–ø–æ–ª–Ω—è–µ—Ç –ª–∏ Nginx –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ upstream-—Å–µ—Ä–≤–µ—Ä–∞–º–∏, –∏ –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:01:19)](https://youtu.be/pLU3zrUq87Y?t=3679)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –î–∞, **Nginx –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏** –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ backend-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –¥–∏—Ä–µ–∫—Ç–∏–≤—É `upstream`.

### üìÑ –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```nginx
upstream backend {
    server backend1.example.com;
    server backend2.example.com;
}

server {
    listen 80;

    location / {
        proxy_pass http://backend;
    }
}
```

### ‚öôÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

| –ú–µ—Ç–æ–¥                          | –û–ø–∏—Å–∞–Ω–∏–µ                                                                |
| ------------------------------ | ----------------------------------------------------------------------- |
| `round-robin` _(–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)_ | –ó–∞–ø—Ä–æ—Å—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏                                      |
| `least_conn`                   | –ó–∞–ø—Ä–æ—Å –∏–¥—ë—Ç –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º —á–∏—Å–ª–æ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π           |
| `ip_hash`                      | –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª–∏–µ–Ω—Ç (–ø–æ IP) –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Å–µ—Ä–≤–µ—Ä           |
| `hash`                         | –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π                                     |
| `random`\*                     | –í—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (—Ç–æ–ª—å–∫–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–±–æ—Ä–∫–∞—Ö –∏–ª–∏ —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏) |

### üß± –ü—Ä–∏–º–µ—Ä—ã

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –∑–∞–≥—Ä—É–∑–∫–æ–π:

```nginx
upstream backend {
    least_conn;
    server backend1.example.com;
    server backend2.example.com;
}
```

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ IP –∫–ª–∏–µ–Ω—Ç–∞:

```nginx
upstream backend {
    ip_hash;
    server backend1.example.com;
    server backend2.example.com;
}
```

### ü©∫ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ—Ç–∫–∞–∑–æ–≤:

```nginx
upstream backend {
    server backend1.example.com max_fails=3 fail_timeout=10s;
    server backend2.example.com;
}
```

> –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ **–ø–∞—Å—Å–∏–≤–Ω—ã–π health check**: —Å–µ—Ä–≤–µ—Ä –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç.

## üö´ –ß—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –≤ open-source Nginx

- **–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è (active health checks)** ‚Äî –¥–æ—Å—Ç—É–ø–Ω—ã **—Ç–æ–ª—å–∫–æ –≤ Nginx Plus**
- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è upstream'–æ–≤ —á–µ—Ä–µ–∑ API

### ‚úÖ –í—ã–≤–æ–¥

- Nginx **–≤—ã–ø–æ–ª–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É** –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ —Å –ø–æ–º–æ—â—å—é `upstream`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑–æ–≤—É—é –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–µ –º–æ–¥—É–ª–∏ –∏–ª–∏ Nginx Plus

</p></details>

---

### ‚ùì 4. –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤ Nginx, –∏ –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è —ç—Ç–æ–≥–æ?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:01:34)](https://youtu.be/pLU3zrUq87Y?t=3694)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS –≤ Nginx
- –ü–æ–ª—É—á–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ —Å –ø–æ–º–æ—â—å—é Let's Encrypt

### üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –î–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `example.com`)
- –°–µ—Ä–≤–µ—Ä —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º **Nginx**
- –î–æ—Å—Ç—É–ø –ø–æ –ø–æ—Ä—Ç—É 80 –∏ 443
- root-–¥–æ—Å—Ç—É–ø

### üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot

### Ubuntu/Debian:

```bash
sudo apt update
sudo apt install certbot python3-certbot-nginx
```

### üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSL

```bash
sudo certbot --nginx -d example.com -d www.example.com
```

- Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç SSL
- –ï—Å–ª–∏ –¥–æ–º–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –æ—Ç–∫—Ä—ã—Ç –ø–æ—Ä—Ç 80, –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ

### üìÑ –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx —Å HTTPS

```nginx
server {
    listen 80;
    server_name example.com www.example.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name example.com www.example.com;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    root /var/www/html;
    index index.html index.php;

    location / {
        try_files $uri $uri/ =404;
    }
}
```

## üîÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–µ–π—Å—Ç–≤—É—é—Ç 90 –¥–Ω–µ–π. Certbot —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

```bash
sudo systemctl list-timers | grep certbot
```

–ú–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

```bash
sudo certbot renew --dry-run
```

## üõ† –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–¥–ª—è —Ç–µ—Å—Ç–∞)

```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/selfsigned.key \
  -out /etc/ssl/certs/selfsigned.crt
```

–ò –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏—Ö –≤ –∫–æ–Ω—Ñ–∏–≥–µ Nginx.

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –î–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ IP —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ—Ä—Ç 80 **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–π `www` –∏ `–±–µ–∑ www`, –µ—Å–ª–∏ —Å–∞–π—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—É–¥–µ—Ç –≤—ã–¥–∞–Ω Let's Encrypt
- HTTPS –Ω–∞—á–Ω—ë—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

</p></details>

---

### ‚ùì 5. –ö–∞–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–º–µ–Ω–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ Let's Encrypt?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:02:26)](https://youtu.be/pLU3zrUq87Y?t=3746)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üîç –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥: HTTP-01 Challenge

–°–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–∞ ‚Äî —ç—Ç–æ **HTTP-01**.

### ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç HTTP-01

1. –¢—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å `certbot --nginx -d example.com`
2. Certbot –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ Let's Encrypt –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
3. Let's Encrypt –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω**
4. Certbot:
   - –°–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª –ø–æ –ø—É—Ç–∏: `/.well-known/acme-challenge/<—Ç–æ–∫–µ–Ω>`
   - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Nginx, —á—Ç–æ–±—ã —Ñ–∞–π–ª –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ
5. Let's Encrypt –¥–µ–ª–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å:
   ```
   http://example.com/.well-known/acme-challenge/<—Ç–æ–∫–µ–Ω>
   ```
6. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω –∏ –≤–∞–ª–∏–¥–µ–Ω ‚Äî –¥–æ–º–µ–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–º
7. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—ã–¥–∞–Ω –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### üß™ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç Let's Encrypt

```
GET http://example.com/.well-known/acme-challenge/abc123
```

–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

```
abc123.<—Ç–≤–æ–π-–ø—É–±–ª–∏—á–Ω—ã–π-–∫–ª—é—á>
```

### üì¶ –î—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

| –ú–µ—Ç–æ–¥           | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                |
| --------------- | ----------------------------------------------------------------------------------------------------------------------- |
| **DNS-01**      | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ TXT-–∑–∞–ø–∏—Å–∏ –≤ DNS –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–ª–∞–¥–µ–Ω–∏—è –¥–æ–º–µ–Ω–æ–º. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è wildcard-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (`*.example.com`) |
| **TLS-ALPN-01** | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ TLS-—Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ 443 –ø–æ—Ä—Ç—É. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–µ, —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏                            |

### ‚ö†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π HTTP-–≤–∞–ª–∏–¥–∞—Ü–∏–∏

- –î–æ–º–µ–Ω –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π IP —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ—Ä—Ç **80 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç**
- Nginx –Ω–µ –¥–æ–ª–∂–µ–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—É—Ç—å `/.well-known/acme-challenge/`
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –Ω–µ—Ç –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü–∏–π, –º–µ—à–∞—é—â–∏—Ö –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### ‚úÖ –í—ã–≤–æ–¥

Let's Encrypt –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –≤–ª–∞–¥–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–º —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π HTTP-–¥–æ—Å—Ç—É–ø –∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—É. –≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–±, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ª–∏—á–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Certbot –∏ Nginx.

</p></details>

---

### ‚ùì 6. –ß—Ç–æ —Ç–∞–∫–æ–µ default_server –≤ Nginx?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:03:56)](https://youtu.be/pLU3zrUq87Y?t=3836)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

`default_server` ‚Äî —ç—Ç–æ **—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –º–µ—Ç–∫–∞**, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤–µ `listen` –≤–Ω—É—Ç—Ä–∏ `server` –±–ª–æ–∫–∞, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å **–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ "–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"** –¥–ª—è –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç, –µ—Å–ª–∏ –æ–Ω–∏ **–Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –Ω–∏ —Å –æ–¥–Ω–∏–º `server_name`**.

### üìå –ü—Ä–∏–º–µ—Ä

```nginx
server {
    listen 80 default_server;
    server_name _;
    return 444;
}
```

- `listen 80 default_server;` ‚Äî –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –±–ª–æ–∫ "–¥–µ—Ñ–æ–ª—Ç–Ω—ã–º" –¥–ª—è –ø–æ—Ä—Ç–∞ 80
- `server_name _;` ‚Äî –ª–æ–≤–∏—Ç –≤—Å–µ –∏–º–µ–Ω–∞, –µ—Å–ª–∏ —è–≤–Ω–æ –Ω–µ –∑–∞–¥–∞–Ω–æ

### üß† –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

- –ö–æ–≥–¥–∞ –Ω–µ—Ç —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è `Host` –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å `server_name`
- –ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ IP-–∞–¥—Ä–µ—Å—É
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ:
  - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å—ë –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å fallback-–¥–æ–º–µ–Ω—ã

### üõ† –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üîí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Å–µ–≥–æ, —á—Ç–æ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç:

```nginx
server {
    listen 80 default_server;
    server_name _;
    return 444;  # –ó–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞
}
```

### üîÅ –†–µ–¥–∏—Ä–µ–∫—Ç –≤—Å–µ—Ö "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö" –Ω–∞ HTTPS-–¥–æ–º–µ–Ω:

```nginx
server {
    listen 80 default_server;
    server_name _;
    return 301 https://example.com$request_uri;
}
```

#### ‚öôÔ∏è –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- –ú–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å `default_server` –¥–ª—è **–∫–∞–∂–¥–æ–≥–æ `listen` –ø–æ—Ä—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ**
- –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞—Ç—å —è–≤–Ω–æ, Nginx –≤—ã–±–µ—Ä–µ—Ç **–ø–µ—Ä–≤—ã–π –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π `server` –±–ª–æ–∫** –∫–∞–∫ "–¥–µ—Ñ–æ–ª—Ç–Ω—ã–π"

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
nginx -T | grep default_server
```

### üìå –í—ã–≤–æ–¥

| –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `default_server`                                     | –ó–Ω–∞—á–µ–Ω–∏–µ |
| --------------------------------------------------------------- | -------- |
| –î–µ–ª–∞–µ—Ç `server` –±–ª–æ–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –ø–æ—Ä—Ç–∞        | ‚úÖ       |
| –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ `Host` –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç –Ω–∏ —Å –æ–¥–Ω–∏–º `server_name` | ‚úÖ       |
| –ß–∞—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∑–∞—â–∏—Ç—ã –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤                       | ‚úÖ       |

</p></details>

---

### ‚ùì 7. –ß—Ç–æ —Ç–∞–∫–æ–µ Proxy Protocol?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:04:11)](https://youtu.be/pLU3zrUq87Y?t=3851)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### **Proxy Protocol** ‚Äî —ç—Ç–æ —Å–µ—Ç–µ–≤–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–∞–ª—å–Ω–æ–º –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ (IP, –ø–æ—Ä—Ç –∏ —Ç.–¥.) –æ—Ç –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞ –∫ backend-—Å–µ—Ä–≤–µ—Ä—É.

### üß† –ó–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?

–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, HAProxy, AWS ELB), backend-—Å–µ—Ä–≤–µ—Ä –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ IP –ø—Ä–æ–∫—Å–∏, –∞ –Ω–µ –∫–ª–∏–µ–Ω—Ç–∞.

Proxy Protocol –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å:

- IP-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- –ü–æ—Ä—Ç –∫–ª–∏–µ–Ω—Ç–∞
- –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (TCP/UDP)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–≤ v2)

### üìÑ –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–¥–∞—á–∏

```
PROXY TCP4 192.168.1.10 10.0.0.2 12345 80
```

- `192.168.1.10` ‚Äî IP –∫–ª–∏–µ–Ω—Ç–∞
- `10.0.0.2` ‚Äî IP –ø—Ä–æ–∫—Å–∏
- `12345` ‚Äî –ø–æ—Ä—Ç –∫–ª–∏–µ–Ω—Ç–∞
- `80` ‚Äî –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞

### üî¢ –í–µ—Ä—Å–∏–∏ Proxy Protocol

| –í–µ—Ä—Å–∏—è | –§–æ—Ä–º–∞—Ç    | –û–ø–∏—Å–∞–Ω–∏–µ                  |
| ------ | --------- | ------------------------- |
| v1     | –¢–µ–∫—Å—Ç–æ–≤—ã–π | –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π, –ø—Ä–æ—Å—Ç–æ–π |
| v2     | –ë–∏–Ω–∞—Ä–Ω—ã–π  | –ë—ã—Å—Ç—Ä–µ–µ, –≥–∏–±—á–µ, —Å–ª–æ–∂–Ω–µ–µ   |

### ‚öôÔ∏è –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Proxy Protocol?

- HAProxy
- AWS ELB (Classic/ALB/NLB)
- Cloudflare Spectrum
- Nginx (stream-–º–æ–¥—É–ª—å)
- Traefik

### üß© –ü—Ä–∏–º–µ—Ä –¥–ª—è Nginx (stream)

```nginx
stream {
    server {
        listen 443 proxy_protocol;
        proxy_pass backend:443;
    }

    upstream backend {
        server 192.168.1.10:443;
    }
}
```

- `listen 443 proxy_protocol;` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –æ—Ç –ø—Ä–æ–∫—Å–∏
- `proxy_protocol on;` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É Proxy Protocol –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É–∑–ª—É

### üõë –í–∞–∂–Ω–æ

- –û–±–∞ –∫–æ–Ω—Ü–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã **–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å Proxy Protocol**, –∏–Ω–∞—á–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–µ—Ä–≤–∞–Ω–æ.
- –í HTTP-–±–ª–æ–∫–∞—Ö (–Ω–µ `stream`) –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ–∑–º–æ–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ **Nginx Plus** –∏–ª–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ –º–æ–¥—É–ª—è–º–∏.

### üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Proxy Protocol ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ —Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ –∏–ª–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –¥–æ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–µ —Ç–µ—Ä—è—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π IP.

</p></details>

---

# 6. Postgres

### ‚ùì 1. –ß—Ç–æ —Ç–∞–∫–æ–µ Write-Ahead Log (WAL) –≤ PostgreSQL?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:05:01)](https://youtu.be/pLU3zrUq87Y?t=3901)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### **Write-Ahead Log (WAL)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π **–∂—É—Ä–Ω–∞–ª (–ª–æ–≥)**, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∫ –æ—Å–Ω–æ–≤–Ω—ã–º –¥–∞–Ω–Ω—ã–º. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö
- –†–µ–ø–ª–∏–∫–∞—Ü–∏—é
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ —Ç–æ—á–∫–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏

### ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –¢—ã –≤–Ω–æ—Å–∏—à—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î: `INSERT`, `UPDATE`, `DELETE`.
2. PostgreSQL **—Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å –æ–± —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ WAL**.
3. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –¥–∏—Å–∫–µ.
4. –ö–æ–º–º–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤ WAL**.

### ‚úÖ –ó–∞—á–µ–º –Ω—É–∂–µ–Ω WAL

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ               | –û–ø–∏—Å–∞–Ω–∏–µ                                                                    |
| ------------------------ | --------------------------------------------------------------------------- |
| üîÅ Crash recovery        | –í —Å–ª—É—á–∞–µ —Å–±–æ—è PostgreSQL –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑ WAL –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ë–î |
| üîÑ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è            | WAL-—Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —Ä–µ–ø–ª–∏–∫–∏ (standby-—Å–µ—Ä–≤–µ—Ä—ã)                           |
| ‚è± Point-in-time recovery | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î –Ω–∞ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å WAL + –±—ç–∫–∞–ø)         |

### üóÇ –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è WAL-—Ñ–∞–π–ª—ã?

- –ü–∞–ø–∫–∞: `PGDATA/pg_wal/` _(–≤ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö ‚Äî `pg_xlog/`)_
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–æ–±—ã—á–Ω–æ 16 –ú–ë)
- WAL-—Ñ–∞–π–ª—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è, –ø–æ–∫–∞ –Ω–µ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏/–∏–ª–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω—ã

### üß™ –ü—Ä–∏–º–µ—Ä

```sql
UPDATE users SET active = true WHERE id = 1;
```

- –°–Ω–∞—á–∞–ª–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç—Ç–æ–º `UPDATE` –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `pg_wal/`
- –ü–æ—Ç–æ–º —Å—Ç—Ä–æ–∫–∞ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ —Å–±–æ–µ –º—ã –Ω–µ –ø–æ—Ç–µ—Ä—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- PostgreSQL **–Ω–µ –¥–µ–ª–∞–µ—Ç –∫–æ–º–º–∏—Ç**, –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å –≤ WAL –Ω–µ —É–¥–∞–ª–∞—Å—å
- –ï—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ, **WAL-—Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–∏—Ç—å –¥–∏—Å–∫**
- WAL ‚Äî –æ—Å–Ω–æ–≤–∞ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏ –ø–æ—Ç–æ–∫–æ–≤–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

### üìå –í—ã–≤–æ–¥

WAL ‚Äî —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç PostgreSQL, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π:

- –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- –Ω–∞–¥—ë–∂–Ω—É—é —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é
- —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ë–µ–∑ –Ω–µ–≥–æ PostgreSQL –Ω–µ —Å–º–æ–≥ –±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å **ACID-–ø—Ä–∏–Ω—Ü–∏–ø–∞–º**.

</p></details>

---

### ‚ùì 2. –í psql –∫–∞–∫–æ–π –∫–æ–º–∞–Ω–¥–æ–π –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π? 

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:05:53)](https://youtu.be/pLU3zrUq87Y?t=3953)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

 ‚úÖ –°–ø–æ—Å–æ–± 1: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `\du` –∏–ª–∏ `\dg`

```psql
\du
```

–∏–ª–∏

```psql
\dg
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- –ò–º—è —Ä–æ–ª–∏
- –ê—Ç—Ä–∏–±—É—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: SUPERUSER, LOGIN, CREATEDB)
- –í–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å (—á–ª–µ–Ω—ã –¥—Ä—É–≥–∏—Ö —Ä–æ–ª–µ–π)

### üìÑ –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}
 app_user  |                                                            | {}
```

### ‚úÖ –°–ø–æ—Å–æ–± 2: SQL-–∑–∞–ø—Ä–æ—Å

### –¢–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```sql
SELECT usename FROM pg_catalog.pg_user;
```

### –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–æ–ª—è—Ö:

```sql
SELECT * FROM pg_catalog.pg_roles;
```

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- `pg_user` ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –≤—Ä–æ–¥–µ Oracle
- `pg_roles` ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∏ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π

### üìå –í—ã–≤–æ–¥

| –ú–µ—Ç–æ–¥      | –ö–æ–º–∞–Ω–¥–∞                | –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è |
|------------|------------------------|---------------|
| `\du`     | `\du` –∏–ª–∏ `\dg`      | –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤ psql |
| SQL        | `SELECT * FROM ...`    | –°–∫—Ä–∏–ø—Ç—ã, –æ—Ç—á—ë—Ç—ã, GUI |

</p></details>

---

### ‚ùì 3. –í psql –∫–∞–∫–æ–π –∫–æ–º–∞–Ω–¥–æ–π –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –±–∞–∑? 

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:06:09)](https://youtu.be/pLU3zrUq87Y?t=3969)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### ‚úÖ –°–ø–æ—Å–æ–± 1: –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `\l` –∏–ª–∏ `\list`

```psql
\l
```

–∏–ª–∏

```psql
\list
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∞–∑–∞—Ö:

- –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –í–ª–∞–¥–µ–ª–µ—Ü
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞
- –õ–æ–∫–∞–ª—å (Collate, Ctype)
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞


### ‚úÖ –°–ø–æ—Å–æ–± 2: SQL-–∑–∞–ø—Ä–æ—Å

### –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –±–∞–∑—ã:

```sql
SELECT datname FROM pg_database WHERE datistemplate = false;
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- `template0`, `template1` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
- –ë–∞–∑–∞ `postgres` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

</p></details>

---

### ‚ùì 4. –ö–∞–∫ –≤ PostgreSQL –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ø–∏—Å–æ–∫ replication slots?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:06:22)](https://youtu.be/pLU3zrUq87Y?t=3982)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

–í PostgreSQL –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —Å–ª–æ—Ç–æ–≤ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:

```sql
SELECT * FROM pg_replication_slots;
```

### üìã –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç `pg_replication_slots`

| –ü–æ–ª–µ                   | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------------------|----------|
| `slot_name`            | –ò–º—è —Å–ª–æ—Ç–∞ |
| `plugin`               | –ò–º—è –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ (–µ—Å–ª–∏ —Å–ª–æ—Ç –ª–æ–≥–∏—á–µ—Å–∫–∏–π) |
| `slot_type`            | –¢–∏–ø: `physical` –∏–ª–∏ `logical` |
| `active`               | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ —Å–ª–æ—Ç –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç |
| `restart_lsn`          | –ù–∞—á–∞–ª—å–Ω–∞—è LSN, —Å –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–∞—á–∞—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é |
| `confirmed_flush_lsn`  | –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è) |

### üß™ –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```text
 slot_name | plugin         | slot_type | active | restart_lsn | confirmed_flush_lsn 
-----------+----------------+-----------+--------+-------------+----------------------
 slot1     |                | physical  | t      | 0/4000160   | 
 logic1    | test_decoding  | logical   | f      | 0/5000160   | 0/50001F0
```

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–ª–æ—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç WAL-–¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞ –æ–Ω–∏ –Ω–µ –±—É–¥—É—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω—ã, —á—Ç–æ–±—ã —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –º–æ–≥–ª–∞ –±—ã—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π.
- –ï—Å–ª–∏ –ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –Ω–µ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ ‚Äî WAL –±—É–¥–µ—Ç –∫–æ–ø–∏—Ç—å—Å—è, –∏ —ç—Ç–æ –º–æ–∂–µ—Ç **–∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∏—Å–∫**.
- –°–ª–æ—Ç—ã –Ω—É–∂–Ω–æ **—É–¥–∞–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é**, –µ—Å–ª–∏ –æ–Ω–∏ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

### üßπ –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–æ—Ç–∞ (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)

```sql
SELECT pg_drop_replication_slot('slot_name');
```

### üìå –í—ã–≤–æ–¥

–ß—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å replication slots –≤ PostgreSQL, –∏—Å–ø–æ–ª—å–∑—É–π —Ç–∞–±–ª–∏—Ü—É `pg_replication_slots`. –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π, –ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∏ –æ—á–∏—Å—Ç–∫–æ–π WAL.

</p></details>

---

### ‚ùì 5. –ß—Ç–æ —Ç–∞–∫–æ–µ –ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –≤ PostgreSQL? –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:06:37)](https://youtu.be/pLU3zrUq87Y?t=3997)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

**–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º PostgreSQL, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å **–∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–æ–∫** (INSERT, UPDATE, DELETE) –º–µ–∂–¥—É –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏, –ª–æ–≥–∏—á–µ—Å–∫–∞—è:
- —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∞–±–ª–∏—Ü
- –º–æ–∂–µ—Ç –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –Ω–∞ –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö

### ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ù–∞ **–∏—Å—Ç–æ—á–Ω–∏–∫–µ** —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è:

```sql
CREATE PUBLICATION my_pub FOR TABLE my_table;
```

2. –ù–∞ **–ø—Ä–∏—ë–º–Ω–∏–∫–µ** —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞:

```sql
CREATE SUBSCRIPTION my_sub
  CONNECTION 'host=sourcehost dbname=sourcedb user=replicator password=secret'
  PUBLICATION my_pub;
```

3. –ò–∑–º–µ–Ω–µ–Ω–∏—è (INSERT/UPDATE/DELETE) –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ —Å–µ—Ç–∏ –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞.

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ                     | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------------------------|----------|
| üéØ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü   | –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã |
| üîÅ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞–∑–Ω–∏—Ü–∞ –≤–µ—Ä—Å–∏–π PostgreSQL |
| ‚úçÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–µ | –ú–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –≤ –Ω–µ-—Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–µ |
| üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞        | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è "–∂–∏–≤–æ–≥–æ" –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö |
| üåç –ì–µ–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è  | –£–¥–æ–±–Ω–æ –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏, –æ–±–ª–∞–∫–∞–º–∏, –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞–º–∏ |

### ‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

| –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫                        | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------------------------------|----------|
| üö´ –ù–µ —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç DDL             | `CREATE`, `ALTER TABLE`, –∏ —Ç.–ø. –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è |
| ‚ùó –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π        | –ò–Ω–∞—á–µ `UPDATE` –∏ `DELETE` —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥—É—Ç |
| üìâ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –Ω–∏–∂–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –û—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–∞—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| üíæ –¢—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è —Å–ª–æ—Ç–æ–≤        | –°—Ç–∞—Ä—ã–µ WAL-—Ñ–∞–π–ª—ã –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç—Å—è |
| üîê –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –ù—É–∂–Ω–æ —è–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∏ –∑–∞–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ `pg_hba.conf`

### üìå –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏—á–µ—Å–∫—É—é —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é

- –î–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
- –î–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏ PostgreSQL
- –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
- –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –Ω–∞ —Å–æ–±—ã—Ç–∏—è—Ö (CDC, Kafka, –∏ —Ç.–ø.)

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è ‚Äî –º–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç PostgreSQL, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∏ –≥–∏–±–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –≥–¥–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏–∑–±—ã—Ç–æ—á–Ω–∞ –∏–ª–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.

</p></details>

---

# 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus, Victoria Metrics, Grafana)

### ‚ùì 1. –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è Prometheus –æ—Ç Victoria Metrics?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:08:28)](https://youtu.be/pLU3zrUq87Y?t=4108)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üß± –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π                | **Prometheus**                             | **VictoriaMetrics**                             |
|-------------------------|--------------------------------------------|-------------------------------------------------|
| üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ           | –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫                     | –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ (TSDB)                |
| üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞          | –û–¥–Ω–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è, –≤—Å—ë –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ        | Single-node, –∫–ª–∞—Å—Ç–µ—Ä, enterprise                |
| üß† –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫          | –î–∞ (pull model)                           | –ù–µ—Ç, —Ç–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ remote write)       |
| üß© –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å        | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Prometheus          | –°–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å Prometheus API (read/write)        |
| üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å   | –°—Ä–µ–¥–Ω—è—è, –±–µ–∑ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è| –í—ã—Å–æ–∫–∞—è, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –æ–±—ä—ë–º     |
| üì¶ –•—Ä–∞–Ω–µ–Ω–∏–µ             | –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è TSDB, –ª–æ–∫–∞–ª—å–Ω–æ                  | –ë—ã—Å—Ç—Ä–æ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞     |
| üîÑ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è/–∫–ª–∞—Å—Ç–µ—Ä   | –ù–µ—Ç –≤ open-source                          | –î–∞ (–∫–ª–∞—Å—Ç–µ—Ä-—Ä–µ–∂–∏–º –∏–ª–∏ enterprise)              |
| üßπ Retention –ø–æ–ª–∏—Ç–∏–∫–∏   | –û–¥–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞                 | –ì–∏–±–∫–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è                        |
| üîå Remote write/read    | –î–∞                                         | –î–∞ (–ª—É—á—à–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏ —Å–∂–∏–º–∞–µ—Ç—Å—è)          |
| üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞            | –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è                             | –ü—Ä–æ—Å—Ç–∞—è –≤ single-node, –µ—Å—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ |
| üìà UI / Alerting        | –ï—Å—Ç—å (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π UI –∏ Alertmanager)       | –ù–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Grafana, Alertmanager)        |


### üß† –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Prometheus

- –ü—Ä–æ—Å—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –∞–ª–µ—Ä—Ç—ã
- –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ "–≤—Å—ë –≤ –æ–¥–Ω–æ–º"
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞–ª—ã—Ö –∏ —Å—Ä–µ–¥–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤


### üöÄ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VictoriaMetrics

- –ë–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã –º–µ—Ç—Ä–∏–∫ (–º–∏–ª–ª–∏–æ–Ω—ã/—Å–µ–∫)
- –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- –•–æ—á–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å TSDB –≤ Prometheus –Ω–∞ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Grafana –∏ remote_write –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### üß™ –ü—Ä–∏–º–µ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```
[ Node Exporter ] -> Prometheus -> remote_write -> VictoriaMetrics -> Grafana
```

- Prometheus —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
- VictoriaMetrics —Ö—Ä–∞–Ω–∏—Ç –±–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã
- Grafana –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç
- Alertmanager —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ


### ‚úÖ –í—ã–≤–æ–¥

| –°—Ü–µ–Ω–∞—Ä–∏–π                               | –ß—Ç–æ –≤—ã–±—Ä–∞—Ç—å          |
|----------------------------------------|----------------------|
| –ü—Ä–æ—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞            | Prometheus           |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ               | VictoriaMetrics      |
| –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö > 30 –¥–Ω–µ–π | VictoriaMetrics      |
| –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å        | VictoriaMetrics (–∫–ª–∞—Å—Ç–µ—Ä) |
| –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã –∏ —Å–±–æ—Ä               | Prometheus           |


</p></details>

---

### ‚ùì 2. –ö–∞–∫–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã —Ç—ã –∑–Ω–∞–µ—à—å —Å –∫–∞–∫–∏–º–∏ —Ä–∞–±–æ—Ç–∞–ª? 

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:08:11)](https://youtu.be/pLU3zrUq87Y?t=4108)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### üß∞ –ö–ª—é—á–µ–≤—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã

| –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä | –ü—Ä–æ–µ–∫—Ç | –ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç | –¢–∏–ø–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|---|---|---|---|---|
| **Node Exporter** | prometheus/node_exporter | –û–° Linux/Unix (CPU, RAM, FS, —Å–µ—Ç—å) | `node_cpu_seconds_total`, `node_memory_MemAvailable_bytes`, `node_filesystem_usage` | –ë–∞–∑–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–æ–≤ |
| **Blackbox Exporter** | prometheus/blackbox_exporter | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å HTTP/HTTPS/TCP/ICMP | `probe_success`, `probe_duration_seconds` | –ü—Ä–æ–≤–µ—Ä–∫–∞ SLA/—ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ |
| **Postgres Exporter** | prometheus-community/postgres_exporter | PostgreSQL | —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, WAL, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è | –ë–î PostgreSQL |
| **MySQL Exporter** | prometheus/mysqld_exporter | MySQL/MariaDB | QPS, InnoDB, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è | –ë–î MySQL |
| **Redis Exporter** | oliver006/redis_exporter | Redis | `redis_connected_clients`, hits/misses | –ö–µ—à Redis |
| **MongoDB Exporter** | percona/mongodb_exporter | MongoDB | –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è, storage | MongoDB |
| **Nginx Exporter** | nginxinc/nginx-prometheus-exporter | Nginx (—á–µ—Ä–µ–∑ `stub_status`) | —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∑–∞–ø—Ä–æ—Å—ã, 4xx/5xx | –í–µ–±-—Å–µ—Ä–≤–µ—Ä Nginx |
| **HAProxy Exporter** | prometheus/haproxy_exporter | HAProxy | —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ã/–±—ç–∫–µ–Ω–¥—ã, –æ—à–∏–±–∫–∏ | –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ HAProxy |
| **Kafka Exporter** | danielqsj/kafka_exporter | Apache Kafka | lag, —Å–æ–æ–±—â–µ–Ω–∏—è/—Å–µ–∫ | –û—á–µ—Ä–µ–¥–∏ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥ |
| **JMX Exporter** | prometheus/jmx_exporter | JVM-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | GC, heap, threads | Java‚Äë—Å–µ—Ä–≤–∏—Å—ã, Kafka, ZK |
| **cAdvisor** | google/cadvisor | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã | CPU/Memory/FS/Network per container | Docker/Kubernetes |
| **SNMP Exporter** | prometheus/snmp_exporter | –°–µ—Ç–µ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ | –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –æ—à–∏–±–∫–∏, —Ç—Ä–∞—Ñ–∏–∫ | –†–æ—É—Ç–µ—Ä—ã/—Å–≤–∏—Ç—á–∏/UPS |
| **Node Windows Exporter** | prometheus-community/windows_exporter | Windows Server | CPU/RAM/Disk/Services | Windows‚Äë—É–∑–ª—ã |
| **Pushgateway** | prometheus/pushgateway | –ü—Ä–∏—ë–º –º–µ—Ç—Ä–∏–∫ –æ—Ç –∑–∞–¥–∞—á | –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ | Cron/batch/CI |

### üß≠ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É
- –ù–∞—á–Ω–∏—Ç–µ —Å **Node Exporter** + **cAdvisor** (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)
- –î–æ–±–∞–≤–ª—è–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –ø–æ–¥ –±–∞–∑—ã –∏ –±—Ä–æ–∫–µ—Ä—ã (Postgres/Redis/Kafka)
- –î–ª—è –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚Äî **Blackbox Exporter**
- –•—Ä–∞–Ω–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ Prometheus –∏–ª–∏ VictoriaMetrics, –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –≤ Grafana

### ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤–µ—Ä—Å–∏—è–º–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–≤ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é —Å —Ü–µ–ª–µ–≤—ã–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–µ—Ç—Ä–∏–∫–∞–º (firewall, auth proxy)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–µ–π–±–ª—ã (`job`, `instance`, `env`, `service`) –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ ‚Äî —ç—Ç–æ —É–ø—Ä–æ—Å—Ç–∏—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ –∞–ª–µ—Ä—Ç—ã

</p></details>

---

### ‚ùì 3. –ß–µ–º —Å–æ–±–∏—Ä–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:10:49)](https://youtu.be/pLU3zrUq87Y?t=4249)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### –ö—Ä–∞—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–æ–≤

| –°—Ç–µ–∫ / –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –°–±–æ—Ä | –•—Ä–∞–Ω–µ–Ω–∏–µ | –ü–æ–∏—Å–∫/–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã | –ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å |
|---|---|---|---|---|---|---|
| **ELK** (Elasticsearch + Logstash/Beats + Kibana) | Filebeat/Logstash | Elasticsearch | Kibana | –ú–æ—â–Ω—ã–π –ø–æ–∏—Å–∫, –∑—Ä–µ–ª–æ—Å—Ç—å, —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ | –†–µ—Å—É—Ä—Å–æ—ë–º–∫–∏–π, —Å–ª–æ–∂–Ω–µ–µ –∞–¥–º–∏–Ω–∏—Ç—å | –ë–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã, –≥–∏–±–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã |
| **OpenSearch Stack** | Fluent Bit/Beats | OpenSearch | OpenSearch Dashboards | Open-source —Ñ–æ—Ä–∫ ES, –∑–Ω–∞–∫–æ–º–∞—è –º–æ–¥–µ–ª—å | –¢–æ–∂–µ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª–µ–Ω –∫ —Ä–µ—Å—É—Ä—Å–∞–º | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ELK –≤ OSS |
| **EFK** (Elastic + Fluentd/Fluent Bit + Kibana) | Fluentd/Fluent Bit | Elasticsearch | Kibana | –£–¥–æ–±–µ–Ω –≤ Kubernetes, –º–Ω–æ–≥–æ –ø–ª–∞–≥–∏–Ω–æ–≤ | –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–æ—É—Ç–∏–Ω–≥–∞/–ø–∞—Ä—Å–∏–Ω–≥–∞ | K8s/–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã |
| **Grafana Loki** | Promtail/Fluent Bit | Loki (chunk storage) | Grafana | –î—ë—à–µ–≤–æ, –ø–æ—Ö–æ–∂ –Ω–∞ Prometheus, –ø—Ä–æ—Å—Ç–æ—Ç–∞ | –ü–æ–∏—Å–∫ –ø–æ –ª–µ–π–±–ª–∞–º, –Ω–µ full‚Äëtext | DevOps, —ç–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤, k8s |
| **Graylog** | Beats/Fluent Bit/Inputs | Elasticsearch + Graylog | Graylog Web UI | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, UI –∞–ª–µ—Ä—Ç–æ–≤ | –ú–µ–Ω—å—à–µ –≥–∏–±–∫–æ—Å—Ç–∏, —á–µ–º ELK | SMB/—Å—Ä–µ–¥–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ |
| **Splunk** | Universal Forwarder | Splunk Indexers | Splunk UI | Enterprise, –º–æ—â–Ω—ã–π –ø–æ–∏—Å–∫/–∞–ª–µ—Ä—Ç—ã | –î–æ—Ä–æ–≥–æ, —Å–ª–æ–∂–Ω–æ—Å—Ç—å | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π SIEM/–∫–æ–º–ø–ª–∞–µ–Ω—Å |
| **SaaS (Datadog/New Relic/Logz.io)** | –ê–≥–µ–Ω—Ç SaaS | –û–±–ª–∞–∫–æ | –û–±–ª–∞–∫–æ | –ë—ã—Å—Ç—Ä–æ, –±–µ–∑ –∞–¥–º–∏–Ω–∫–∏ | –°—Ç–æ–∏–º–æ—Å—Ç—å, –≤–µ–Ω–¥–æ—Ä‚Äë–ª–æ–∫ | –ù—É–∂–Ω–æ ¬´–≤—á–µ—Ä–∞¬ª, –Ω–µ—Ç ops‚Äë–∫–æ–º–∞–Ω–¥—ã |

### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–µ–∫–æ–≤

### üü¶ ELK Stack (Elasticsearch + Logstash/Beats + Kibana)

### Elasticsearch
- **–†–æ–ª—å:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ª–æ–≥–æ–≤ (Lucene).
- **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:** –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, –±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ JSON.
- **–í–∞–∂–Ω–æ–µ:** —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª–µ–Ω –∫ —Ä–µ—Å—É—Ä—Å–∞–º; –ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ —Ä–µ—Ç–µ–Ω—à–Ω/ILM, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ —Å–Ω–∞–ø—à–æ—Ç—ã.

### Logstash
- **–†–æ–ª—å:** –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ —Å–ª–æ–∂–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- **–ß—Ç–æ —É–º–µ–µ—Ç:** –ø–∞—Ä—Å–∏–Ω–≥ (grok/dissect), –æ–±–æ–≥–∞—â–µ–Ω–∏–µ (GeoIP, KV), –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è.
- **–ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω:** —Å–ª–æ–∂–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏/ETL –ø–µ—Ä–µ–¥ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º; –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ë–î, –æ—á–µ—Ä–µ–¥—è–º–∏.

### Beats (Filebeat/Metricbeat/‚Ä¶)
- **–†–æ–ª—å:** –õ—ë–≥–∫–∏–µ –∞–≥–µ–Ω—Ç—ã –Ω–∞ —É–∑–ª–∞—Ö-–∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö.
- **Filebeat:** —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª—ã –ª–æ–≥–æ–≤, —É–º–µ–µ—Ç –º–æ–¥—É–ª–∏ (Nginx, Systemd –∏ –¥—Ä.).
- **Metricbeat:** –º–µ—Ç—Ä–∏–∫–∏ –û–°/—Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–µ –ª–æ–≥–∏, –Ω–æ —á–∞—Å—Ç–æ —Ä—è–¥–æ–º).
- **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –±–∞–∑–æ–≤—ã–π —Å–±–æ—Ä —Å —Å–µ—Ä–≤–µ—Ä–æ–≤, –±—ã—Å—Ç—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Logstash/ES.

### Kibana
- **–†–æ–ª—å:** UI –¥–ª—è –ø–æ–∏—Å–∫–∞, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π, –¥–∞—à–±–æ—Ä–¥–æ–≤, –∞–ª–µ—Ä—Ç–æ–≤.
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:** Discover (–ø–æ–∏—Å–∫), Lens/Visualize (–≥—Ä–∞—Ñ–∏–∫–∏), Alerting/Reporting.
- **–í–∞–∂–Ω–æ:** —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ (Spaces/RBAC) –ø—Ä–∏ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ.

**–¢–∏–ø–æ–≤–æ–π –ø–∞–π–ø–ª–∞–π–Ω ELK**
```
Filebeat ‚Üí Logstash (grok/–æ–±–æ–≥–∞—â–µ–Ω–∏–µ) ‚Üí Elasticsearch ‚Üí Kibana
```

### üü© EFK Stack (Elasticsearch + Fluentd/Fluent Bit + Kibana)

### Fluent Bit
- **–†–æ–ª—å:** –û—á–µ–Ω—å –ª—ë–≥–∫–∏–π –∞–≥–µ–Ω—Ç (–Ω–∞ C) –¥–ª—è tail —Ñ–∞–π–ª–æ–≤/–∂—É—Ä–Ω–∞–ª–æ–≤, –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏.
- **–ü–ª—é—Å—ã:** –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead, –±–æ–≥–∞—Ç—ã–µ –ø–ª–∞–≥–∏–Ω—ã –≤—ã–≤–æ–¥–æ–≤ (ES, S3, Kafka, Loki –∏ –¥—Ä.).
- **–ì–¥–µ –∏–¥–µ–∞–ª–µ–Ω:** Kubernetes (DaemonSet), edge/IoT, –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –Ω–æ–¥—ã.

### Fluentd
- **–†–æ–ª—å:** –ë–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä/–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (–Ω–∞ Ruby).
- **–ü–ª—é—Å—ã:** —Ç—ã—Å—è—á–∏ –ø–ª–∞–≥–∏–Ω–æ–≤, –≥–∏–±–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.
- **–ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å:** –Ω—É–∂–Ω—ã —Å–ª–æ–∂–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã, –Ω–æ –Ω–µ —Ö–æ—á–µ—Ç—Å—è Logstash.

*(Elasticsearch –∏ Kibana ‚Äî —Ç–µ –∂–µ —Ä–æ–ª–∏, —á—Ç–æ –≤ ELK.)*

**–¢–∏–ø–æ–≤–æ–π –ø–∞–π–ø–ª–∞–π–Ω EFK (Kubernetes)**
```
Fluent Bit (DaemonSet) ‚Üí Elasticsearch ‚Üí Kibana
     ‚îî‚îÄ(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Fluentd/Logstash –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö ETL)
```

### üü® Loki Stack (Loki + Promtail + Grafana)

### Loki
- **–†–æ–ª—å:** –•—Ä–∞–Ω–∏–ª–∏—â–µ –ª–æ–≥–æ–≤ —Å –∏–Ω–¥–µ–∫—Å–æ–º –ø–æ –ª–µ–π–±–ª–∞–º (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º), –∞ –Ω–µ –ø–æ –≤—Å–µ–º—É —Ç–µ–∫—Å—Ç—É.
- **–ü–ª—é—Å—ã:** —ç–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤/–¥–∏—Å–∫–∞, –ø—Ä–æ—Å—Ç–æ—Ç–∞, —Ç–µ—Å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana/Prometheus.
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –Ω–µ full‚Äëtext –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º —Å–º—ã—Å–ª–µ; —Å–∏–ª—å–Ω–µ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –ª–µ–π–±–ª–æ–≤.

### Promtail
- **–†–æ–ª—å:** –ê–≥–µ–Ω—Ç –¥–ª—è —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ –≤ Loki.
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** tail —Ñ–∞–π–ª–æ–≤/–∂—É—Ä–Ω–∞–ª–æ–≤, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–æ–∫ (labels), –±–∞–∑–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∏ —Ñ–∏–ª—å—Ç—Ä—ã.
- **Kubernetes:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–µ–π–±–ª–∏—Ç `pod`, `namespace`, `container` –∏ –¥—Ä.

### Grafana
- **–†–æ–ª—å:** UI –¥–ª—è –ª–æ–≥–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫, –∫–æ—Ä–µ–ª–ª—è—Ü–∏—è –ø–æ –ª–µ–π–±–ª–∞–º (–º–µ—Ç—Ä–∏–∫–∞ ‚áÑ –ª–æ–≥), –∞–ª–µ—Ä—Ç—ã.
- **–§–∏—á–∞:** –ø–µ—Ä–µ—Ö–æ–¥ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –º–µ—Ç—Ä–∏–∫ –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ª–æ–≥–∞–º –ø–æ –ª–µ–π–±–ª–∞–º.

**–¢–∏–ø–æ–≤–æ–π –ø–∞–π–ø–ª–∞–π–Ω Loki**
```
Promtail ‚Üí Loki ‚Üí Grafana
```

### üü™ Graylog

### Graylog Server
- **–†–æ–ª—å:** –ü—Ä–∏—ë–º, –ø–∞—Ä—Å–∏–Ω–≥, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏ –ª–æ–≥–æ–≤.
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Elasticsearch** –∫–∞–∫ –∏–Ω–¥–µ–∫—Å/—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ **MongoDB** –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.
- **–ü–ª—é—Å—ã:** —É–¥–æ–±–Ω—ã–π UI, –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã/–ø–æ—Ç–æ–∫–∏, –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç.
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** –≥–∏–±–∫–æ—Å—Ç—å –Ω–∏–∂–µ, —á–µ–º —É –ø–æ–ª–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω–æ–≥–æ ELK.

### Inputs (Syslog, GELF, Beats, HTTP –∏ –¥—Ä.)
- **–†–æ–ª—å:** –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –¥–ª—è –ª–æ–≥–æ–≤ (–ø—Ä—è–º–æ–π syslog, –∞–≥–µ–Ω—Ç—ã, HTTP‚Äë–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏).
- **–°—Ü–µ–Ω–∞—Ä–∏–π:** –ª–µ–≥–∫–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞.

**–¢–∏–ø–æ–≤–æ–π –ø–∞–π–ø–ª–∞–π–Ω Graylog**
```
–ê–≥–µ–Ω—Ç—ã/Inputs ‚Üí Graylog Server ‚Üí Elasticsearch(+MongoDB) ‚Üí Graylog UI
```

### üü• Splunk

### Universal Forwarder
- **–†–æ–ª—å:** –õ—ë–≥–∫–∏–π –∞–≥–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤ (–∏ –Ω–µ–º–Ω–æ–≥–æ –º–µ—Ç—Ä–∏–∫) –≤ Splunk.
- **–ü–ª—é—Å—ã:** –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead, –∑–∞—â–∏—â—ë–Ω–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∫ –∏–Ω–¥–µ–∫—Å–µ—Ä–∞–º.

### Indexer
- **–†–æ–ª—å:** –ü—Ä–∏—ë–º, –ø–∞—Ä—Å–∏–Ω–≥ (Sourcetype), —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π.
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:** —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∫–æ–º–ø—Ä–µ—Å—Å–∏—è, –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è.

### Search Head
- **–†–æ–ª—å:** UI –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ (SPL).
- **–§—É–Ω–∫—Ü–∏–∏:** –ø–æ–∏—Å–∫, –¥–∞—à–±–æ—Ä–¥—ã, –æ–ø–æ–≤–µ—â–µ–Ω–∏—è, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å SIEM/ES (Enterprise Security).

**–¢–∏–ø–æ–≤–æ–π –ø–∞–π–ø–ª–∞–π–Ω Splunk**
```
Forwarder ‚Üí Indexer Cluster ‚Üí (optional SmartStore/S3) ‚Üí Search Head
```

### ‚òÅÔ∏è SaaS‚Äë–ø–æ–¥—Ö–æ–¥—ã (Datadog, New Relic, Logz.io –∏ –¥—Ä.)

### –ê–≥–µ–Ω—Ç (Vendor Agent)
- **–†–æ–ª—å:** –°–±–æ—Ä –ª–æ–≥–æ–≤/–º–µ—Ç—Ä–∏–∫/—Ç—Ä–µ–π—Å–æ–≤ —Å —É–∑–ª–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –æ–±–ª–∞–∫–æ.
- **–ü–ª—é—Å—ã:** –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –º–∏–Ω–∏–º—É–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.

### –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ UI
- **–†–æ–ª—å:** –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∫–∞–∫ —Å–µ—Ä–≤–∏—Å, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, –∞–ª–µ—Ä—Ç—ã, –∫–æ—Ä–µ–ª–ª—è—Ü–∏—è —Å APM/–º–µ—Ç—Ä–∏–∫–∞–º–∏.
- **–í–∞–∂–Ω–æ–µ:** —Ç–∞—Ä–∏—Ñ—ã –∏ —Ä–µ—Ç–µ–Ω—à–Ω ‚Äî –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–æ–∏–º–æ—Å—Ç–∏; —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±—ä—ë–º–æ–º –∏ —Å—ç–º–ø–ª–∏–Ω–≥–æ–º.

**–¢–∏–ø–æ–≤–æ–π –ø–∞–π–ø–ª–∞–π–Ω SaaS**
```
Vendor Agent ‚Üí Cloud Logging Backend ‚Üí Vendor UI/Alerting
```

## üß≠ –ß—Ç–æ –∏ –∫–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å

| –°—Ü–µ–Ω–∞—Ä–∏–π | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---|---|---|
| Kubernetes‚Äë–∫–ª–∞—Å—Ç–µ—Ä, –Ω—É–∂–µ–Ω –ª—ë–≥–∫–∏–π —Å—Ç–µ–∫ | **EFK** –∏–ª–∏ **Loki** | Fluent Bit/Promtail –∫–∞–∫ DaemonSet, –Ω–∏–∑–∫–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã |
| –ë–æ–ª—å—à–∏–µ –æ–±—ä—ë–º—ã –∏ —Å–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫ | **ELK/OpenSearch** | –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, –∑—Ä–µ–ª–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ |
| –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç ¬´–±–µ–∑ –∞–¥–º–∏–Ω–∫–∏¬ª | **SaaS (Datadog/NR/Logz)** | –ì–æ—Ç–æ–≤—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –ø–ª–∞—Ç–∏—à—å –∑–∞ –æ–±—ä—ë–º |
| Enterprise/SIEM/–∫–æ–º–ø–ª–∞–µ–Ω—Å | **Splunk** (–∏–ª–∏ Elastic Security) | –ú–æ—â–Ω—ã–π –ø–æ–∏—Å–∫, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∞–ª–µ—Ä—Ç—ã |
| –ú–∏–∫—Å –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤, —ç–∫–æ–Ω–æ–º–∏—è | **Loki** + Grafana | –î—ë—à–µ–≤–æ, —É–¥–æ–±–Ω–æ –¥–ª—è DevOps/SRE |

### –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä (—à–ø–∞—Ä–≥–∞–ª–∫–∞)
- ¬´–•–æ—á—É –ø—Ä–æ—Å—Ç–æ –∏ –¥—ë—à–µ–≤–æ¬ª ‚Üí **Loki**.  
- ¬´–ù—É–∂–µ–Ω –º–æ—â–Ω—ã–π full‚Äëtext –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏¬ª ‚Üí **ELK/OpenSearch**.  
- ¬´–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π SIEM/–∫–æ–º–ø–ª–∞–µ–Ω—Å¬ª ‚Üí **Splunk/Elastic Security**.  
- ¬´SaaS, –±—ã—Å—Ç—Ä–æ —Å—Ç–∞—Ä—Ç–∞–Ω—É—Ç—å¬ª ‚Üí **Datadog/New Relic/Logz.io**.

</p></details>

---

### ‚ùì 4. –í —Å–ª—É—á–∞–µ —Å Elasticsearch –∫–∞–∫ —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –∏–Ω–¥–µ–∫—Å—ã? –ö–∞–∫ –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å?

**[üì∫ –í–∏–¥–µ–æ-–≤–æ–ø—Ä–æ—Å (01:11:22)](https://youtu.be/pLU3zrUq87Y?t=4282)**

<details><summary><strong>–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</strong></summary><p>

### 1. –†—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (—Ä–∞–∑–æ–≤–æ)
–ß–µ—Ä–µ–∑ Kibana Dev Tools –∏–ª–∏ curl:
```http
DELETE /logs-2023.11.01
```
```bash
curl -X DELETE "http://localhost:9200/logs-2023.11.01"
```

–ú–∏–Ω—É—Å—ã: –Ω–µ—É–¥–æ–±–Ω–æ –∏ –æ–ø–∞—Å–Ω–æ –¥–ª—è –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –∏–Ω–¥–µ–∫—Å–æ–≤.

### 2. –°–∫—Ä–∏–ø—Ç –ø–æ —à–∞–±–ª–æ–Ω—É –∏–º–µ–Ω–∏ (cron)
–£–¥–∞–ª—è—Ç—å –∏–Ω–¥–µ–∫—Å—ã ¬´—Å—Ç–∞—Ä—à–µ N –¥–Ω–µ–π¬ª –ø–æ —à–∞–±–ª–æ–Ω—É `logs-YYYY.MM.DD`:

```bash
#!/usr/bin/env bash
DAYS=30
for i in $(seq $DAYS 365); do
  index=$(date -d "$i days ago" +logs-%Y.%m.%d)
  curl -s -X DELETE "http://localhost:9200/$index"
done
```

–ú–∏–Ω—É—Å—ã: –∫–æ—Å—Ç—ã–ª—å, –Ω–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞, —Ä–∏—Å–∫–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ö–µ–º—ã –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è **ILM**.

## 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ **ILM** (Index Lifecycle Management)

### 3.1 –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É ILM (—É–¥–∞–ª—è—Ç—å —á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π)
```http
PUT _ilm/policy/logs-delete-after-7d
{
  "policy": {
    "phases": {
      "hot":   { "actions": {} },
      "delete": {
        "min_age": "7d",
        "actions": { "delete": {} }
      }
    }
  }
}
```

> `min_age` —Å—á–∏—Ç–∞–µ—Ç –≤—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞ **—Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞** –∏–ª–∏ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ **rollover** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).

### 3.2 –ü—Ä–∏–≤—è–∑–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å‚Äë—à–∞–±–ª–æ–Ω
```http
PUT _index_template/logs-template
{
  "index_patterns": ["logs-*"],
  "template": {
    "settings": {
      "index.lifecycle.name": "logs-delete-after-7d",
      "index.lifecycle.rollover_alias": "logs"
    }
  },
  "priority": 10
}
```

### 3.3 (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—ã–π –∏–Ω–¥–µ–∫—Å —Å –∞–ª–∏–∞—Å–æ–º –∑–∞–ø–∏—Å–∏
```http
PUT logs-000001
{
  "aliases": {
    "logs": { "is_write_index": true }
  }
}
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–∏—à—É—Ç **–≤ –∞–ª–∏–∞—Å** `logs` (–∞ –Ω–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å). ILM —Å–º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å **rollover** –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### 3.4 –£—Å–ª–æ–≤–∏—è rollover (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥—Ä–æ–±–∏—Ç—å –ø–æ —Ä–∞–∑–º–µ—Ä—É/–∑–∞–ø–∏—Å—è–º)
–î–æ–±–∞–≤—å—Ç–µ –≤ –ø–æ–ª–∏—Ç–∏–∫—É `hot`:
```http
PUT _ilm/policy/logs-delete-after-7d
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "rollover": {
            "max_size":  "50gb",
            "max_age":   "1d",
            "max_docs":  100000000
          }
        }
      },
      "delete": {
        "min_age": "7d",
        "actions": { "delete": {} }
      }
    }
  }
}
```

ILM —Å–æ–∑–¥–∞—Å—Ç `logs-000002`, –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç –∞–ª–∏–∞—Å `logs` –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –Ω–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å, –∞ —Å—Ç–∞—Ä—ã–µ –∏–Ω–¥–µ–∫—Å—ã —É–¥–∞–ª–∏—Ç –ø–æ `min_age`.

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ILM

### –ü–æ–Ω—è—Ç—å, –∫–∞–∫–∞—è —Ñ–∞–∑–∞ —É –∏–Ω–¥–µ–∫—Å–∞
```http
GET logs-000001/_ilm/explain
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É
```http
GET _ilm/policy/logs-delete-after-7d
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —à–∞–≥ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
```http
POST logs-000001/_ilm/retry
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω–∏–ª—Å—è –ª–∏ —à–∞–±–ª–æ–Ω
```http
GET logs-000001/_settings?include_defaults=true
```

</p></details>
